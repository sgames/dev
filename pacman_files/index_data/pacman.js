!function(){var t=function(t,e){var i=function(){};i.prototype=t;var n=new i;if(e){var o={}.hasOwnProperty;for(var r in e)o.call(e,r)&&(n[r]=e[r])}return n},e=new function(){this.credit=new n("/games/pacman/sounds/credit.mp3"),this.coffeeBreakMusic=new n("/games/pacman/sounds/coffee-break-music.mp3"),this.die=new n("/games/pacman/sounds/miss.mp3"),this.ghostReturnToHome=new n("/games/pacman/sounds/ghost-return-to-home.mp3"),this.eatingGhost=new n("/games/pacman/sounds/eating-ghost.mp3"),this.ghostTurnToBlue=new n("/games/pacman/sounds/ghost-turn-to-blue.mp3",.5),this.eatingFruit=new n("/games/pacman/sounds/eating-fruit.mp3"),this.ghostSpurtMove1=new n("/games/pacman/sounds/ghost-spurt-move-1.mp3"),this.ghostSpurtMove2=new n("/games/pacman/sounds/ghost-spurt-move-2.mp3"),this.ghostSpurtMove3=new n("/games/pacman/sounds/ghost-spurt-move-3.mp3"),this.ghostSpurtMove4=new n("/games/pacman/sounds/ghost-spurt-move-4.mp3"),this.ghostNormalMove=new n("/games/pacman/sounds/ghost-normal-move.mp3"),this.extend=new n("/games/pacman/sounds/extend.mp3"),this.eating=new n("/games/pacman/sounds/eating.mp3",.5),this.startMusic=new n("/games/pacman/sounds/start-music.mp3"),this.ghostReset=function(t){for(var e in this){if("silence"==e||"ghostReset"==e)return;e.match(/^ghost/)&&this[e].stopLoop(t)}},this.silence=function(t){for(var e in this){if("silence"==e||"ghostReset"==e)return;this[e].stopLoop(t)}}};function n(t,e){var i=new Audio(t);e&&(i.volume=e),i.load();var n=!1;function o(t){r(t)}function r(t){i.paused||(i.pause(),t||(i.currentTime=0));try{var e=i.play();e&&e.then(function(){}).catch(function(t){})}catch(t){console.error(t)}}this.play=function(t){r(t)},this.startLoop=function(t){n||(i.addEventListener("ended",o),o(t),n=!0)},this.stopLoop=function(t){try{i.removeEventListener("ended",o)}catch(t){}i.pause(),t||(i.currentTime=0),n=!1},this.isPlaying=function(){return!i.paused},this.isPaused=function(){return i.paused},this.stop=this.stopLoop}var o,r,a,s,l,u=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},f=!1,c=!1,h=0,d=(o=["PAC-MAN","MS PAC-MAN","COOKIE-MAN","CRAZY OTTO"],function(t){return null==t&&(t=h),o[t]}),_=(r=[["ORIGINAL ARCADE:","NAMCO (C) 1980","","REVERSE-ENGINEERING:","JAMEY PITTMAN","","REMAKE:","SHAUN WILLIAMS"],["ORIGINAL ARCADE ADDON:","MIDWAY/GCC (C) 1981","","REVERSE-ENGINEERING:","BART GRANTHAM","","REMAKE:","SHAUN WILLIAMS"],["A NEW PAC-MAN GAME","WITH RANDOM MAZES:","SHAUN WILLIAMS (C) 2012","","COOKIE MONSTER DESIGN:","JIM HENSON","","PAC-MAN CROSSOVER CONCEPT:","TANG YONGFA"],["THE UNRELEASED","MS. PAC-MAN PROTOTYPE:","GCC (C) 1981","","SPRITES REFERENCED FROM","STEVE GOLSON'S","CAX 2012 PRESENTATION","","REMAKE:","SHAUN WILLIAMS"]],function(t){return null==t&&(t=h),r[t]}),p=function(t){return null==t&&(t=h),3==t?["plato","darwin","freud","newton"]:1==t?["blinky","pinky","inky","sue"]:0==t?["blinky","pinky","inky","clyde"]:2==t?["elmo","piggy","rosita","zoe"]:void 0},v=function(t){return null==t&&(t=h),3==t?pt.drawMonsterSprite:2==t?pt.drawMuppetSprite:pt.drawGhostSprite},x=function(t){return null==t&&(t=h),3==t?pt.drawOttoSprite:0==t?pt.drawPacmanSprite:1==t?pt.drawMsPacmanSprite:2==t?Wt:void 0};!function(){var t,e,i,n,o;a=function(){for(ye.invincible=!1,ye.ai=!1,t=0;t<5;t++)we[t].isDrawPath=!1,we[t].isDrawTarget=!1;xi.setUpdatesPerSecond(60)},n={},o={},s=function(){for(e=ye.invincible,i=ye.ai,t=0;t<5;t++)n[t]=we[t].isDrawPath,o[t]=we[t].isDrawTarget},l=function(){for(ye.invincible=e,ye.ai=i,t=0;t<5;t++)we[t].isDrawPath=n[t],we[t].isDrawTarget=o[t]}}();var m,g=1,T=0,w={},b={},S={},P={},F={},C=[0,0,0,0,0,0,0,0,0],M=[1e4,1e4,1e4,1e4,1e4,1e4,1e4,1e4],E=function(){return f?8:2*h+(c?1:0)},k=function(t){var e=D();e<1e4&&e+t>=1e4&&(T++,at.drawMap()),A(e+=t),f||e>L()&&I(e)},D=function(){return C[E()]},A=function(t){C[E()]=t},L=function(){return M[E()]},I=function(t){M[E()]=t,R()},R=function(){localStorage&&(localStorage.highScores=JSON.stringify(M))},N=function(t){return(t+1)%4},B=function(t){return(t+3)%4},z=function(t){return(t+2)%4},O=function(t,e){0==e?(t.x=0,t.y=-1):3==e?(t.x=1,t.y=0):2==e?(t.x=0,t.y=1):1==e&&(t.x=-1,t.y=0)},G=function(t,e,i){var n,o,r,a,s=1/0,l={},u=0;for(a=0;a<4;a++)i[a]&&(O(l,a),(r=(n=l.x+t.x-e.x)*n+(o=l.y+t.y-e.y)*o)<s&&(s=r,u=a));return u},H=function(t,e){var i={};i[0]=on.isFloorTile(t.x,t.y-1),i[3]=on.isFloorTile(t.x+1,t.y),i[2]=on.isFloorTile(t.x,t.y+1),i[1]=on.isFloorTile(t.x-1,t.y);var n,o=0;if(null!=e){for(n=0;n<4;n++)i[n]&&o++;var r=z(e);o>1&&(i[r]=!1)}return i},q=function(t,e){return on.isFloorTile(t.x+e.x,t.y+e.y)},W=3,Y=4,J=function(t,e,i){this.numCols=t,this.numRows=e,this.numTiles=t*e,this.widthPixels=8*t,this.heightPixels=8*e,this.tiles=i,this.doorTile={x:13,y:14},this.doorPixel={x:8*(this.doorTile.x+1)-1,y:8*this.doorTile.y+Y},this.homeTopPixel=136,this.homeBottomPixel=144,this.timeEaten={},this.resetCurrent(),this.parseDots(),this.parseTunnels(),this.parseWalls()};J.prototype.save=function(t){},J.prototype.eraseFuture=function(t){var e;for(e=0;e<this.numTiles;e++)t<=this.timeEaten[e]&&delete this.timeEaten[e]},J.prototype.load=function(t,e){var i,n,o=function(t){var e,i;e=t%this.numCols,i=Math.floor(t/this.numCols),at.refreshPellet(e,i)};for(n=0;n<this.numTiles;n++)"."!=(i=this.startTiles[n])&&"o"!=i||(e<=this.timeEaten[n]?this.currentTiles[n]!=i&&(this.dotsEaten--,this.currentTiles[n]=i,o.call(this,n)):e>this.timeEaten[n]&&" "!=this.currentTiles[n]&&(this.dotsEaten++,this.currentTiles[n]=" ",o.call(this,n)))},J.prototype.resetTimeEaten=function(){this.startTiles=this.currentTiles.slice(0),this.timeEaten={}},J.prototype.resetCurrent=function(){this.currentTiles=this.tiles.split(""),this.dotsEaten=0},J.prototype.parseWalls=function(){var t=this;this.paths=[];var e,i,n={},o=function(e,i){if(e>=-2&&e<t.numCols+2&&i>=0&&i<t.numRows)return e+2+i*(t.numCols+4)},r={},a=0;for(i=0;i<this.numRows;i++)for(e=-2;e<this.numCols+2;e++,a++)"|"!=this.getTile(e,i)||"|"==this.getTile(e-1,i)&&"|"==this.getTile(e+1,i)&&"|"==this.getTile(e,i-1)&&"|"==this.getTile(e,i+1)&&"|"==this.getTile(e-1,i-1)&&"|"==this.getTile(e-1,i+1)&&"|"==this.getTile(e+1,i-1)&&"|"==this.getTile(e+1,i+1)||(r[a]=!0);var s=function(e,i){var a,s={};if(o(e+1,i)in r)a=3;else{if(!(o(e,i+1)in r))throw"tile shouldn't be 1x1 at "+e+","+i;a=2}O(s,a);for(var l,u,f,c,h,d=e+=s.x,_=i+=s.y,p=a,v=[],x=function(e,i,n){var a={};O(a,n),o(e+a.y,i-a.x)in r||(l=t.isFloorTile(e+a.y,i-a.x)?5:0);var s=-4+l,u=function(t){return-t*Math.PI/2}(n),f=Math.cos(u),c=Math.sin(u);return{x:s*f-4*c+8*(e+.5),y:s*c+4*f+8*(i+.5)}};;)if(n[o(e,i)]=!0,u=x(e,i,a),c&&(f=v[v.length-1],0==s.x?(u.cx=u.x,u.cy=f.y):(u.cx=f.x,u.cy=u.y)),c=!1,h=!1,o(e+s.y,i-s.x)in r?(a=N(a),c=!0):o(e+s.x,i+s.y)in r||(o(e-s.y,i+s.x)in r?(a=B(a),c=!0):(a=z(a),h=!0)),O(s,a),v.push(u),h&&(v.push(x(e-s.x,i-s.y,z(a))),v.push(x(e,i,a))),i+=s.y,(e+=s.x)==d&&i==_&&a==p){t.paths.push(v);break}};for(a=0,i=0;i<this.numRows;i++)for(e=-2;e<this.numCols+2;e++,a++)a in r&&!(a in n)&&(n[a]=!0,s(e,i))},J.prototype.parseDots=function(){var t,e;this.numDots=0,this.numEnergizers=0,this.energizers=[];var i,n=0;for(e=0;e<this.numRows;e++)for(t=0;t<this.numCols;t++)"."==(i=this.tiles[n])?this.numDots++:"o"==i&&(this.numDots++,this.numEnergizers++,this.energizers.push({x:t,y:e})),n++},J.prototype.dotsLeft=function(){return this.numDots-this.dotsEaten},J.prototype.allDotsEaten=function(){return 0==this.dotsLeft()},J.prototype.parseTunnels=(m=function(t,e,i){for(;!this.isFloorTile(t,e-1)&&!this.isFloorTile(t,e+1)&&this.isFloorTile(t,e);)t+=i;return t},function(){var t;for(this.tunnelRows={},t=0;t<this.numRows;t++)this.isFloorTile(0,t)&&this.isFloorTile(this.numCols-1,t)&&(this.tunnelRows[t]={leftEntrance:m.call(this,0,t,1),rightEntrance:m.call(this,this.numCols-1,t,-1),leftExit:-16,rightExit:8*(this.numCols+2)-1})}),J.prototype.teleport=function(t){var e=this.tunnelRows[t.tile.y];e&&(t.pixel.x<e.leftExit?t.pixel.x=e.rightExit:t.pixel.x>e.rightExit&&(t.pixel.x=e.leftExit))},J.prototype.posToIndex=function(t,e){if(t>=0&&t<this.numCols&&e>=0&&e<this.numRows)return t+e*this.numCols},J.prototype.isTunnelTile=function(t,e){var i=this.tunnelRows[e];return i&&(t<i.leftEntrance||t>i.rightEntrance)},J.prototype.getTile=function(t,e){return t>=0&&t<this.numCols&&e>=0&&e<this.numRows?this.currentTiles[this.posToIndex(t,e)]:(t<0||t>=this.numCols)&&(this.isTunnelTile(t,e-1)||this.isTunnelTile(t,e+1))?"|":this.isTunnelTile(t,e)?" ":void 0},J.prototype.isFloorTileChar=function(t){return" "==t||"."==t||"o"==t},J.prototype.isFloorTile=function(t,e){return this.isFloorTileChar(this.getTile(t,e))},J.prototype.onDotEat=function(t,e){this.dotsEaten++;var i=this.posToIndex(t,e);this.currentTiles[i]=" ",this.timeEaten[i]=Mn.getTime(),at.erasePellet(t,e)};var U,V,K,Q,X,Z,j,$,tt,et,it,nt,ot,rt,at,st,lt,ut,ft,ct,ht,dt,_t=(Q=function(t){var e,i,n,o=t.length;for(e=0;e<o;e++)i=u(0,o-1),n=t[e],t[e]=t[i],t[i]=n},X=function(t){var e=t.length;if(e>0)return t[u(0,e-1)]},Z=[],j=[],$=[],tt=function(){var t;for(t=0;t<45;t++)Z[t]={x:t%5,y:Math.floor(t/5),filled:!1,connect:[!1,!1,!1,!1],next:[],no:void 0,group:void 0};for(t=0;t<45;t++){var e;(e=Z[t]).x>0&&(e.next[3]=Z[t-1]),e.x<4&&(e.next[1]=Z[t+1]),e.y>0&&(e.next[0]=Z[t-5]),e.y<8&&(e.next[2]=Z[t+5])}(e=Z[t=15]).filled=!0,e.connect[3]=e.connect[1]=e.connect[2]=!0,(e=Z[++t]).filled=!0,e.connect[3]=e.connect[2]=!0,(e=Z[t+=4]).filled=!0,e.connect[3]=e.connect[0]=e.connect[1]=!0,(e=Z[++t]).filled=!0,e.connect[0]=e.connect[3]=!0},et=function(){for(var t=function(){var t,e=[];for(t=0;t<5;t++){for(y=0;y<9;y++){var i=Z[t+5*y];i.filled||e.push(i)}if(e.length>0)break}return e},e=function(t,e,i,n){return!(6==t.y&&0==t.x&&2==e||7==t.y&&0==t.x&&0==e)&&((2!=n||e!=i&&z(e)!=i)&&!(!t.next[e]||t.next[e].filled||t.next[e].next[3]&&!t.next[e].next[3].filled))},n=function(t,n,o){var r=[],a=0;for(i=0;i<4;i++)e(t,i,n,o)&&(r.push(i),a++);return{openCells:r,numOpenCells:a}},o=function(t,e){t.connect[e]=!0,t.next[e].connect[z(e)]=!0,0==t.x&&1==e&&(t.connect[3]=!0)},r=function(){var i,r,s,l,f,c,h,d,_,p=0,v=[0,0,.1,.5,.75,1],x={};x[0]=x[8]=0;var m=0,g=function(t){t.filled=!0,t.no=p++,t.group=d};for(d=0;0!=(f=(l=t()).length);d++)if(s=i=l[u(0,f-1)],g(i),i.x<4&&i.y in x&&Math.random()<=.35&&0==x[i.y])i.connect[0==i.y?0:2]=!0,x[i.y]++;else if(_=1,4==i.x)i.connect[1]=!0,i.isRaiseHeightCandidate=!0;else for(;_<5;){var y=!1;if(2==_)if((b=s).x>0&&b.connect[1]&&b.next[1]&&b.next[1].next[1]&&m<1&&Math.random()<=1){b=b.next[1].next[1];var T={};e(b,0)&&(T[0]=!0),e(b,2)&&(T[2]=!0),null!=(h=T[0]&&T[2]?[0,2][u(0,1)]:T[0]?0:T[2]?2:void 0)&&(o(b,3),g(b),o(b,h),g(b.next[h]),m++,_+=2,y=!0)}if(!y){var w=n(i,c,_);l=w.openCells,0==(f=w.numOpenCells)&&2==_&&(l=(w=n(i=r,c,_)).openCells,f=w.numOpenCells),0==f?y=!0:(c=l[u(0,f-1)],r=i.next[c],o(i,c),g(r),_++,0==s.x&&3==_&&(y=!0),Math.random()<=v[_]&&(y=!0))}if(y){if(1==_);else if(2==_){var b;4==(b=s).x&&(b.connect[0]&&(b=b.next[0]),b.connect[1]=b.next[2].connect[1]=!0)}else if((3==_||4==_)&&m<1&&s.x>0&&Math.random()<=.5){T=[];var S=0;for(h=0;h<4;h++)i.connect[h]&&e(i.next[h],h)&&(T.push(h),S++);S>0&&(h=T[u(0,S-1)],b=i.next[h],o(b,h),g(b.next[h]),m++)}break}}a()},a=function(){var t,e,i,n,o;for(t=0;t<45;t++)e=Z[t],t%5,Math.floor(t/5),i=e.connect,0!=e.x&&i[3]||4!=e.x&&i[1]||i[0]==i[2]||(e.isRaiseHeightCandidate=!0),null!=(n=e.next[1])&&(o=n.connect,0!=e.x&&i[3]||i[0]||i[2]||4!=n.x&&o[1]||o[0]||o[2]||(e.isRaiseHeightCandidate=n.isRaiseHeightCandidate=!0)),4==e.x&&i[1]&&(e.isShrinkWidthCandidate=!0),0!=e.y&&i[0]||8!=e.y&&i[2]||i[3]==i[1]||(e.isShrinkWidthCandidate=!0)},s=function(t){return t.connect[0]&&t.connect[1]&&t.connect[2]&&t.connect[3]},l=function(){var t=Z[4];if(t.connect[0]||t.connect[1])return!1;if((t=Z[44]).connect[2]||t.connect[1])return!1;var e,i,n,o=function(t,e){var i=Z[t+5*e].connect,n=Z[t+1+5*e].connect;return!i[0]&&!i[2]&&(0==t||!i[3])&&i[1]&&!n[0]&&!n[2]&&n[3]&&!n[1]},r=function(t,e){var i=Z[t+5*e].connect,n=Z[t+5*(e+1)].connect;return 4==t?!(i[3]||i[0]||i[2]||n[3]||n[0]||n[2]):!i[3]&&!i[1]&&!i[0]&&i[2]&&!n[3]&&!n[1]&&n[0]&&!n[2]};for(i=0;i<8;i++)for(e=0;e<4;e++)if(o(e,i)&&o(e,i+1)||r(e,i)&&r(e+1,i)){if(0==e)return!1;Z[e+5*i].connect[2]=!0,Z[e+5*i].connect[1]=!0,n=Z[e+5*i].group,Z[e+1+5*i].connect[2]=!0,Z[e+1+5*i].connect[3]=!0,Z[e+1+5*i].group=n,Z[e+5*(i+1)].connect[0]=!0,Z[e+5*(i+1)].connect[1]=!0,Z[e+5*(i+1)].group=n,Z[e+1+5*(i+1)].connect[0]=!0,Z[e+1+5*(i+1)].connect[3]=!0,Z[e+1+5*(i+1)].group=n}return!!function(){var t,e,i=function(t,e){if(4==t)return!0;var n,o,r;for(n=e;n>=0&&(r=(o=Z[t+5*n]).next[1],o.connect[0]&&!s(o)||r.connect[0]&&!s(r));n--);for(var a,l=[],u=0;r&&(r.isRaiseHeightCandidate&&(l.push(r),u++),r.connect[2]&&!s(r)||r.next[3].connect[2]&&!s(r.next[3]));r=r.next[2]);for(Q(l),a=0;a<u;a++)if(r=l[a],i(r.x,r.y))return r.raiseHeight=!0,j[r.x]=r.y,!0;return!1};for(t=0;t<3;t++)if((e=Z[5*t]).isRaiseHeightCandidate&&i(0,t))return e.raiseHeight=!0,j[e.x]=e.y,!0;return!1}()&&!!function(){var t,e,i=function(t,e){if(8==e)return!0;var n,o,r;for(n=t;n<5&&(r=(o=Z[n+5*e]).next[2],o.connect[1]&&!s(o)||r.connect[1]&&!s(r));n++);for(var a,l=[],u=0;r&&(r.isShrinkWidthCandidate&&(l.push(r),u++),r.connect[3]&&!s(r)||r.next[0].connect[3]&&!s(r.next[0]));r=r.next[3]);for(Q(l),a=0;a<u;a++)if(r=l[a],i(r.x,r.y))return r.shrinkWidth=!0,$[r.y]=r.x,!0;return!1};for(t=4;t>=0;t--)if((e=Z[t]).isShrinkWidthCandidate&&i(t,0))return e.shrinkWidth=!0,$[e.y]=e.x,!0;return!1}()},f=function(){var t,e;for(t=0;t<45;t++)(e=Z[t]).final_x=3*e.x,$[e.y]<e.x&&e.final_x--,e.final_y=3*e.y,j[e.x]<e.y&&e.final_y++,e.final_w=e.shrinkWidth?2:3,e.final_h=e.raiseHeight?4:3},c=function(){var t,e,i,n=[],o=[],r=[],a=[],s=[],l=[],u=[],f=[],c=[],h=[],d=0;for(t=0;t<9;t++)if(!(p=Z[4+5*t]).connect[0])if(p.y>1&&p.y<7&&(p.isEdgeTunnelCandidate=!0,u.push(p),p.y<=2?f.push(p):p.y>=5&&c.push(p)),e=!p.next[0]||p.next[0].connect[1],i=!p.next[2]||p.next[2].connect[1],p.connect[1])e&&(p.isVoidTunnelCandidate=!0,a.push(p),p.y<=2?s.push(p):p.y>=6&&l.push(p));else{if(p.connect[2])continue;if(e!=i){if(!p.raiseHeight&&t<8&&!p.next[3].connect[3]){n.push(p),p.isSingleDeadEndCandidate=!0,p.singleDeadEndDir=e?0:2;var _=e?1:0;p.y<=1+_?o.push(p):p.y>=5+_&&r.push(p)}}else e&&i&&t>0&&t<8&&p.next[3].connect[0]&&p.next[3].connect[2]&&(p.isDoubleDeadEndCandidate=!0,p.y>=2&&p.y<=5&&h.push(p))}var p,v,x,m=Math.random()<=.45?2:1,g=function(t){t.connect[1]=!0,0==t.singleDeadEndDir?t.topTunnel=!0:t.next[2].topTunnel=!0};if(1==m)if(p=X(a))p.topTunnel=!0;else if(p=X(n))g(p);else{if(!(p=X(u)))return!1;p.topTunnel=!0}else if(2==m)if(p=X(h))p.connect[1]=!0,p.topTunnel=!0,p.next[2].topTunnel=!0;else if(d=1,(p=X(s))?p.topTunnel=!0:(p=X(o))?g(p):(p=X(f))?p.topTunnel=!0:d=0,p=X(l))p.topTunnel=!0;else if(p=X(r))g(p);else if(p=X(c))p.topTunnel=!0;else if(0==d)return!1;for(t=0;t<9;t++)if((p=Z[4+5*t]).topTunnel){for(v=!0,x=p.final_y;p.next[3];)if((p=p.next[3]).connect[0]||p.final_y!=x){v=!1;break}if(v)return!1}var y,T=a.length,w=function(t,e){var i,n;for(i=0;i<45;i++)(n=Z[i]).group==t&&(n.group=e)};for(y=0;y<T;y++)(p=a[y]).topTunnel||(w(p.group,p.next[0].group),p.connect[0]=!0,p.next[0].connect[2]=!0);return!0},h=function(){var t,e,i,n;for(t=0;t<5;t++)(i=Z[t]).connect[3]||i.connect[1]||i.connect[0]||i.connect[2]&&i.next[2].connect[2]||i.next[3]&&i.next[3].connect[0]||!i.next[1]||i.next[1].connect[0]||i.next[2]&&i.next[2].connect[1]&&i.next[2].next[1].connect[1]||(i.isJoinCandidate=!0,Math.random()<=.25&&(i.connect[0]=!0));for(t=0;t<5;t++)(i=Z[t+40]).connect[3]||i.connect[1]||i.connect[2]||i.connect[0]&&i.next[0].connect[0]||i.next[3]&&i.next[3].connect[2]||!i.next[1]||i.next[1].connect[2]||i.next[0]&&i.next[0].connect[1]&&i.next[0].next[1].connect[1]||(i.isJoinCandidate=!0,Math.random()<=.25&&(i.connect[2]=!0));for(e=1;e<8;e++)(i=Z[4+5*e]).raiseHeight||i.connect[1]||i.connect[0]||i.connect[2]||i.next[0].connect[1]||i.next[2].connect[1]||i.connect[3]&&((n=i.next[3]).connect[0]||n.connect[2]||n.connect[3]||(i.isJoinCandidate=!0,Math.random()<=.5&&(i.connect[1]=!0)))};tt(),r(),0,!l()||(f(),h(),!c()););},it=function(t,e,i,n){var o,r,a,s,l={};for(r=0;r<36;r++)for(o=0;o<28;o++)n(o,r)&&(l[a=o+28*r]={x:o,y:r,dist:1/0,penult:void 0,neighbors:[],completed:!1},n(o-1,r)&&(s=a-1,l[a].neighbors.push(l[s]),l[s].neighbors.push(l[a])),n(o,r-1)&&(s=a-28,l[a].neighbors.push(l[s]),l[s].neighbors.push(l[a])));var u,f,c,h,d=l[e+28*i];for(d.completed=!0,d.dist=0;;){for(a=0;a<4;a++)(u=d.neighbors[a])&&!u.completed&&((h=d.dist+1)==u.dist?Math.random()<.5&&(u.penult=d):h<u.dist&&(u.dist=h,u.penult=d));for(f=void 0,c=1/0,a=0;a<1008;a++)(u=l[a])&&!u.completed&&u.dist<c&&(f=u,c=u.dist);if(!f)break;(d=f).completed=!0}return l},nt=function(t){if(t.penult){var e=t.x-t.penult.x,i=t.y-t.penult.y;return-1==i?0:1==i?2:-1==e?1:1==e?3:void 0}},U={v:"^","^":"v","<":">",">":"<"},V={0:"^",2:"v",1:"<",3:">"},K=function(t,e,i,n,o,r){var a,s=t[e+28*i],l="";for(a=t[n+28*o];a!=s;a=a.penult)l=V[nt(a)]+l;return r?function(t){var e,i="";for(e=t.length-1;e>=0;e--)i+=U[t[e]];return i}(l):l},ot=function(t){paths={entrances:[],exits:[]};var e=function(e,i){return!(e<0||e>=28||i<0||i>=36)&&t.isFloorTile(e,i)};for(enter_graph=it(0,15,20,function(t,i){return(14!=t||20!=i)&&e(t,i)}),exit_graph=it(0,16,20,function(t,i){return(17!=t||20!=i)&&e(t,i)}),y=0;y<36;y++)t.isFloorTile(-1,y)&&(paths.entrances.push({start:{y:8*y+4,x:-4},path:">"+K(enter_graph,15,20,0,y,!0)}),paths.entrances.push({start:{y:8*y+4,x:228},path:"<"+K(enter_graph,15,20,27,y,!0)}),paths.exits.push({start:{y:8*y+4,x:-4},path:K(exit_graph,16,20,0,y,!1)+"<"}),paths.exits.push({start:{y:8*y+4,x:228},path:K(exit_graph,16,20,27,y,!1)+">"}));t.fruitPaths=paths},function(){et();var t,e=new J(28,36,function(){var t,e,i,n,o,r=[],a=[],s=function(t,e,i){t<0||t>15||e<0||e>30||(r[14+(t-=2)+28*e]=i,r[13-t+28*e]=i)},l=function(t,e){if(!(t<0||t>15||e<0||e>30))return r[14+(t-=2)+28*e]},f=function(t,e,i){t<0||t>15||e<0||e>30||(a[(t-=2)+16*e]=i)},c=function(t,e){if(!(t<0||t>15||e<0||e>30))return a[(t-=2)+16*e]};for(_=0;_<868;_++)r.push("_");for(_=0;_<496;_++)a.push(void 0);for(_=0;_<45;_++)for(t=Z[_],e=0;e<t.final_w;e++)for(i=0;i<t.final_h;i++)f(t.final_x+e,t.final_y+1+i,t);for(v=0;v<31;v++)for(d=0;d<16;d++)t=c(d,v),n=c(d-1,v),o=c(d,v-1),t?(n&&t.group!=n.group||o&&t.group!=o.group||!o&&!t.connect[0])&&s(d,v,"."):(!n||n.connect[1]&&"."!=l(d-1,v))&&(!o||o.connect[2]&&"."!=l(d,v-1))||s(d,v,"."),"."==l(d-1,v)&&"."==l(d,v-1)&&"_"==l(d-1,v-1)&&s(d,v,".");for(t=Z[4];t;t=t.next[2])t.topTunnel&&(v=t.final_y+1,s(15,v,"."),s(14,v,"."));for(v=0;v<31;v++)for(d=0;d<16;d++)"."==l(d,v)||"."!=l(d-1,v)&&"."!=l(d,v-1)&&"."!=l(d+1,v)&&"."!=l(d,v+1)&&"."!=l(d-1,v-1)&&"."!=l(d+1,v-1)&&"."!=l(d+1,v+1)&&"."!=l(d-1,v+1)||s(d,v,"|");s(2,12,"-");var h,d=14;(h=function(){var t,e,i=15.5;for(e=2;e<i;e++)if("."==l(14,e)&&"."==l(14,e+1)){t=e+1;break}for(i=Math.min(i,t+7),e=t+1;e<i;e++)if("."==l(13,e)){i=e-1;break}return{miny:t,maxy:i}}())&&(v=u(h.miny,h.maxy),s(d,v,"o")),(h=function(){var t,e,i=15.5;for(e=28;e>=i;e--)if("."==l(14,e)&&"."==l(14,e+1)){t=e;break}for(i=Math.max(i,t-7),e=t-1;e>i;e--)if("."==l(13,e)){i=e+1;break}return{miny:i,maxy:t}}())&&(v=u(h.miny,h.maxy),s(d,v,"o"));var _,p,v,x=function(t,e){for(var i;i=[],"."==l(t-1,e)&&i.push({x:t-1,y:e}),"."==l(t+1,e)&&i.push({x:t+1,y:e}),"."==l(t,e-1)&&i.push({x:t,y:e-1}),"."==l(t,e+1)&&i.push({x:t,y:e+1}),1==i.length;)s(t,e," "),t=i[0].x,e=i[0].y};for(d=15,v=0;v<31;v++)"."==l(d,v)&&x(d,v);for(s(1,23," "),_=0;_<7;_++){for(s(_,v=17," "),p=1;"."==l(_,v+p)&&"|"==l(_-1,v+p)&&"|"==l(_+1,v+p);)s(_,v+p," "),p++;for(s(_,v=11," "),p=1;"."==l(_,v-p)&&"|"==l(_-1,v-p)&&"|"==l(_+1,v-p);)s(_,v-p," "),p++}for(_=0;_<7;_++)for(s(d=6,v=17-_," "),p=1;"."==l(d+p,v)&&"|"==l(d+p,v-1)&&"|"==l(d+p,v+1);)s(d+p,v," "),p++;return"____________________________________________________________________________________"+r.join("")+"________________________________________________________"}());return ot(e),function(t){var e=it(0,t.doorTile.x,t.doorTile.y,function(e,i){return!(e<0||e>=28||i<0||i>=36)&&t.isFloorTile(e,i)});t.getExitDir=function(t,i){if(!(t<0||t>=28||i<0||i>=36)){var n=e[t+28*i],o=nt(n);return null!=o?z(o):void 0}}}(e),e.name="Random Map",e.wallFillColor="#"+("00000"+(Math.random()*(1<<24)|0).toString(16)).slice(-6),e.wallStrokeColor=(t=function(t,e,i){var n,o,r;if(0==e)n=o=r=i;else{function a(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}var s=i<.5?i*(1+e):i+e-i*e,l=2*i-s;n=a(l,s,t+1/3),o=a(l,s,t),r=a(l,s,t-1/3)}return[n*=255,o*=255,r*=255]}(Math.random(),Math.random(),.4*Math.random()+.6),"rgb("+Math.floor(t[0])+","+Math.floor(t[1])+","+Math.floor(t[2])+")"),e.pelletColor="#ffb8ae",e}),pt=function(){var t,e,i=0,n=function(e,i,n,o,r,a){var s=22*i*st,l=22*e*st,u=22*st,f=22*st,c=o-11,h=r-11;a&&console.log(s,l,u,f,22,h,22,22),n.drawImage(t,s,l,u,f,c,h,22,22)},o=function(t,e,i,o,r,a,s,l,u){var f,c;l?(f=5,c=r):a?(f=5,c=s?6:4,c+=o):(c=2*r+o,f=u==ve.color?1:u==xe.color?2:u==me.color?3:u==ge.color?4:5),n(f,c,t,e,i)},r=function(t,e,i,o){n(0,{cherry:0,strawberry:1,orange:2,apple:3,melon:4,galaxian:5,bell:6,key:7,pretzel:8,pear:9,banana:10,cookie:11,cookieface:12}[o],t,e,i)};return{create:function(){!function(){var t=document.getElementById("gridcanvas");if(t){var e=308*st,i=484*st;t.width=e,t.height=i;var n,o,r=t.getContext("2d");r.clearRect(0,0,e,i);var a=22*st;for(r.beginPath(),n=0;n<=e;n+=a)r.moveTo(n,0),r.lineTo(n,i);for(o=0;o<=i;o+=a)r.moveTo(0,o),r.lineTo(e,o);r.lineWidth="1px",r.lineCap="square",r.strokeStyle="rgba(255,255,255,0.5)",r.stroke()}}(),t=document.getElementById("atlas"),e=t.getContext("2d");var n=308*st,o=484*st;t.width=n,t.height=o,i>0&&e.restore(),i++,e.save(),e.clearRect(0,0,n,o),e.scale(st,st);var r=function(t,e,i){t(22*i+11,22*e+11)},a=0;r(function(t,i){Yt(e,t,i)},a,0),r(function(t,i){Jt(e,t,i)},a,1),r(function(t,i){Ut(e,t,i)},a,2),r(function(t,i){Vt(e,t,i)},a,3),r(function(t,i){Kt(e,t,i)},a,4),r(function(t,i){Qt(e,t,i)},a,5),r(function(t,i){Xt(e,t,i)},a,6),r(function(t,i){Zt(e,t,i)},a,7),r(function(t,i){jt(e,t,i)},a,8),r(function(t,i){$t(e,t,i)},a,9),r(function(t,i){te(e,t,i)},a,10),r(function(t,i){ee(e,t,i)},a,11),r(function(t,i){ie(e,t,i)},a,12);var s=function(t,i){var n,o,a=0;for(n=0;n<4;n++)for(o=0;o<2;o++)r(function(t,r){Lt(e,t,r,o,n,!1,!1,!1,i)},t,a),a++};s(++a,"#FF0000"),s(++a,"#FFB8FF"),s(++a,"#00FFFF"),s(++a,"#FFB851"),a++,function(){var t,i=0;for(t=0;t<4;t++)r(function(i,n){Lt(e,i,n,0,t,!1,!1,!0,"#fff")},a,i),i++}(),r(function(t,i){Lt(e,t,i,0,0,!0,!1,!1,"#fff")},a,4),r(function(t,i){Lt(e,t,i,1,0,!0,!1,!1,"#fff")},a,5),r(function(t,i){Lt(e,t,i,0,0,!0,!0,!1,"#fff")},a,6),r(function(t,i){Lt(e,t,i,1,0,!0,!0,!1,"#fff")},a,7);var l=function(t,i,n){r(function(t,i){Ht(e,t,i,n,Math.PI/6)},t,i),r(function(t,i){Ht(e,t,i,n,Math.PI/3)},t,i+1)};r(function(t,i){Ht(e,t,i,3,0)},++a,0),function(){var t,e=1;for(t=0;t<4;t++)l(a,e,t),e+=2}();var u=function(t,i,n){r(function(t,i){qt(e,t,i,n,0)},t,i),r(function(t,i){qt(e,t,i,n,1)},t,i+1),r(function(t,i){qt(e,t,i,n,2)},t,i+2)};a++,function(){var t,e=0;for(t=0;t<4;t++)u(a,e,t),e+=3}();var f=function(t,i,n){r(function(t,i){Wt(e,t,i,n,0,!0)},t,i),r(function(t,i){Wt(e,t,i,n,1,!0)},t,i+1),r(function(t,i){Wt(e,t,i,n,2,!0)},t,i+2)};a++,function(){var t,e=0;for(t=0;t<4;t++)f(a,e,t),e+=3}();var c=function(t,i){var n,o,a=0;for(n=0;n<4;n++)for(o=0;o<2;o++)r(function(t,r){Nt(e,t,r,o,n,!1,!1,!1,i)},t,a),a++};c(++a,"#FF0000"),c(++a,"#FFB8FF"),c(++a,"#00FFFF"),c(++a,"#FFB851"),a++,function(){var t,i=0;for(t=0;t<4;t++)r(function(i,n){Nt(e,i,n,0,t,!1,!1,!0,"#fff")},a,i),i++}(),r(function(t,i){Nt(e,t,i,0,0,!0,!1,!1,"#fff")},a,4),r(function(t,i){Nt(e,t,i,1,0,!0,!1,!1,"#fff")},a,5),r(function(t,i){Nt(e,t,i,0,0,!0,!0,!1,"#fff")},a,6),r(function(t,i){Nt(e,t,i,1,0,!0,!0,!1,"#fff")},a,7);var h=function(t,i,n){var o;for(o=0;o<4;o++)r(function(t,i){zt(e,t,i,n,o)},t,i),i++};h(++a,0,0),h(a,4,3),h(++a,0,2),h(a,4,1),r(function(t,i){It(e,t,i,200,"#33ffff")},++a,0),r(function(t,i){It(e,t,i,400,"#33ffff")},a,1),r(function(t,i){It(e,t,i,800,"#33ffff")},a,2),r(function(t,i){It(e,t,i,1600,"#33ffff")},a,3),r(function(t,i){It(e,t,i,100,"#ffb8ff")},a,4),r(function(t,i){It(e,t,i,300,"#ffb8ff")},a,5),r(function(t,i){It(e,t,i,500,"#ffb8ff")},a,6),r(function(t,i){It(e,t,i,700,"#ffb8ff")},a,7),r(function(t,i){It(e,t,i,1e3,"#ffb8ff")},a,8),r(function(t,i){It(e,t,i,2e3,"#ffb8ff")},a,9),r(function(t,i){It(e,t,i,3e3,"#ffb8ff")},a,10),r(function(t,i){It(e,t,i,5e3,"#ffb8ff")},a,11),r(function(t,i){Rt(e,t,i,100,"#fff")},++a,0),r(function(t,i){Rt(e,t,i,200,"#fff")},a,1),r(function(t,i){Rt(e,t,i,500,"#fff")},a,2),r(function(t,i){Rt(e,t,i,700,"#fff")},a,3),r(function(t,i){Rt(e,t,i,1e3,"#fff")},a,4),r(function(t,i){Rt(e,t,i,2e3,"#fff")},a,5),r(function(t,i){Rt(e,t,i,5e3,"#fff")},a,6),r(function(t,i){re(e,t,i,"#0ff")},++a,0),r(function(t,i){re(e,t,i,"#FFF")},a,1);var d=function(t,i,n){var o;for(o=0;o<4;o++)r(function(t,i){Ot(e,t,i,n,o)},t,i),i++};d(++a,0,0),d(a,4,3),d(++a,0,2),d(a,4,1)},getCanvas:function(){return t},drawGhostSprite:o,drawMonsterSprite:function(t,e,i,o,r,a,s,l,u){var f,c;l?(f=13,c=r):a?(f=13,c=s?6:4,c+=o):(c=2*r+o,f=u==ve.color?9:u==xe.color?10:u==me.color?11:u==ge.color?12:13),n(f,c,t,e,i)},drawMuppetSprite:function(t,e,i,n,a,s,l,u,f){s?r(t,e,i,l?"cookieface":"cookie"):o(t,e,i,n,a,s,l,u,f)},drawOttoSprite:function(t,e,i,o,r){var a,s;0==o?(a=r,s=14):3==o?(a=r+4,s=14):2==o?(a=r,s=15):1==o&&(a=r+4,s=15),n(s,a,t,e,i)},drawMsOttoSprite:function(t,e,i,o,r){var a,s;0==o?(a=r,s=19):3==o?(a=r+4,s=19):2==o?(a=r,s=20):1==o&&(a=r+4,s=20),n(s,a,t,e,i)},drawPacmanSprite:function(t,e,i,o,r){n(6,0==r?0:2*o+1+(r-1),t,e,i)},drawMsPacmanSprite:function(t,e,i,o,r){n(7,3*o+r,t,e,i)},drawCookiemanSprite:function(t,e,i,o,r){n(8,3*o+r,t,e,i)},drawFruitSprite:r,drawGhostPoints:function(t,e,i,o){var r={200:0,400:1,800:2,1600:3}[o];null!=r&&n(16,r,t,e,i)},drawPacFruitPoints:function(t,e,i,o){var r={100:4,300:5,500:6,700:7,1000:8,2000:9,3000:10,5000:11}[o];null!=r&&n(16,r,t,e,i)},drawMsPacFruitPoints:function(t,e,i,o){var r={100:0,200:1,500:2,700:3,1000:4,2000:5,5000:6}[o];null!=r&&n(17,r,t,e,i)},drawSnail:function(t,e,i,o){n(18,o,t,e,i)}}}(),vt=function(){var e,i,n,o=2;st=o;var r,a=0,s=function(){var t=(window.innerWidth-10)/290,e=(window.innerHeight-10)/354,i=Math.min(t,e);return i*=1},l=function(){st=o=s(),function(){lt.width=290*o,lt.height=354*o;lt.style.width=lt.width/1,lt.style.height=lt.height/1,a>0&&i.restore(),i.save(),i.scale(o,o),e.width=226*o,e.height=290*o,a>0&&n.restore(),n.save(),n.scale(o,o),a++}(),pt.create(),at&&at.drawMap(),u()},u=function(){var t=290*(s()/1);Math.max(0,(window.innerWidth-10)/2-t/2);document.body.style.marginLeft=(window.innerWidth-t)/2+"px",document.getElementById("about-game").style.marginLeft=-(window.innerWidth-t)/10+"px"};lt=document.getElementById("canvas"),e=document.createElement("canvas"),i=lt.getContext("2d"),n=e.getContext("2d"),l(),window.addEventListener("resize",function(){clearTimeout(r),r=setTimeout(l,100)},!1);var c=function(){n.fillStyle="#000",n.fillRect(0,0,226,290),n.translate(1,1)},d=function(){n.translate(-1,-1)},_=function(){this.actorSize=14,this.energizerSize=10,this.pointsEarnedTextSize=8,this.energizerColor="#FFF",this.pelletColor="#888",this.flashLevel=!1},p=function(){_.call(this,i,n),this.messageRow=21.7,this.pointsEarnedTextSize=12,this.backColor="#222",this.floorColor="#444",this.flashFloorColor="#999",this.name="Minimal"};p.prototype=t(_.prototype={setOverlayColor:function(t){this.overlayColor=t},beginMapClip:function(){i.save(),i.beginPath(),i.rect(-1,-1,225,289),i.clip()},endMapClip:function(){i.restore()},beginFrame:function(){var t;this.setOverlayColor(void 0),i.save(),i.fillStyle="#000",t=32,i.fillRect(0,0,290,33),i.fillRect(0,t,t,290),i.fillRect(256,t,34,290),i.fillRect(0,320,290,34),i.translate(33,33)},endFrame:function(){i.restore(),null!=this.overlayColor&&(i.fillStyle=this.overlayColor,i.fillRect(0,0,290,354))},clearMapFrame:function(){i.fillStyle="#000",i.fillRect(-1,-1,227,291)},renderFunc:function(t,e){e?t.call(e,i):t(i)},drawNoGroutTile:function(t,e,i,n){var o=on.getTile(e,i);this.drawCenterTileSq(t,e,i,8,on.getTile(e+1,i)==o,on.getTile(e,i+1)==o,on.getTile(e+1,i+1)==o)},drawCenterTileSq:function(t,e,i,n,o,r,a){this.drawCenterPixelSq(t,8*e+W,8*i+Y,n,o,r,a)},drawCenterPixelSq:function(t,e,i,n,o,r,a){t.fillRect(e-n/2,i-n/2,n,n);o&&t.fillRect(e-n/2,i-n/2,n+1,n),r&&t.fillRect(e-n/2,i-n/2,n,n+1)},toggleLevelFlash:function(){this.flashLevel=!this.flashLevel},setLevelFlash:function(t){t!=this.flashLevel&&(this.flashLevel=t,this.drawMap())},drawTargets:function(){var t;for(i.strokeStyle="rgba(255,255,255,0.5)",i.lineWidth="1.5",i.lineCap="round",i.lineJoin="round",t=0;t<5;t++)we[t].isDrawTarget&&we[t].drawTarget(i)},drawPaths:function(){var t,e=i.globalAlpha;for(i.globalAlpha=.7,t=0;t<5;t++)we[t].isDrawPath&&this.drawPath(we[t]);i.globalAlpha=e},drawPath:function(t){if(t.targetting){var e,n={x:t.tile.x,y:t.tile.y},o=t.targetTile,r={x:t.dir.x,y:t.dir.y},a=t.dirEnum;if(n.x!=o.x||n.y!=o.y){(0==a&&t.tilePixel.y<=Y||2==a&&t.tilePixel.y>=Y||1==a&&t.tilePixel.x<=W||3==a&t.tilePixel.x>=W)&&(n.x+=r.x,n.y+=r.y);var s,l={x:8*n.x+W,y:8*n.y+Y},u=Math.abs(8*n.x+W-t.pixel.x+8*n.y+Y-t.pixel.y),f=8*Se;if(i.strokeStyle=t.pathColor,i.lineWidth="2.0",i.lineCap="round",i.lineJoin="round",i.beginPath(),i.moveTo(t.pixel.x+t.pathCenter.x,t.pixel.y+t.pathCenter.y),i.lineTo(l.x+t.pathCenter.x,l.y+t.pathCenter.y),n.x==o.x&&n.y==o.y)s=t.getPathDistLeft(l,a);else for(;;){if(e=H(n,a),t!=ye&&on.constrainGhostTurns&&on.constrainGhostTurns(n,e,a),a=G(n,o,e),O(r,a),n.x+r.x==o.x&&n.y+r.y==o.y){s=t.getPathDistLeft(l,a),s=Math.min(f-u,s);break}if(u+8>f){s=f-u;break}n.x+=r.x,n.y+=r.y,l.x+=8*r.x,l.y+=8*r.y,u+=8,i.lineTo(8*n.x+W+t.pathCenter.x,8*n.y+Y+t.pathCenter.y)}var c=l.x+t.pathCenter.x+s*r.x,h=l.y+t.pathCenter.y+s*r.y;i.lineTo(c,h);1==a||3==a?(i.lineTo(c-3*r.x,h+3*r.x),i.moveTo(c,h),i.lineTo(c-3*r.x,h-3*r.x)):(i.lineTo(c+3*r.y,h-3*r.y),i.moveTo(c,h),i.lineTo(c-3*r.y,h-3*r.y)),i.stroke()}}},erasePellet:function(t,e){n.translate(1,1),n.fillStyle=this.floorColor,this.drawNoGroutTile(n,t,e,8)," "==on.getTile(t+1,e)&&this.drawNoGroutTile(n,t+1,e,8)," "==on.getTile(t-1,e)&&this.drawNoGroutTile(n,t-1,e,8)," "==on.getTile(t,e+1)&&this.drawNoGroutTile(n,t,e+1,8)," "==on.getTile(t,e-1)&&this.drawNoGroutTile(n,t,e-1,8),n.translate(-1,-1)},drawMessage:function(t,e,n,o){i.font="8px ArcadeR",i.textBaseline="top",i.textAlign="right",i.fillStyle=e,n+=t.length,i.fillText(t,8*n,8*o)},drawReadyMessage:function(){this.drawMessage("READY ","#FF0",11,20),se(i,131,163)},drawEatenPoints:function(){pt.drawGhostPoints(i,ye.pixel.x,ye.pixel.y,Ue.getPoints())},drawActors:function(){var t;if(Ue.isActive()){for(t=0;t<4;t++)this.drawGhost(be[t]);Ue.showingPoints()?this.drawEatenPoints():this.drawPlayer()}else{for(this.drawPlayer(),t=3;t>=0;t--)be[t].isVisible&&this.drawGhost(be[t]);me.isVisible&&!ve.isVisible&&this.drawGhost(ve,.5)}}},{drawMap:function(){var t,e,i;for(c(),n.fillStyle=this.flashLevel?this.flashFloorColor:this.floorColor,i=0,e=0;e<on.numRows;e++)for(t=0;t<on.numCols;t++)" "==on.currentTiles[i++]&&this.drawNoGroutTile(n,t,e,8);for(n.fillStyle=this.pelletColor,i=0,e=0;e<on.numRows;e++)for(t=0;t<on.numCols;t++)"."==on.currentTiles[i++]&&this.drawNoGroutTile(n,t,e,8);d()},refreshPellet:function(t,e){var i=on.posToIndex(t,e),o=on.currentTiles[i];" "==o?this.erasePellet(t,e):"."==o&&(n.fillStyle=this.pelletColor,this.drawNoGroutTile(n,t,e,8))},drawScore:function(){i.font="12px sans-serif",i.textBaseline="top",i.textAlign="left",i.fillStyle="#FFF",i.fillText(D(),8,16),i.font="bold 12px sans-serif",i.textBaseline="top",i.textAlign="center",i.fillText("high score",8*on.numCols/2,3),i.fillText(L(),8*on.numCols/2,16)},drawExtraLives:function(){var t;i.fillStyle="rgba(255,255,0,0.6)";for(t=0;t<T;t++)this.drawCenterPixelSq(i,8*(2*t+3),8*(on.numRows-2)+Y,this.actorSize)},drawLevelIcons:function(){var t;i.fillStyle="rgba(255,255,255,0.5)";var e=this.actorSize;for(t=0;t<g;t++)i.fillRect(8*(on.numCols-2)-2*t*2,8*(on.numRows-2)+Y-e/2,2,e)},drawEnergizers:function(){var t,e;for(i.fillStyle=this.energizerColor,e=0;e<on.numEnergizers;e++)t=on.energizers[e],"o"==on.currentTiles[t.x+t.y*on.numCols]&&this.drawCenterTileSq(i,t.x,t.y,this.energizerSize)},drawPlayer:function(t,e){null==t&&(t=1),null==e&&(e=1),i.fillStyle="rgba(255,255,0,"+e+")",this.drawCenterPixelSq(i,ye.pixel.x,ye.pixel.y,this.actorSize*t)},drawDyingPlayer:function(t){var e=85*t;e<=60?(t=e/60,this.drawPlayer(1-t)):(t=(e-=60)/15,this.drawPlayer(t,1-t))},drawGhost:function(t){if(t.mode!=ce){var e=t.color;t.scared?e=Ue.isFlash()?"#FFF":"#2121ff":t.mode!=he&&t.mode!=de||(e="rgba(255,255,255,0.3)"),i.fillStyle=e,this.drawCenterPixelSq(i,t.pixel.x,t.pixel.y,this.actorSize)}},drawFruit:function(){oi.isPresent()?(i.fillStyle="#0F0",this.drawCenterPixelSq(i,oi.pixel.x,oi.pixel.y,10)):oi.isScorePresent()&&(i.font=this.pointsEarnedTextSize+"px sans-serif",i.textBaseline="middle",i.textAlign="center",i.fillStyle="#FFF",i.fillText(oi.getPoints(),oi.pixel.x,oi.pixel.y))}});var m=function(t,e){_.call(this,t,e),this.messageRow=20,this.pelletSize=2,this.energizerSize=8,this.backColor="#000",this.floorColor="#000",this.flashWallColor="#FFF",this.name="Arcade"};m.prototype=t(_.prototype,{blitMap:function(){i.scale(1/o,1/o),i.drawImage(e,-1-1*o,-1-1*o),i.scale(o,o)},drawMap:function(t){if(c(),on){var e,i;for(li!=Ni&&(this.flashLevel=!1),a=0,i=0;i<on.numRows;i++)for(e=0;e<on.numCols;e++)"-"==on.currentTiles[a]&&"-"==on.currentTiles[a+1]&&(n.fillStyle="#ffb8de",n.fillRect(8*e,8*i+8-2,16,2)),a++;for(this.flashLevel?(n.fillStyle="#000",n.strokeStyle="#fff"):(n.fillStyle=on.wallFillColor,n.strokeStyle=on.wallStrokeColor),a=0;a<on.paths.length;a++){var o=on.paths[a];for(n.beginPath(),n.moveTo(o[0].x,o[0].y),s=1;s<o.length;s++)null!=o[s].cx?n.quadraticCurveTo(o[s].cx,o[s].cy,o[s].x,o[s].y):n.lineTo(o[s].x,o[s].y);n.quadraticCurveTo(o[s-1].x,o[0].y,o[0].x,o[0].y),n.fill(),n.stroke()}for(n.fillStyle=on.pelletColor,a=0,i=0;i<on.numRows;i++)for(e=0;e<on.numCols;e++)this.refreshPellet(e,i,!0);if(on.onDraw&&on.onDraw(n),on.shouldDrawMapOnly)return void d()}if(g>0){if(!t){n.fillStyle=ye.color,n.save(),n.translate(24,280),n.scale(.85,.85);var r=T==1/0?1:T;if(0==h)for(a=0;a<r;a++)Ht(n,0,0,1,Math.PI/6),n.translate(16,0);else if(1==h)for(a=0;a<r;a++)qt(n,0,0,3,1),n.translate(16,0);else if(2==h)for(a=0;a<r;a++)Wt(n,0,0,3,1,!1),n.translate(16,0);else if(3==h)for(a=0;a<r;a++)zt(n,0,0,3,0),n.translate(16,0);if(T==1/0){n.translate(-32,0);n.beginPath(),n.moveTo(-5,0),n.quadraticCurveTo(-5,-2,-3,-2),n.bezierCurveTo(-1,-2,1,2,3,2),n.quadraticCurveTo(5,2,5,0),n.quadraticCurveTo(5,-2,3,-2),n.bezierCurveTo(1,-2,-1,2,-3,2),n.quadraticCurveTo(-5,2,-5,0),n.lineWidth=1,n.strokeStyle="#FFF",n.stroke()}n.restore()}var a,s,l,u,f=oi.fruitHistory,_=Math.max(7,g);0!=h&&(_=Math.min(7,_));for(a=0,s=_-7+1;a<7&&s<=g;s++,a++)(l=f[s])&&(u=ne(l.name))&&(n.save(),n.translate(200-16*a*.85,280),n.scale(.85,.85),u(n,0,0),n.restore());t||(n.font=g>=100?"5px ArcadeR":"7px ArcadeR",n.textBaseline="middle",n.fillStyle="#777",n.textAlign="left",n.fillText(g,208,280))}d()},erasePellet:function(t,e,i){i||n.translate(1,1),n.fillStyle="#000";var o=on.posToIndex(t,e),r="o"==on.tiles[o]?this.energizerSize:this.pelletSize;this.drawCenterTileSq(n,t,e,r+2),i||n.translate(-1,-1)},refreshPellet:function(t,e,i){i||n.translate(1,1);var o=on.posToIndex(t,e),r=on.currentTiles[o];" "==r?this.erasePellet(t,e,i):"."==r?(n.fillStyle=on.pelletColor,n.translate(.5,.5),this.drawCenterTileSq(n,t,e,this.pelletSize),n.translate(-.5,-.5)):"o"==r&&(n.fillStyle=on.pelletColor,n.beginPath(),n.arc(8*t+W+.5,8*e+Y,this.energizerSize/2,0,2*Math.PI),n.fill()),i||n.translate(-1,-1)},drawScore:function(){i.font="8px ArcadeR",i.textBaseline="top",i.fillStyle="#FFF",i.textAlign="right",i.fillText("1UP",48,0),i.fillText(f?"PRACTICE":"HIGH SCORE",152,0);var t=D();0==t&&(t="00");if(i.fillText(t,56,9),!f){var e=L();0==e&&(e="00"),i.fillText(e,136,9)}},drawGhost:function(t,e){var n;e&&(n=i.globalAlpha,i.globalAlpha=e);var o=function(e,n,o,r,a,s,l,u){if(e!=ce){var f=t.getAnimFrame(o),c=e==he||e==de,h=v(),d=t.getBounceY(n.x,n.y,u),_=t==ve&&a?n.x+1:n.x;h(i,_,d,f,r,a,s,c,l)}};Mn.drawHistory(i,function(e){o(t.savedMode[e],t.savedPixel[e],t.savedFrames[e],t.savedFaceDirEnum[e],t.savedScared[e],Ue.isFlash(),t.color,t.savedDirEnum[e])}),o(t.mode,t.pixel,t.frames,t.faceDirEnum,t.scared,Ue.isFlash(),t.color,t.dirEnum),e&&(i.globalAlpha=n)},drawPlayer:function(){ye.getAnimFrame();ye.invincible&&(i.globalAlpha=.6);var t=function(t,e,n){var o=ye.getAnimFrame(ye.getStepFrame(n));x()(i,t.x,t.y,e,o,!0)};Mn.drawHistory(i,function(e){t(ye.savedPixel[e],ye.savedDirEnum[e],ye.savedSteps[e])}),t(ye.pixel,ye.dirEnum,ye.steps),ye.invincible&&(i.globalAlpha=1)},drawDyingPlayer:function(t){var e=ye.getAnimFrame();if(0==h){var n=75*t;if(n<=60){t=n/60;var o=e*Math.PI/6;Ht(i,ye.pixel.x,ye.pixel.y,ye.dirEnum,o+t*(Math.PI-o),4*t)}else n-=60,this.drawExplodingPlayer(n/15)}else if(3==h){if(t<.8)(r=Math.floor(ye.dirEnum-16*t)%4)<0&&(r+=4),zt(i,ye.pixel.x,ye.pixel.y,r,0);else if(t<.95){var r;(r=Math.floor(ye.dirEnum-12.8)%4)<0&&(r+=4),zt(i,ye.pixel.x,ye.pixel.y,r,0)}else Gt(i,ye.pixel.x,ye.pixel.y)}else if(1==h){var a=5*Math.PI,s=Math.PI/4/a,l=Math.floor(t/s)*s*a;qt(i,ye.pixel.x,ye.pixel.y,ye.dirEnum,e,l)}else if(2==h){a=5*Math.PI,s=Math.PI/4/a,l=Math.floor(t/s)*s*a;Wt(i,ye.pixel.x,ye.pixel.y,ye.dirEnum,e,!1,l)}},drawExplodingPlayer:function(t){ye.getAnimFrame();Ht(i,ye.pixel.x,ye.pixel.y,ye.dirEnum,0,0,t,-3,1-t)},drawFruit:function(){if(oi.getCurrentFruit()){var t=oi.getCurrentFruit().name;oi.savedPixel&&Mn.drawHistory(i,function(e){var n=oi.savedPixel[e];n&&pt.drawFruitSprite(i,n.x,n.y,t)}),oi.isPresent()?pt.drawFruitSprite(i,oi.pixel.x,oi.pixel.y,t):oi.isScorePresent()&&(0==h?pt.drawPacFruitPoints(i,oi.pixel.x,oi.pixel.y,oi.getPoints()):pt.drawMsPacFruitPoints(i,oi.pixel.x,oi.pixel.y,oi.getPoints()))}}}),rt=[new p,new m],at=rt[1]},xt=(ut=!1,{update:function(){var t=this.isValidState();t!=ut&&((ut=t)?(At.onHudEnable(),Mn.onHudEnable()):(At.onHudDisable(),Mn.onHudDisable()))},draw:function(t){At.draw(t),Mn.draw(t)},isValidState:function(){return li==Ai||li==Mi||li==ki||li==Di||li==Ni||li==Ri||li==Bi}}),mt=(ht={},dt=Math.floor(435),{init:function(){var t;for(ct=0,ft=0,t=0;t<200;t++)ht[t]={x:u(0,225),y:u(0,dt-1),color:"#"+("00000"+(Math.random()*(1<<24)|0).toString(16)).slice(-6),phase:u(0,119)}},draw:function(t){var e,i,n;for(t.fillStyle="#FFF",e=0;e<200;e++)i=ht[e],(ct+i.phase)%120>=30&&((n=i.y-ft)<0&&(n+=dt),t.fillStyle=i.color,t.fillRect(i.x,n,1,1))},update:function(){ct++,ct%=120,ft+=-.5,(ft%=dt)<0&&(ft+=dt)}}),gt=function(t){for(var e=lt,i=0,n=0;"BODY"!=e.tagName;)i+=e.offsetTop,n+=e.offsetLeft,e=e.offsetParent;var o=t.pageX-n,r=t.pageY-i;return o/=st/1,r/=st/1,{x:o-=32,y:r-=32}},yt=function(t,e,i,n,o){this.x=t,this.y=e,this.w=i,this.h=n,this.onclick=o,this.pad=8,this.frame=0,this.borderBlurColor="#333",this.borderFocusColor="#EEE",this.isSelected=!1,this.startedInside=!1;var r=this,a=function(t){if(t.preventDefault(),1==t.touches.length){var e=gt(t.touches[0]);(r.startedInside=r.contains(e.x,e.y))?r.focus():r.blur()}else u(t)},s=function(t){if(t.preventDefault(),1==t.touches.length){if(r.startedInside){var e=gt(t.touches[0]);r.contains(e.x,e.y)?r.focus():r.blur()}}else u(t)},l=function(t){t.preventDefault();var e=r.startedInside&&r.isSelected;e&&r.click(),u(t),e&&r.focus()},u=function(t){t.preventDefault(),this.startedInside=!1,r.blur()},f=function(t){var e=gt(t);r.contains(e.x,e.y)&&r.click()},c=function(t){var e=gt(t);r.contains(e.x,e.y)?r.focus():r.blur()},h=function(t){r.blur()};this.isEnabled=!1,this.onEnable=function(){lt.addEventListener("click",f),lt.addEventListener("mousemove",c),lt.addEventListener("mouseleave",h),lt.addEventListener("touchstart",a),lt.addEventListener("touchmove",s),lt.addEventListener("touchend",l),lt.addEventListener("touchcancel",u),this.isEnabled=!0},this.onDisable=function(){lt.removeEventListener("click",f),lt.removeEventListener("mousemove",c),lt.removeEventListener("mouseleave",h),lt.removeEventListener("touchstart",a),lt.removeEventListener("touchmove",s),lt.removeEventListener("touchend",l),lt.removeEventListener("touchcancel",u),r.blur(),this.isEnabled=!1}},Tt=function(t,e,i,n,o,r){var a=this;this.isOn=o,this.setOn=r,yt.call(this,t,e,i,n,function(){r(!o()),a.refreshMsg()})};Tt.prototype=t(yt.prototype={contains:function(t,e){return t>=this.x&&t<=this.x+this.w&&e>=this.y&&e<=this.y+this.h},click:function(){clearTimeout(this.clickTimeout);var t=this;t.onclick&&(this.clickTimeout=setTimeout(function(){t.onclick()},200)),console.log(this.msg),this.msg&&"BACK"==this.msg||"YES"==this.msg?document.getElementById("about-game").style="display: block":document.getElementById("about-game").style="display: none"},enable:function(){this.frame=0,this.onEnable()},disable:function(){this.onDisable()},focus:function(){this.isSelected=!0,this.onfocus&&this.onfocus()},blur:function(){this.isSelected=!1,this.onblur&&this.onblur()},setText:function(t){this.msg=t},setFont:function(t,e){this.font=t,this.fontcolor=e},setIcon:function(t){this.drawIcon=t},draw:function(t){t.lineWidth=2,t.beginPath();var e=this.x,i=this.y,n=this.w,o=this.h,r=o/4;t.moveTo(e,i+r),t.quadraticCurveTo(e,i,e+r,i),t.lineTo(e+n-r,i),t.quadraticCurveTo(e+n,i,e+n,i+r),t.lineTo(e+n,i+o-r),t.quadraticCurveTo(e+n,i+o,e+n-r,i+o),t.lineTo(e+r,i+o),t.quadraticCurveTo(e,i+o,e,i+o-r),t.closePath(),t.fillStyle="rgba(0,0,0,0.5)",t.fill(),t.strokeStyle=this.isSelected&&this.onclick?this.borderFocusColor:this.borderBlurColor,t.stroke(),this.drawIcon&&(this.msg?this.drawIcon(t,this.x+this.pad+8,this.y+this.h/2,this.frame):this.drawIcon(t,this.x+this.w/2,this.y+this.h/2,this.frame)),this.msg&&(t.font=this.font,t.fillStyle=this.isSelected&&this.onclick?this.fontcolor:"#777",t.textBaseline="middle",t.textAlign="center",t.fillText(this.msg,this.x+this.w/2,this.y+this.h/2+1))},update:function(){this.drawIcon&&(this.frame=this.isSelected?this.frame+1:0)}},{enable:function(){yt.prototype.enable.call(this),this.refreshMsg()},setToggleLabel:function(t){this.label=t},refreshMsg:function(){this.label&&(this.msg=this.label+": "+(this.isOn()?"ON":"OFF"))},refreshOnState:function(){this.setOn(this.isOn())}});var wt=function(t,e,i,n,o,r,a,s){this.title=t,this.x=e,this.y=i,this.w=n,this.h=o,this.pad=r,this.buttons=[],this.buttonCount=0,this.currentY=this.y+this.pad,t&&(this.currentY+=1*(this.h+this.pad)),this.font=a,this.fontcolor=s,this.enabled=!1,this.backButton=void 0};wt.prototype={clickCurrentOption:function(){var t;for(t=0;t<this.buttonCount;t++)if(this.buttons[t].isSelected){this.buttons[t].onclick();break}},selectNextOption:function(){var t,e;for(t=0;t<this.buttonCount;t++)if(this.buttons[t].isSelected){this.buttons[t].blur(),e=this.buttons[(t+1)%this.buttonCount];break}(e=e||this.buttons[0]).focus()},selectPrevOption:function(){var t,e;for(t=0;t<this.buttonCount;t++)if(this.buttons[t].isSelected){this.buttons[t].blur(),e=this.buttons[0==t?this.buttonCount-1:t-1];break}(e=e||this.buttons[this.buttonCount-1]).focus()},addToggleButton:function(t,e){var i=new Tt(this.x+this.pad,this.currentY,this.w-2*this.pad,this.h,t,e);this.buttons.push(i),this.buttonCount++,this.currentY+=this.pad+this.h},addToggleTextButton:function(t,e,i){var n=new Tt(this.x+this.pad,this.currentY,this.w-2*this.pad,this.h,e,i);n.setFont(this.font,this.fontcolor),n.setToggleLabel(t),this.buttons.push(n),this.buttonCount++,this.currentY+=this.pad+this.h},addTextButton:function(t,e){var i=new yt(this.x+this.pad,this.currentY,this.w-2*this.pad,this.h,e);i.setFont(this.font,this.fontcolor),i.setText(t),this.buttons.push(i),this.buttonCount++,this.currentY+=this.pad+this.h},addTextIconButton:function(t,e,i){var n=new yt(this.x+this.pad,this.currentY,this.w-2*this.pad,this.h,e);n.setFont(this.font,this.fontcolor),n.setText(t),n.setIcon(i),this.buttons.push(n),this.buttonCount++,this.currentY+=this.pad+this.h},addIconButton:function(t,e){var i=new yt(this.x+this.pad,this.currentY,this.w-2*this.pad,this.h,e);i.setIcon(t),this.buttons.push(i),this.buttonCount++,this.currentY+=this.pad+this.h},addSpacer:function(t){null==t&&(t=1),this.currentY+=t*(this.pad+this.h)},enable:function(){var t;for(t=0;t<this.buttonCount;t++)this.buttons[t].enable();this.enabled=!0},disable:function(){var t;for(t=0;t<this.buttonCount;t++)this.buttons[t].disable();this.enabled=!1},isEnabled:function(){return this.enabled},draw:function(t){var e;for(this.title&&(t.font="8px ArcadeR",t.textBaseline="middle",t.textAlign="center",t.fillStyle="#FFF",t.fillText(this.title,this.x+this.w/2,this.y+this.pad+this.h/2)),e=0;e<this.buttonCount;e++)this.buttons[e].draw(t)},update:function(){var t;for(t=0;t<this.buttonCount;t++)this.buttons[t].update()}};var bt,St,Pt,Ft,Ct,Mt,Et,kt,Dt,At=function(){var t=function(){return f?l:s},e=function(){t().enable()},i=function(){t().disable()},n=new yt(89,290,48,24,function(){e(),Mn.onHudDisable()});n.setText("MENU"),n.setFont("8px ArcadeR","#FFF");var o=new wt("QUESTION?",16,40,194,24,8,"8px ArcadeR","#EEE");o.addTextButton("YES",function(){o.disable(),o.onConfirm()}),o.addTextButton("NO",function(){o.disable(),e()}),o.addTextButton("CANCEL",function(){o.disable(),e()}),o.backButton=o.buttons[o.buttonCount-1];var r=function(t,e){i(),o.title=t,o.onConfirm=e,o.enable()},s=new wt("PAUSED",16,40,194,24,8,"8px ArcadeR","#EEE");s.addTextButton("RESUME",function(){s.disable()}),s.addTextButton("QUIT",function(){r("QUIT GAME?",function(){mi(yi,60)})}),s.backButton=s.buttons[0];var l=new wt("PAUSED",16,40,194,24,8,"8px ArcadeR","#EEE");l.addTextButton("RESUME",function(){i(),Mn.onHudEnable()}),l.addTextButton("RESTART LEVEL",function(){r("RESTART LEVEL?",function(){g--,mi(ki,60)})}),l.addTextButton("SKIP LEVEL",function(){r("SKIP LEVEL?",function(){mi(ki,60)})}),l.addTextButton("CHEATS",function(){l.disable(),u.enable()}),l.addTextButton("QUIT",function(){r("QUIT GAME?",function(){mi(yi,60),a(),Mn.reset()})}),l.backButton=l.buttons[0];var u=new wt("CHEATS",16,40,194,24,8,"8px ArcadeR","#EEE");u.addToggleTextButton("INVINCIBLE",function(){return ye.invincible},function(t){ye.invincible=t}),u.addToggleTextButton("TURBO",function(){return c},function(t){c=t}),u.addToggleTextButton("SHOW TARGETS",function(){return ve.isDrawTarget},function(t){for(var e=0;e<4;e++)be[e].isDrawTarget=t}),u.addToggleTextButton("SHOW PATHS",function(){return ve.isDrawPath},function(t){for(var e=0;e<4;e++)be[e].isDrawPath=t}),u.addSpacer(1),u.addTextButton("BACK",function(){u.disable(),l.enable()}),u.backButton=u.buttons[u.buttons.length-1];var h=[s,l,o,u],d=function(){var t,e,i=h.length;for(t=0;t<i;t++)if((e=h[t]).isEnabled())return e};return{onHudEnable:function(){n.enable()},onHudDisable:function(){n.disable()},update:function(){n.isEnabled&&n.update()},draw:function(t){var e=d();e?(t.fillStyle="rgba(0,0,0,0.8)",t.fillRect(-2,-2,227,291),e.draw(t)):n.draw(t)},isOpen:function(){return null!=d()},getMenu:function(){return d()},getMenuButton:function(){return n}}}(),Lt=(St=function(t){t.save(),t.translate(.5,0),t.moveTo(0,6),t.quadraticCurveTo(1.5,0,6.5,0),t.quadraticCurveTo(11.5,0,13,6),t.restore()},bt=[13,13,11,11,9,13,8,13,8,11,5,11,5,13,4,13,2,11,0,13],Pt=function(t){var e;for(t.save(),t.translate(.5,.5),e=0;e<bt.length;e+=2)t.lineTo(bt[e],bt[e+1]);t.restore()},Ft=function(){var t=[13,12,12,13,11,13,9,11,7,13,6,13,4,11,2,13,1,13,0,12];return function(e){var i;for(e.save(),e.translate(.5,.5),i=0;i<t.length;i+=2)e.lineTo(t[i],t[i+1]);e.restore()}}(),function(t,e,n,o,r,a,s,l,u){t.save(),t.translate(e-7,n-7),a&&(u=s?"#FFF":"#2121ff"),l||(t.beginPath(),St(t),0==o?Pt(t):Ft(t),t.closePath(),t.lineJoin="round",t.lineCap="round",t.lineWidth=.5,t.strokeStyle=u,t.stroke(),t.lineWidth=1,t.fillStyle=u,t.fill()),a?function(t,e){t.strokeStyle=t.fillStyle=e?"#F00":"#FF0",t.fillRect(4,5,2,2),t.fillRect(8,5,2,2);var n=[1,10,2,9,3,9,4,10,5,10,6,9,7,9,8,10,9,10,10,9,11,9,12,10];for(t.translate(.5,.5),t.beginPath(),t.moveTo(n[0],n[1]),i=2;i<n.length;i+=2)t.lineTo(n[i],n[i+1]);t.lineWidth=1,t.stroke(),t.translate(-.5,-.5)}(t,s):function(t,e){var i;t.save(),t.translate(2,3);var n=[0,1,1,0,2,0,3,1,3,3,2,4,1,4,0,3],o=function(){for(t.translate(.5,.5),t.beginPath(),t.moveTo(n[0],n[1]),i=2;i<n.length;i+=2)t.lineTo(n[i],n[i+1]);t.closePath(),t.fill(),t.lineJoin="round",t.stroke(),t.translate(-.5,-.5)};1==e?t.translate(-1,0):3==e?t.translate(1,0):0==e?t.translate(0,-1):2==e&&t.translate(0,1),t.fillStyle="#FFF",t.strokeStyle="#FFF",t.lineWidth=1,t.lineJoin="round",o(),t.translate(6,0),o(),1==e?t.translate(0,2):3==e?t.translate(2,2):0==e?t.translate(1,0):2==e&&t.translate(1,3),t.fillStyle="#00F",t.fillRect(0,0,2,2),t.translate(-6,0),t.fillRect(0,0,2,2),t.restore()}(t,r),t.restore()}),It=function(){var t,e,i=function(e,i){var n,o=e.length;for(t.beginPath(),t.moveTo(e[0],e[1]),n=2;n<o;n+=2)t.lineTo(e[n],e[n+1]);t.closePath(),t.lineWidth=1,t.lineCap=t.lineJoin="round",t.strokeStyle=i,t.stroke()},n=function(e,i){var n,o=e.length;for(t.beginPath(),t.moveTo(e[0],e[1]),n=2;n<o;n+=2)t.lineTo(e[n],e[n+1]);t.lineWidth=1,t.lineCap=t.lineJoin="round",t.strokeStyle=i,t.stroke()},o=function(n,o){t.save(),t.translate(n,o),i([1,0,2,0,3,1,3,5,2,6,1,6,0,5,0,1],e),t.restore()},r=function(i,o){t.save(),t.translate(i,o),n([0,1,1,0,1,6,0,6,2,6],e),t.restore()},a=function(i,o){t.save(),t.translate(i,o),n([0,2,0,1,1,0,3,0,4,1,4,2,0,6,4,6],e),t.restore()},s=function(i,o){t.save(),t.translate(i,o),n([0,0,4,0,2,2,4,4,4,5,3,6,1,6,0,5],e),t.restore()},l=function(i,o){t.save(),t.translate(i,o),n([4,0,0,0,0,2,3,2,4,3,4,5,3,6,1,6,0,5],e),t.restore()},u=function(){r(-5,-3),o(-1,-3),o(4,-3)},f=function(){a(-7,-3),o(-1,-3),o(4,-3)},c=function(){s(-7,-3),o(-1,-3),o(4,-3)},h=function(){var i,r;i=-7,r=-3,t.save(),t.translate(i,r),n([3,6,3,0,0,3,0,4,4,4],e),t.restore(),o(-1,-3),o(4,-3)},d=function(){l(-7,-3),o(-1,-3),o(4,-3)},_=function(){var i,r;i=-7,r=-3,t.save(),t.translate(i,r),n([0,1,0,0,4,0,4,1,2,4,2,6],e),t.restore(),o(-1,-3),o(4,-3)},p=function(){var n,r;n=-7,r=-3,t.save(),t.translate(n,r),i([1,0,3,0,4,1,4,2,3,3,1,3,0,4,0,5,1,6,3,6,4,5,4,4,3,3,1,3,0,2,0,1],e),t.restore(),o(-1,-3),o(4,-3)},v=function(){r(-8,-3),o(-4,-3),o(1,-3),o(6,-3)},x=function(){var i,r;n([i=-7,r=-3,i,r+6],e),function(i,o){t.save(),t.translate(i,o),n([3,0,1,0,0,1,0,5,1,6,2,6,3,5,3,3,0,3],e),t.restore()}(-5,-3),o(0,-3),o(5,-3)},m=function(){a(-10,-3),o(-4,-3),o(1,-3),o(6,-3)},g=function(){s(-10,-3),o(-4,-3),o(1,-3),o(6,-3)},y=function(){l(-10,-3),o(-4,-3),o(1,-3),o(6,-3)};return function(i,n,o,r,a){e=a,(t=i).save(),t.translate(n+.5,o+.5),t.translate(0,-1);var s={100:u,200:f,300:c,400:h,500:d,700:_,800:p,1000:v,1600:x,2000:m,3000:g,5000:y}[r];s&&s(),t.restore()}}(),Rt=function(){var t,e=function(e,i){var n,o=e.length;for(t.beginPath(),t.moveTo(e[0],e[1]),n=2;n<o;n+=2)t.lineTo(e[n],e[n+1]);t.lineWidth=1,t.lineCap=t.lineJoin="round",t.strokeStyle=i,t.stroke()},i=function(e,i){t.save(),t.translate(e,i),function(e,i){var n,o=e.length;for(t.beginPath(),t.moveTo(e[0],e[1]),n=2;n<o;n+=2)t.lineTo(e[n],e[n+1]);t.closePath(),t.lineWidth=1,t.lineCap=t.lineJoin="round",t.strokeStyle=i,t.stroke()}([0,0,2,0,2,4,0,4],"#fff"),t.restore()},n=function(i,n){t.save(),t.translate(i,n),e([1,0,1,4],"#fff"),t.restore()},o=function(i,n){t.save(),t.translate(i,n),e([0,0,2,0,2,2,0,2,0,4,2,4],"#fff"),t.restore()},r=function(i,n){t.save(),t.translate(i,n),e([2,0,0,0,0,2,2,2,2,4,0,4],"#fff"),t.restore()},a=function(){n(-5,-5),i(-1,-2),i(3,1)},s=function(){o(-5,-5),i(-1,-2),i(3,1)},l=function(){r(-5,-5),i(-1,-2),i(3,1)},u=function(){var n,o;n=-5,o=-5,t.save(),t.translate(n,o),e([0,0,2,0,2,4],"#fff"),t.restore(),i(-1,-2),i(3,1)},f=function(){n(-7,-7),i(-3,-4),i(1,-1),i(5,2)},c=function(){o(-7,-7),i(-3,-4),i(1,-1),i(5,2)},h=function(){r(-7,-7),i(-3,-4),i(1,-1),i(5,2)};return function(e,i,n,o){(t=e).save(),t.translate(i+.5,n+.5);var r={100:a,200:s,500:l,700:u,1000:f,2000:c,5000:h}[o];r&&r(),t.restore()}}(),Nt=function(){var t,e,i,n,o=function(e,i){var n,o=e.length;for(t.beginPath(),t.moveTo(e[0],e[1]),n=2;n<o;n+=2)t.lineTo(e[n],e[n+1]);t.lineWidth=1,t.lineCap=t.lineJoin="round",t.strokeStyle=i,t.stroke()},r=function(e,i){var n,o=e.length;for(t.beginPath(),t.moveTo(e[0],e[1]),n=2;n<o;n+=2)t.lineTo(e[n],e[n+1]);t.closePath(),t.lineWidth=1,t.lineJoin="round",t.fillStyle=t.strokeStyle=i,t.fill(),t.stroke()},a=function(e,i,n){t.save(),t.translate(i,n),r([0,1,1,0,2,0,3,1,3,3,2,4,1,4,0,3],"#FFF"),1==e?t.translate(0,2):3==e?t.translate(2,2):0==e?t.translate(1,0):2==e&&t.translate(1,3),r([0,0,1,0,1,1,0,1],"#00F"),t.restore()},s=function(){r([-7,-3,-3,-7,-1,-7,-2,-6,0,-4,3,-7,5,-7,4,-7,3,-6,6,-3,6,1,5,3,2,6,-4,6,-5,5,-7,1],e)},l=function(e,i){t.save(),t.translate(e,i),r([0,0,3,-3,4,-3,5,-2,5,-1,4,0],"#00F"),t.restore()},u=function(){o([-1,-7,0,-6],"#FFF"),o([5,-7,6,-6],"#FFF"),s(),l(1,6),o([-4,6,-1,6],"#00F"),a(3,-4,-4),a(3,2,-4)},f=function(){o([-1,-7,0,-7],"#FFF"),o([5,-7,6,-7],"#FFF"),s(),l(-4,6),o([2,6,5,6],"#00F"),a(3,-4,-4),a(3,2,-4)},c=function(){t.scale(-1,1),t.translate(1,0),u()},h=function(){t.scale(-1,1),t.translate(1,0),f()},d=function(){o([-6,-7,-7,-6],"#FFF"),o([5,-7,6,-6],"#FFF"),r([-7,-3,-4,-6,-5,-7,-6,-7,-4,-7,-3,-6,-2,-6,-1,-5,0,-5,1,-6,2,-6,3,-7,5,-7,4,-7,3,-6,6,-3,6,1,5,3,4,5,3,6,-4,6,-5,5,-6,3,-7,1],e)},_=function(){o([-6,-6,-7,-5],"#FFF"),o([5,-6,6,-5],"#FFF"),r([-7,-3,-4,-6,-5,-7,-6,-6,-5,-7,-4,-7,-3,-6,-2,-6,-1,-5,0,-5,1,-6,2,-6,3,-7,4,-7,5,-6,4,-7,3,-6,6,-3,6,1,5,3,4,5,3,6,-4,6,-5,5,-6,3,-7,1],e)},p=function(){d(),a(0,-5,-5),a(0,1,-5),r([-4,6,-3,5,-2,5,-1,6],"#00F")},v=function(){_(),a(0,-5,-5),a(0,1,-5),r([0,6,1,5,2,5,3,6],"#00F")},x=function(){d(),a(2,-5,-4),a(2,1,-4),r([0,6,1,4,2,3,3,3,4,4,4,5,3,6],"#00F"),o([-4,6,-2,6],"#00F")},m=function(){_(),a(2,-5,-4),a(2,1,-4),r([-1,6,-2,4,-3,3,-4,3,-5,4,-5,5,-4,6],"#00F"),o([1,6,3,6],"#00F")},g=function(){!function(e,i){var n,o=e.length;for(t.beginPath(),t.moveTo(e[0],e[1]),n=2;n<o;n+=2)t.lineTo(e[n],e[n+1]);t.closePath(),t.lineWidth=1,t.lineCap=t.lineJoin="round",t.strokeStyle=i,t.stroke()}([-6,-2,-2,-5,-3,-6,-5,-6,-3,-6,-1,-4,1,-4,3,-6,5,-6,3,-6,2,-5,6,-2,6,4,5,6,4,7,-4,7,-5,6,-6,4],i),o([-2,4,-1,3,1,3,2,4],n)},y=function(t){o([-2,-2,-2,0],n),o([-3,-1,-1,-1],n),o([2,-2,2,0],n),o([3,-1,1,-1],n),o([-5,-6,-6,-7],"#FFF"),o([5,-6,6,-7],"#FFF"),g()},T=function(t){o([-3,-2,-1,0],n),o([-3,0,-1,-2],n),o([1,-2,3,0],n),o([1,0,3,-2],n),o([-5,-6,-6,-5],"#FFF"),o([5,-6,6,-5],"#FFF"),g()};return function(o,r,a,s,l,d,_,g,w){g||(e=w,(t=o).save(),t.translate(r+.5,a+.5),d?(t.translate(0,-1),i=_?"#FFF":"#00F",n=_?"#F00":"#FF0",[y,T][s]()):3==l?[u,f][s]():1==l?[c,h][s]():2==l?[x,m][s]():0==l&&[p,v][s](),t.restore())}}(),Bt=function(t,e){var i,n=function(t,e){var n,o=t.length;for(i.beginPath(),i.moveTo(t[0],t[1]),n=2;n<o;n+=2)i.lineTo(t[n],t[n+1]);i.lineWidth=1,i.lineCap=i.lineJoin="round",i.strokeStyle=e,i.stroke()},o=function(t,e){var n,o=t.length;for(i.beginPath(),i.moveTo(t[0],t[1]),n=2;n<o;n+=2)i.lineTo(t[n],t[n+1]);i.closePath(),i.lineWidth=1,i.lineJoin="round",i.fillStyle=i.strokeStyle=e,i.fill(),i.stroke()},r=function(){o([-4,-5,-3,-6,-2,-6,-2,-5,-3,-4,-4,-4],e)},a=function(){o([-5,-4,-3,-6,2,-6,3,-5,-1,-3,3,-1,1,1,1,3,3,6,5,4,6,4,6,5,4,7,2,7,-1,1,-4,4,-3,6,-3,7,-4,7,-6,5,-6,4,-3,1,-5,-1],t),r()},s=function(){o([-5,-4,-3,-6,1,-6,3,-4,3,-1,1,1,1,6,4,6,4,7,0,7,0,1,-2,1,-4,3,-4,4,-3,5,-3,6,-4,6,-5,4,-5,3,-3,1,-5,-1],t),r()},l=function(){o([-5,-4,-3,-6,2,-6,3,-5,-1,-3,3,-1,1,1,1,3,4,3,4,4,0,4,0,1,-2,1,-2,6,1,6,1,7,-3,7,-3,1,-5,-1],t),r()},u=function(){o([-5,-4,-3,-6,2,-6,-2,-3,2,0,1,1,3,5,5,3,6,3,6,4,4,6,2,6,-1,1,-3,1,-3,6,0,6,0,7,-4,7,-4,2,-3,1,-5,-1],t),r()},f=function(){o([-5,-5,-4,-6,-3,-6,-3,-5,-4,-4,-5,-4],e),o([3,-6,4,-6,5,-5,5,-4,4,-4,3,-5],e)},c=function(){o([-4,-4,-2,-6,2,-6,4,-4,4,-1,2,1,-2,1,-4,-1],t)},h=function(e,n){i.save(),i.translate(0,e),i.scale(n,1),o([1,0,2,0,2,6,4,6,4,7,1,7],t),i.restore()},d=function(e,n){i.save(),i.translate(0,e),i.scale(n,1),o([1,0,2,0,2,4,3,5,4,4,5,4,5,5,3,7,2,7,1,6],t),i.restore()},_=function(){h(0,-1),d(-2,1)},p=function(){h(-2,-1),d(-2,1)},v=function(){d(-2,-1),h(0,1)},x=function(){d(0,-1),h(0,1)},m=function(){c(),f(),_(),n([-2,-3,2,-3],"#000")},g=function(){c(),f(),p()},y=function(){c(),f(),v(),n([-2,-3,2,-3],"#000")},T=function(){c(),f(),x(),o([-2,-3,0,-5,2,-3,0,-1],"#000")},w=function(){f(),c(),_()},b=function(){f(),c(),p()},S=function(){f(),c(),v()},P=function(){f(),c(),x()};return function(t,e,n,o,r,f){(i=t).save(),i.translate(e+.5,n+.5),f&&i.rotate(f),3==o?(i.translate(0,-1),[a,s,l,u][r]()):1==o?(i.translate(0,-1),i.scale(-1,1),[a,s,l,u][r]()):2==o?(i.translate(0,-1),[m,g,y,T][r]()):0==o&&(i.translate(0,-1),[w,b,S,P][r]()),i.restore()}},zt=Bt("#FF0","#00F"),Ot=Bt("#F00","#FFF"),Gt=function(t,e,i){t.save(),t.translate(e+2,i),function(e,i){var n,o=e.length;for(t.beginPath(),t.moveTo(e[0],e[1]),n=2;n<o;n+=2)t.lineTo(e[n],e[n+1]);t.closePath(),t.lineWidth=1,t.lineCap=t.lineJoin="round",t.strokeStyle=i,t.stroke()}([3,-5,-1,-5,-2,-6,-2,-7,-1,-8,3,-8,4,-7,4,-6],"#F00"),t.restore(),zt(t,e,i,1,2,Math.PI/2)},Ht=function(t,e,i,n,o,r,a,s,l,u,f){null==r&&(r=0),null==s&&(s=0),null==a&&(a=1),null==l&&(l=1),null==u&&(u="rgba(255,255,0,"+l+")"),t.save(),t.translate(e,i),t.scale(a,a),f&&t.rotate(f);var c=Math.PI/2;0==n?t.rotate(3*c):3==n?t.rotate(0):2==n?t.rotate(c):1==n&&t.rotate(2*c),t.beginPath(),t.moveTo(-3+r,0),t.arc(s,0,6.5,o,2*Math.PI-o),t.closePath(),t.fillStyle=u,t.fill(),t.restore()},qt=function(t,e,i,n,o,r){var a=0;0==o?Ht(t,e,i,n,0,void 0,void 0,void 0,void 0,void 0,r):1==o?(a=Math.atan(.8),Ht(t,e,i,n,a,void 0,void 0,void 0,void 0,void 0,r),a=Math.atan(.5)):2==o&&(a=Math.atan(2),Ht(t,e,i,n,a,void 0,void 0,void 0,void 0,void 0,r),a=Math.atan(1)),t.save(),t.translate(e,i),r&&t.rotate(r);var s=Math.PI/2;0==n?t.rotate(-s):2==n?t.rotate(s):1==n&&t.scale(-1,1);e=-7.5,i=-7.5;if(t.fillStyle="#F00",t.beginPath(),t.arc(e+1,i+4,1.25,0,2*Math.PI),t.closePath(),t.fill(),t.beginPath(),t.arc(e+2,i+5,1.25,0,2*Math.PI),t.closePath(),t.fill(),t.beginPath(),t.arc(e+3,i+3,1.25,0,2*Math.PI),t.closePath(),t.fill(),t.beginPath(),t.arc(e+4,i+1,1.25,0,2*Math.PI),t.closePath(),t.fill(),t.beginPath(),t.arc(e+5,i+2,1.25,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle="#0031FF",t.beginPath(),t.arc(e+2.5,i+3.5,.5,0,2*Math.PI),t.closePath(),t.fill(),t.beginPath(),t.arc(e+3.5,i+2.5,.5,0,2*Math.PI),t.closePath(),t.fill(),t.strokeStyle="#F00",t.lineWidth=1.25,t.lineCap="round",t.beginPath(),0==o)t.moveTo(5,0),t.lineTo(6.5,0),t.moveTo(6.5,-1.5),t.lineTo(6.5,1.5);else{var l=7.5,u=8.5,f=Math.cos(a),c=Math.sin(a);t.moveTo(l*f-3,l*c),t.lineTo(u*f-3,u*c),t.moveTo(l*f-3,-l*c),t.lineTo(u*f-3,-u*c)}if(t.stroke(),t.beginPath(),t.arc(-3,2,.5,0,2*Math.PI),t.fillStyle="#000",t.fill(),t.strokeStyle="#000",t.lineCap="round",t.beginPath(),0==o)t.moveTo(-2.5,-2),t.lineTo(-.5,-2);else{l=.5,u=2.5,f=Math.cos(a),c=Math.sin(a);t.moveTo(l*f-3,-2-l*c),t.lineTo(u*f-3,-2-u*c)}t.stroke(),t.restore()},Wt=(Ct=void 0,Mt=0,Et=0,kt=0,Dt=0,function(t,e,i,n,o,r,a){var s=0,l=function(o){Ht(t,e,i,n,o,void 0,void 0,void 0,void 0,"#47b8ff",a)};0==o?l(0):1==o?(l(s=Math.atan(.8)),s=Math.atan(.5)):2==o&&(l(s=Math.atan(2)),s=Math.atan(1)),t.save(),t.translate(e,i),a&&t.rotate(a);var u=Math.PI/2;0==n?t.rotate(-u):2==n?t.rotate(u):1==n&&t.scale(-1,1),e=-4,i=-3.5,s/=3,s+=Math.PI/8;var f=Math.cos(s),c=Math.sin(s);r&&(o!=Ct&&function(){var t=Math.random()*Math.PI*2,e=Math.random()*Math.PI*2,i=1*Math.random(),n=1*Math.random();Mt=Math.cos(t)*i,Et=Math.sin(t)*i,kt=Math.cos(e)*n,Dt=Math.sin(e)*n}(),Ct=o),t.beginPath(),t.arc(e+6*f,i-6*c,2.1,0,2*Math.PI),t.fillStyle="#FFF",t.fill(),t.beginPath(),t.arc(e+6*f+kt,i-6*c+Dt,1,0,2*Math.PI),t.fillStyle="#000",t.fill(),t.beginPath(),t.arc(e+3*f,i-3*c,2.1,0,2*Math.PI),t.fillStyle="#FFF",t.fill(),t.beginPath(),t.arc(e+3*f+Mt,i-3*c+Et,1,0,2*Math.PI),t.fillStyle="#000",t.fill(),t.restore()}),Yt=function(t,e,i){var n=function(e,i){t.save(),t.translate(e,i),t.beginPath(),t.arc(2.5,2.5,3,0,2*Math.PI),t.lineWidth=1,t.strokeStyle="#000",t.stroke(),t.fillStyle="#ff0000",t.fill(),t.lineCap="round",t.beginPath(),t.moveTo(1,3),t.lineTo(2,4),t.strokeStyle="#fff",t.stroke(),t.restore()};t.save(),t.translate(e,i),n(-6,-1),n(-1,1),t.beginPath(),t.moveTo(-3,0),t.bezierCurveTo(-1,-2,2,-4,5,-5),t.lineTo(5,-4),t.bezierCurveTo(3,-4,1,0,1,2),t.strokeStyle="#ff9900",t.lineJoin="round",t.lineCap="round",t.stroke(),t.restore()},Jt=function(t,e,i){t.save(),t.translate(e,i),t.beginPath(),t.moveTo(-1,-4),t.bezierCurveTo(-3,-4,-5,-3,-5,-1),t.bezierCurveTo(-5,3,-2,5,0,6),t.bezierCurveTo(3,5,5,2,5,0),t.bezierCurveTo(5,-3,3,-4,0,-4),t.fillStyle="#f00",t.fill(),t.strokeStyle="#f00",t.stroke();var n,o,r=[{x:-4,y:-1},{x:-3,y:2},{x:-2,y:0},{x:-1,y:4},{x:0,y:2},{x:0,y:0},{x:2,y:4},{x:2,y:-1},{x:3,y:1},{x:4,y:-2}];for(t.fillStyle="#fff",n=0,o=r.length;n<o;n++){var a=r[n];t.beginPath(),t.arc(a.x,a.y,.75,0,2*Math.PI),t.fill()}t.beginPath(),t.moveTo(0,-4),t.lineTo(-3,-4),t.lineTo(0,-4),t.lineTo(-2,-3),t.lineTo(-1,-3),t.lineTo(0,-4),t.lineTo(0,-2),t.lineTo(0,-4),t.lineTo(1,-3),t.lineTo(2,-3),t.lineTo(0,-4),t.lineTo(3,-4),t.closePath(),t.strokeStyle="#00ff00",t.lineCap="round",t.lineJoin="round",t.stroke(),t.beginPath(),t.moveTo(0,-4),t.lineTo(0,-5),t.lineCap="round",t.strokeStyle="#fff",t.stroke(),t.restore()},Ut=function(t,e,i){t.save(),t.translate(e,i),t.beginPath(),t.moveTo(-2,-2),t.bezierCurveTo(-3,-2,-5,-1,-5,1),t.bezierCurveTo(-5,4,-3,6,0,6),t.bezierCurveTo(3,6,5,4,5,1),t.bezierCurveTo(5,-1,3,-2,2,-2),t.closePath(),t.fillStyle="#ffcc33",t.fill(),t.strokeStyle="#ffcc33",t.stroke(),t.beginPath(),t.moveTo(-1,-1),t.quadraticCurveTo(-1,-2,-2,-2),t.quadraticCurveTo(-1,-2,-1,-4),t.quadraticCurveTo(-1,-2,0,-2),t.quadraticCurveTo(-1,-2,-1,-1),t.strokeStyle="#ff9900",t.lineJoin="round",t.stroke(),t.beginPath(),t.moveTo(-.5,-4),t.quadraticCurveTo(0,-5,1,-5),t.bezierCurveTo(2,-5,3,-4,4,-4),t.bezierCurveTo(3,-4,3,-3,2,-3),t.bezierCurveTo(1,-3,1,-4,-.5,-4),t.strokeStyle="#00ff00",t.lineCap="round",t.lineJoin="round",t.stroke(),t.fillStyle="#00ff00",t.fill(),t.restore()},Vt=function(t,e,i){t.save(),t.translate(e,i),t.beginPath(),t.moveTo(-2,-3),t.bezierCurveTo(-2,-4,-3,-4,-4,-4),t.bezierCurveTo(-5,-4,-6,-3,-6,0),t.bezierCurveTo(-6,3,-4,6,-2.5,6),t.quadraticCurveTo(-1,6,-1,5),t.bezierCurveTo(-1,6,0,6,1,6),t.bezierCurveTo(3,6,5,3,5,0),t.bezierCurveTo(5,-3,3,-4,2,-4),t.quadraticCurveTo(0,-4,0,-3),t.closePath(),t.fillStyle="#ff0000",t.fill(),t.beginPath(),t.moveTo(-1,-3),t.quadraticCurveTo(-1,-5,0,-5),t.lineCap="round",t.strokeStyle="#ff9900",t.stroke(),t.beginPath(),t.moveTo(2,3),t.quadraticCurveTo(3,3,3,1),t.lineCap="round",t.strokeStyle="#fff",t.stroke(),t.restore()},Kt=function(t,e,i){t.save(),t.translate(e,i),t.beginPath(),t.arc(0,2,5.5,0,2*Math.PI),t.fillStyle="#7bf331",t.fill(),t.beginPath(),t.moveTo(0,-4),t.lineTo(0,-5),t.moveTo(2,-5),t.quadraticCurveTo(-3,-5,-3,-6),t.strokeStyle="#69b4af",t.lineCap="round",t.stroke();var n=[0,-2,-1,-1,-2,0,-3,1,-4,2,-3,3,-2,4,-1,5,-2,6,-3,-1,1,7,2,6,3,5,2,4,1,3,0,2,1,1,2,0,3,-1,3,1,4,2];for(t.fillStyle="#69b4af",o=0,r=n.length;o<r;o+=2){e=n[o],i=n[o+1];t.beginPath(),t.arc(e,i,.65,0,2*Math.PI),t.fill()}var o,r;n=[{x:0,y:-3},{x:-2,y:-1},{x:-4,y:1},{x:-3,y:3},{x:1,y:0},{x:-1,y:2},{x:-1,y:4},{x:3,y:2},{x:1,y:4}];for(t.fillStyle="#fff",o=0,r=n.length;o<r;o++){var a=n[o];t.beginPath(),t.arc(a.x,a.y,.65,0,2*Math.PI),t.fill()}t.restore()},Qt=function(t,e,i){t.save(),t.translate(e,i),t.beginPath(),t.moveTo(-4,-2),t.lineTo(4,-2),t.lineTo(4,-1),t.lineTo(2,1),t.lineTo(1,0),t.lineTo(0,0),t.lineTo(0,5),t.lineTo(0,0),t.lineTo(-1,0),t.lineTo(-2,1),t.lineTo(-4,-1),t.closePath(),t.lineJoin="round",t.strokeStyle=t.fillStyle="#fffa36",t.fill(),t.stroke(),t.beginPath(),t.moveTo(0,-5),t.lineTo(-3,-2),t.lineTo(-2,-2),t.lineTo(-1,-3),t.lineTo(0,-3),t.lineTo(0,-1),t.lineTo(0,-3),t.lineTo(1,-3),t.lineTo(2,-2),t.lineTo(3,-2),t.closePath(),t.lineJoin="round",t.strokeStyle=t.fillStyle="#f00",t.fill(),t.stroke(),t.beginPath(),t.moveTo(-5,-4),t.lineTo(-5,-1),t.lineTo(-2,2),t.moveTo(5,-4),t.lineTo(5,-1),t.lineTo(2,2),t.strokeStyle="#00f",t.lineJoin="round",t.stroke(),t.restore()},Xt=function(t,e,i){t.save(),t.translate(e,i),t.beginPath(),t.moveTo(-1,-5),t.bezierCurveTo(-4,-5,-6,1,-6,6),t.lineTo(5,6),t.bezierCurveTo(5,1,3,-5,0,-5),t.closePath(),t.fillStyle=t.strokeStyle="#fffa37",t.stroke(),t.fill(),t.beginPath(),t.moveTo(-4,4),t.lineTo(-4,3),t.moveTo(-3,1),t.quadraticCurveTo(-3,-2,-2,-2),t.moveTo(-1,-4),t.lineTo(0,-4),t.lineCap="round",t.strokeStyle="#000",t.stroke(),t.beginPath(),t.rect(-5.5,6,10,2),t.fillStyle="#68b9fc",t.fill(),t.beginPath(),t.rect(-.5,6,2,2),t.fillStyle="#fff",t.fill(),t.restore()},Zt=function(t,e,i){t.save(),t.translate(e,i),t.beginPath(),t.moveTo(-1,-2),t.lineTo(-1,5),t.moveTo(0,6),t.quadraticCurveTo(1,6,1,3),t.moveTo(1,4),t.lineTo(2,4),t.moveTo(1,1),t.lineTo(1,-2),t.moveTo(1,0),t.lineTo(2,0),t.lineCap="round",t.strokeStyle="#fff",t.stroke(),t.beginPath(),t.moveTo(0,-6),t.quadraticCurveTo(-3,-6,-3,-4),t.lineTo(-3,-2),t.lineTo(3,-2),t.lineTo(3,-4),t.quadraticCurveTo(3,-6,0,-6),t.strokeStyle=t.fillStyle="#68b9fc",t.fill(),t.lineJoin="round",t.stroke(),t.beginPath(),t.moveTo(1,-5),t.lineTo(-1,-5),t.lineCap="round",t.strokeStyle="#000",t.stroke(),t.restore()},jt=function(t,e,i){t.save(),t.translate(e,i),t.beginPath(),t.moveTo(-2,-5),t.quadraticCurveTo(-4,-6,-6,-4),t.quadraticCurveTo(-7,-2,-5,1),t.quadraticCurveTo(-3,4,0,5),t.quadraticCurveTo(5,5,5,-1),t.quadraticCurveTo(6,-5,3,-5),t.quadraticCurveTo(1,-5,0,-2),t.quadraticCurveTo(-2,3,-5,5),t.moveTo(1,1),t.quadraticCurveTo(3,4,4,6),t.lineWidth=2,t.lineCap="round",t.strokeStyle="#ffcc33",t.stroke();var n,o,r=[-5,-6,1,-6,4,-4,-5,0,-2,0,6,1,-4,6,5,5];for(t.fillStyle="#fff",n=0,o=r.length;n<o;n+=2){e=r[n],i=r[n+1];t.beginPath(),t.arc(e,i,.65,0,2*Math.PI),t.fill()}t.restore()},$t=function(t,e,i){t.save(),t.translate(e,i),t.beginPath(),t.moveTo(0,-4),t.bezierCurveTo(-1,-4,-2,-3,-2,-1),t.bezierCurveTo(-2,1,-4,2,-4,4),t.bezierCurveTo(-4,6,-2,7,0,7),t.bezierCurveTo(2,7,4,6,4,4),t.bezierCurveTo(4,2,2,1,2,-1),t.bezierCurveTo(2,-3,1,-4,0,-4),t.fillStyle=t.strokeStyle="#00ff00",t.stroke(),t.fill(),t.beginPath(),t.moveTo(-2,3),t.quadraticCurveTo(-2,5,-1,5),t.strokeStyle="#0033ff",t.lineCap="round",t.stroke(),t.beginPath(),t.moveTo(0,-4),t.quadraticCurveTo(0,-6,2,-6),t.strokeStyle="#fff",t.lineCap="round",t.stroke(),t.restore()},te=function(t,e,i){t.save(),t.translate(e,i),t.beginPath(),t.moveTo(-5,5),t.quadraticCurveTo(-4,5,-2,6),t.bezierCurveTo(2,6,6,2,6,-4),t.lineTo(3,-3),t.lineTo(3,-2),t.lineTo(-4,5),t.closePath(),t.fillStyle=t.strokeStyle="#ffff00",t.stroke(),t.fill(),t.beginPath(),t.moveTo(4,-5),t.lineTo(5,-6),t.strokeStyle="#ffff00",t.lineCap="round",t.stroke(),t.beginPath(),t.moveTo(3,-1),t.lineTo(-2,4),t.strokeStyle="#000",t.lineCap="round",t.stroke(),t.beginPath(),t.moveTo(2,3),t.lineTo(0,5),t.strokeStyle="#fff",t.lineCap="round",t.stroke(),t.restore()},ee=function(t,e,i){t.save(),t.translate(e,i),t.beginPath(),t.arc(0,0,6,0,2*Math.PI),t.fillStyle="#f9bd6d",t.fill();var n,o,r=[0,-3,-4,-1,0,2,3,0,3,3];for(t.fillStyle="#000",n=0,o=r.length;n<o;n+=2){e=r[n],i=r[n+1];t.beginPath(),t.arc(e,i,.75,0,2*Math.PI),t.fill()}t.restore()},ie=function(t,e,i){t.save(),t.translate(e,i),t.beginPath(),t.arc(0,0,6,0,2*Math.PI),t.fillStyle="#000",t.lineWidth=1,t.strokeStyle="#f9bd6d",t.fill(),t.stroke();var n,o,r=[0,-3,-4,-1,0,2,3,0,3,3];for(t.fillStyle="#f9bd6d",n=0,o=r.length;n<o;n+=2){e=r[n],i=r[n+1];t.beginPath(),t.arc(e,i,.75,0,2*Math.PI),t.fill()}t.restore()},ne=function(t){return{cherry:Yt,strawberry:Jt,orange:Ut,apple:Vt,melon:Kt,galaxian:Qt,bell:Xt,key:Zt,pretzel:jt,pear:$t,banana:te,cookie:ee}[t]},oe=function(t,e,i,n){t.save(),t.fillStyle=n,t.translate(e,i);var o=function(e){t.beginPath(),t.moveTo(e,3),t.lineTo(e-6,0),t.lineTo(e,-3),t.closePath(),t.fill()};o(0),o(6),t.restore()},re=function(t,e,i,n){t.save(),t.translate(e,i),t.beginPath(),t.moveTo(-7,3),t.lineTo(-5,3),t.bezierCurveTo(-6,0,-5,-3,-2,-3),t.bezierCurveTo(0,-3,2,-2,2,2),t.bezierCurveTo(3,-1,3,-2,5,-2),t.bezierCurveTo(6,-2,6,0,5,0),t.bezierCurveTo(4,1,4,3,2,3),t.closePath(),t.lineWidth=1,t.lineCap=t.lineJoin="round",t.fillStyle=t.strokeStyle=n,t.fill(),t.stroke(),t.beginPath(),t.moveTo(4,-2),t.lineTo(3,-5),t.moveTo(5,-1),t.lineTo(7,-5),t.stroke(),t.beginPath(),t.arc(3,-5,1,0,2*Math.PI),t.fill(),t.beginPath(),t.arc(7,-5,1,0,2*Math.PI),t.fill(),t.beginPath(),t.moveTo(-4,1),t.bezierCurveTo(-5,-1,-3,-3,-1,-2),t.bezierCurveTo(0,-1,0,0,-1,1),t.bezierCurveTo(-2,1,-3,0,-2,-.5),t.lineWidth=.5,t.strokeStyle="#000",t.stroke(),t.restore()},ae=function(t,e,i){t.save(),t.translate(e,i),t.fillStyle="#ffb8ff",t.beginPath(),t.moveTo(0,-3),t.bezierCurveTo(-1,-4,-2,-6,-3.5,-6),t.quadraticCurveTo(-7,-6,-7,-.5),t.bezierCurveTo(-7,2,-2,5,0,7),t.bezierCurveTo(2,5,7,2,7,-.5),t.quadraticCurveTo(7,-6,3.5,-6),t.bezierCurveTo(2,-6,1,-4,0,-3),t.closePath(),t.fill(),t.restore()},se=function(t,e,i){t.save(),t.translate(e,i),t.lineWidth=.5,t.strokeStyle=t.fillStyle="#ff0",t.beginPath(),t.moveTo(-1,1),t.bezierCurveTo(-1,0,-1,-3,0,-3),t.lineTo(2,-3),t.bezierCurveTo(2,-2,0,0,-1,1),t.fill(),t.stroke(),t.beginPath(),t.arc(-2,3,.5,0,2*Math.PI),t.fill(),t.stroke(),t.restore()},le=function(){this.dir={},this.pixel={},this.tile={},this.tilePixel={},this.distToMid={},this.targetTile={},this.frames=0,this.steps=0,this.isDrawTarget=!1,this.isDrawPath=!1,this.savedSteps={},this.savedFrames={},this.savedDirEnum={},this.savedPixel={},this.savedTargetting={},this.savedTargetTile={}};le.prototype.save=function(t){this.savedSteps[t]=this.steps,this.savedFrames[t]=this.frames,this.savedDirEnum[t]=this.dirEnum,this.savedPixel[t]={x:this.pixel.x,y:this.pixel.y},this.savedTargetting[t]=this.targetting,this.savedTargetTile[t]={x:this.targetTile.x,y:this.targetTile.y}},le.prototype.load=function(t){this.steps=this.savedSteps[t],this.frames=this.savedFrames[t],this.setDir(this.savedDirEnum[t]),this.setPos(this.savedPixel[t].x,this.savedPixel[t].y),this.targetting=this.savedTargetting[t],this.targetTile.x=this.savedTargetTile[t].x,this.targetTile.y=this.savedTargetTile[t].y},le.prototype.reset=function(){this.setDir(this.startDirEnum),this.setPos(this.startPixel.x,this.startPixel.y),this.frames=0,this.steps=0,this.targetting=!1},le.prototype.setPos=function(t,e){this.pixel.x=t,this.pixel.y=e,this.commitPos()},le.prototype.getTilePixel=function(t,e){return null==t&&(t=this.pixel),null==e&&(e={}),e.x=t.x%8,e.y=t.y%8,e.x<0&&(e.x+=8),e.y<0&&(e.y+=8),e},le.prototype.commitPos=function(){on&&on.teleport(this),this.tile.x=Math.floor(this.pixel.x/8),this.tile.y=Math.floor(this.pixel.y/8),this.getTilePixel(this.pixel,this.tilePixel),this.distToMid.x=W-this.tilePixel.x,this.distToMid.y=Y-this.tilePixel.y},le.prototype.setDir=function(t){O(this.dir,t),this.dirEnum=t};le.prototype.getStepSizeFromTable=function(t,e){var i;if(!(t<1))return 1==t?i=0:t>=2&&t<=4?i=1:t>=5&&t<=20?i=2:t>=21&&(i=3),"1111111111111111011111111111111111112111111121110110110101101101010101010101010111111111111111111111111121111111111121111111211111111111211111111111211112111121011011011011011101101010110101011111211111112111111121111211112111211121112111211111211112111121112111211121112101110111011101110110110101101101112111211121112111211211211211211111211111112111111121111211112100000000000000000000000000000000011011010110110111211121112111211121121121121121"[7*i*16+16*e+this.frames%16]},le.prototype.update=function(t){t>=this.getNumSteps()||(this.steps+=this.step(),this.steer())};var ue,fe,ce=1,he=2,de=3,_e=function(){le.apply(this),this.randomScatter=!1,this.faceDirEnum=this.dirEnum};(_e.prototype=t(le.prototype)).getBounceY=(ue={0:[-4,-2,0,2,4,3,2,3],2:[3,5,7,5,4,5,7,8],1:[2,3,3,4,3,2,2,2],3:[2,2,3,4,3,3,2,2]},function(t,e,i){if(null==t&&(t=this.pixel.x),null==e&&(e=this.pixel.y),null==i&&(i=this.dirEnum),0!=this.mode||!this.scared||2!=h)return e;var n=this.getTilePixel({x:t,y:e}),o=8*Math.floor(e/8);return o+=0==i||2==i?ue[i][n.y]:ue[i][n.x]}),_e.prototype.getAnimFrame=function(t){return null==t&&(t=this.frames),Math.floor(t/8)%2},_e.prototype.reset=function(){this.sigReverse=!1,this.sigLeaveHome=!1,this.mode=this.startMode,this.scared=!1,e.ghostReset(),this.savedSigReverse={},this.savedSigLeaveHome={},this.savedMode={},this.savedScared={},this.savedElroy={},this.savedFaceDirEnum={},le.prototype.reset.apply(this),this.faceDirEnum=this.dirEnum},_e.prototype.save=function(t){this.savedSigReverse[t]=this.sigReverse,this.savedSigLeaveHome[t]=this.sigLeaveHome,this.savedMode[t]=this.mode,this.savedScared[t]=this.scared,this==ve&&(this.savedElroy[t]=this.elroy),this.savedFaceDirEnum[t]=this.faceDirEnum,le.prototype.save.call(this,t)},_e.prototype.load=function(t){this.sigReverse=this.savedSigReverse[t],this.sigLeaveHome=this.savedSigLeaveHome[t],this.mode=this.savedMode[t],this.scared=this.savedScared[t],this==ve&&(this.elroy=this.savedElroy[t]),this.faceDirEnum=this.savedFaceDirEnum[t],le.prototype.load.call(this,t)},_e.prototype.isSlowInTunnel=function(){return 1!=h&&3!=h&&2!=h||g<=3},_e.prototype.getNumSteps=function(){var t=1;return this.mode==he||this.mode==de?2:5==this.mode||4==this.mode?this.getStepSizeFromTable(1,4):(on.isTunnelTile(this.tile.x,this.tile.y)&&this.isSlowInTunnel()?t=4:this.scared?t=3:1==this.elroy?t=5:2==this.elroy&&(t=6),this.getStepSizeFromTable(g||1,t))},_e.prototype.reverse=function(){this.sigReverse=!0},_e.prototype.goHome=function(){e.silence(),e.eatingGhost.play(),this.mode=ce},_e.prototype.leaveHome=function(){this.playSounds(),this.sigLeaveHome=!0},_e.prototype.playSounds=function(){for(var t=0,i=0,n=0;n<4;n++)0==be[n].mode&&t++,be[n].mode==he&&i++;if(i>0)return e.ghostNormalMove.stopLoop(),void e.ghostReturnToHome.startLoop(!0);e.ghostReturnToHome.stopLoop(),t>0?this.scared||e.ghostNormalMove.startLoop(!0):e.ghostNormalMove.stopLoop()},_e.prototype.onEnergized=function(){this.reverse(),this.mode!=he&&this.mode!=de&&(this.scared=!0,this.targetting=void 0)},_e.prototype.onEaten=function(){this.goHome(),this.scared=!1},_e.prototype.step=function(){return this.setPos(this.pixel.x+this.dir.x,this.pixel.y+this.dir.y),1},_e.prototype.homeSteer=((fe={})[he]=function(){this.tile.x==on.doorTile.x&&this.tile.y==on.doorTile.y&&(this.faceDirEnum=2,this.targetting=!1,this.pixel.x==on.doorPixel.x?(this.mode=de,this.playSounds(),this.setDir(2),this.faceDirEnum=this.dirEnum):(this.setDir(3),this.faceDirEnum=this.dirEnum))},fe[de]=function(){this.pixel.y==on.homeBottomPixel&&(this.pixel.x==this.startPixel.x?(this.setDir(0),this.mode=this.arriveHomeMode):this.setDir(this.startPixel.x<this.pixel.x?1:3),this.faceDirEnum=this.dirEnum)},fe[4]=function(){this.sigLeaveHome?(this.sigLeaveHome=!1,this.mode=5,this.pixel.x==on.doorPixel.x?this.setDir(0):this.setDir(this.pixel.x<on.doorPixel.x?3:1)):this.pixel.y==on.homeTopPixel?this.setDir(2):this.pixel.y==on.homeBottomPixel&&this.setDir(0),this.faceDirEnum=this.dirEnum},fe[5]=function(){this.pixel.x==on.doorPixel.x&&(this.pixel.y==on.doorPixel.y?(this.mode=0,this.setDir(1)):this.setDir(0),this.faceDirEnum=this.dirEnum)},function(){var t=fe[this.mode];t&&t.apply(this)}),_e.prototype.isScatterBrain=function(){var t=!1;return We.getCommand()==qe&&(1==h||2==h?t=this==ve||this==xe:3==h&&(t=!0)),t},_e.prototype.steer=function(){var t,e,i,n=z(this.dirEnum);if(this.homeSteer(),n=z(this.dirEnum),0==this.mode||this.mode==he){if(0==this.distToMid.x&&0==this.distToMid.y)this.sigReverse&&(this.faceDirEnum=n,this.sigReverse=!1),this.setDir(this.faceDirEnum);else if(3==this.dirEnum&&this.tilePixel.x==W+1||1==this.dirEnum&&this.tilePixel.x==W-1||0==this.dirEnum&&this.tilePixel.y==Y-1||2==this.dirEnum&&this.tilePixel.y==Y+1){var o={x:this.tile.x+this.dir.x,y:this.tile.y+this.dir.y};if(e=H(o,this.dirEnum),this.scared){for(t=Math.floor(4*Math.random());!e[t];)t=(t+1)%4;this.targetting=!1}else{this.mode==he?(this.targetTile.x=on.doorTile.x,this.targetTile.y=on.doorTile.y):this.elroy||We.getCommand()!=qe?this.setTarget():(i=this.isScatterBrain()?we[Math.floor(4*Math.random())]:this,this.targetTile.x=i.cornerTile.x,this.targetTile.y=i.cornerTile.y,this.targetting="corner");var r=!1;if(this.mode==he&&on.getExitDir){var a=on.getExitDir(o.x,o.y);null!=a&&a!=n&&(r=!0,t=a)}r||(this.mode!=he&&on.constrainGhostTurns&&on.constrainGhostTurns(o,e,this.dirEnum),t=G(o,this.targetTile,e))}this.faceDirEnum=t}}else this.targetting=!1},_e.prototype.getPathDistLeft=function(t,e){var i=8,n=this.getTargetPixel();return"pacman"==this.targetting&&(i=0==e||2==e?Math.abs(t.y-n.y):Math.abs(t.x-n.x)),i},_e.prototype.setTarget=function(){this.targetTile=this.getTargetTile(),this!=ge&&(this.targetting="pacman")};var pe=function(){le.apply(this),1!=h&&2!=h||(this.frames=1),this.nextDir={},this.lastMeal={x:-1,y:-1},this.ai=!1,this.invincible=!1,this.savedNextDirEnum={},this.savedStopped={},this.savedEatPauseFramesLeft={}};(pe.prototype=t(le.prototype)).save=function(t){this.savedEatPauseFramesLeft[t]=this.eatPauseFramesLeft,this.savedNextDirEnum[t]=this.nextDirEnum,this.savedStopped[t]=this.stopped,le.prototype.save.call(this,t)},pe.prototype.load=function(t){this.eatPauseFramesLeft=this.savedEatPauseFramesLeft[t],this.setNextDir(this.savedNextDirEnum[t]),this.stopped=this.savedStopped[t],le.prototype.load.call(this,t)},pe.prototype.reset=function(){this.setNextDir(this.startDirEnum),this.stopped=!1,this.inputDirEnum=void 0,this.eatPauseFramesLeft=0,le.prototype.reset.apply(this)},pe.prototype.setNextDir=function(t){O(this.nextDir,t),this.nextDirEnum=t},pe.prototype.getNumSteps=function(){if(c)return 2;var t=Ue.isActive()?2:0;return this.getStepSizeFromTable(g,t)},pe.prototype.getStepFrame=function(t){return null==t&&(t=this.steps),Math.floor(t/2)%4},pe.prototype.getAnimFrame=function(t){return null==t&&(t=this.getStepFrame()),1!=h&&2!=h||(t=(t+1)%4,li==Ri&&(t=1)),3!=h&&3==t&&(t=1),t},pe.prototype.setInputDir=function(t){this.inputDirEnum=t},pe.prototype.clearInputDir=function(t){null!=t&&this.inputDirEnum!=t||(this.inputDirEnum=void 0)},pe.prototype.step=function(){if(!on)return this.setPos(this.pixel.x+this.dir.x,this.pixel.y+this.dir.y),1;var t,e=0!=this.dir.x?"x":"y",i=0!=this.dir.x?"y":"x";return this.stopped=this.stopped||0==this.distToMid[e]&&!q(this.tile,this.dir),this.stopped||(this.pixel[e]+=this.dir[e],this.pixel[i]+=(t=this.distToMid[i])<0?-1:t>0?1:0),this.commitPos(),this.stopped?0:1},pe.prototype.steer=function(){if(this.ai){if(0!=this.distToMid.x||0!=this.distToMid.y)return;var t=H(this.tile,this.dirEnum);this.setTarget(),this.setNextDir(G(this.tile,this.targetTile,t))}else this.targetting=void 0;if(null==this.inputDirEnum)this.stopped&&this.setDir(this.nextDirEnum);else{var i={};O(i,this.inputDirEnum),q(this.tile,i)?(this.setDir(this.inputDirEnum),this.setNextDir(this.inputDirEnum),this.stopped=!1):this.stopped||this.setNextDir(this.inputDirEnum)}this.stopped&&e.eating.stopLoop(!0)},pe.prototype.update=function(t){var i=this.getNumSteps();if(!(t>=i))if(this.eatPauseFramesLeft>0)t==i-1&&this.eatPauseFramesLeft--;else if(le.prototype.update.call(this,t),on){var n=on.getTile(this.tile.x,this.tile.y);"."!=n&&"o"!=n||(this.lastMeal.x=this.tile.x,this.lastMeal.y=this.tile.y,c||(this.eatPauseFramesLeft="."==n?1:3),e.eating.startLoop(!0),on.onDotEat(this.tile.x,this.tile.y),Ye.onDotEat(),oi.onDotEat(),k("."==n?10:50),"o"==n&&Ue.activate())," "!=n||this.lastMeal.x==this.tile.x&&this.lastMeal.y==this.tile.y||e.eating.stopLoop(!0)}};var ve=new _e;ve.name="blinky",ve.color="#FF0000",ve.pathColor="rgba(255,0,0,0.8)",ve.isVisible=!0;var xe=new _e;xe.name="pinky",xe.color="#FFB8FF",xe.pathColor="rgba(255,184,255,0.8)",xe.isVisible=!0;var me=new _e;me.name="inky",me.color="#00FFFF",me.pathColor="rgba(0,255,255,0.8)",me.isVisible=!0;var ge=new _e;ge.name="clyde",ge.color="#FFB851",ge.pathColor="rgba(255,184,81,0.8)",ge.isVisible=!0;var ye=new pe;ye.name="pacman",ye.color="#FFFF00",ye.pathColor="rgba(255,255,0,0.8)";var Te,we=[ve,xe,me,ge,ye],be=[ve,xe,me,ge],Se=16;Te=Y,ye.pathCenter={x:0,y:0},ve.pathCenter={x:-2,y:-2},xe.pathCenter={x:-1,y:-1},me.pathCenter={x:1,y:1},ge.pathCenter={x:2,y:2},ve.getTargetTile=function(){return{x:ye.tile.x,y:ye.tile.y}},ve.getTargetPixel=function(){return{x:ye.pixel.x,y:ye.pixel.y}},ve.drawTarget=function(t){this.targetting&&(t.fillStyle=this.color,"pacman"==this.targetting?at.drawCenterPixelSq(t,ye.pixel.x,ye.pixel.y,Te):at.drawCenterTileSq(t,this.targetTile.x,this.targetTile.y,Te))},xe.getTargetTile=function(){var t=ye.tile.x+4*ye.dir.x,e=ye.tile.y+4*ye.dir.y;return 0==ye.dirEnum&&(t-=4),{x:t,y:e}},xe.getTargetPixel=function(){var t=ye.pixel.x+4*ye.dir.x*8,e=ye.pixel.y+4*ye.dir.y*8;return 0==ye.dirEnum&&(t-=32),{x:t,y:e}},xe.drawTarget=function(t){if(this.targetting){t.fillStyle=this.color;var e=this.getTargetPixel();"pacman"==this.targetting?(t.beginPath(),t.moveTo(ye.pixel.x,ye.pixel.y),0==ye.dirEnum&&t.lineTo(ye.pixel.x,e.y),t.lineTo(e.x,e.y),t.stroke(),at.drawCenterPixelSq(t,e.x,e.y,Te)):at.drawCenterTileSq(t,this.targetTile.x,this.targetTile.y,Te)}},me.getTargetTile=function(){var t=ye.tile.x+2*ye.dir.x,e=ye.tile.y+2*ye.dir.y;return 0==ye.dirEnum&&(t-=2),{x:ve.tile.x+2*(t-ve.tile.x),y:ve.tile.y+2*(e-ve.tile.y)}},me.getJointPixel=function(){var t=ye.pixel.x+2*ye.dir.x*8,e=ye.pixel.y+2*ye.dir.y*8;return 0==ye.dirEnum&&(t-=16),{x:t,y:e}},me.getTargetPixel=function(){var t=ye.pixel.x+2*ye.dir.x*8,e=ye.pixel.y+2*ye.dir.y*8;return 0==ye.dirEnum&&(t-=16),{x:ve.pixel.x+2*(t-ve.pixel.x),y:ve.pixel.y+2*(e-ve.pixel.y)}},me.drawTarget=function(t){if(this.targetting){var e,i=this.getJointPixel();"pacman"==this.targetting?(e=this.getTargetPixel(),t.beginPath(),t.moveTo(ye.pixel.x,ye.pixel.y),0==ye.dirEnum&&t.lineTo(ye.pixel.x,i.y),t.lineTo(i.x,i.y),t.moveTo(ve.pixel.x,ve.pixel.y),t.lineTo(e.x,e.y),t.closePath(),t.stroke(),t.beginPath(),t.arc(i.x,i.y,2,0,2*Math.PI),t.fillStyle=t.strokeStyle,t.fill(),t.fillStyle=this.color,at.drawCenterPixelSq(t,e.x,e.y,Te)):(t.fillStyle=this.color,at.drawCenterTileSq(t,this.targetTile.x,this.targetTile.y,Te))}},ge.getTargetTile=function(){var t=ye.tile.x-(this.tile.x+this.dir.x),e=ye.tile.y-(this.tile.y+this.dir.y);return t*t+e*e>=64?(this.targetting="pacman",{x:ye.tile.x,y:ye.tile.y}):(this.targetting="corner",{x:this.cornerTile.x,y:this.cornerTile.y})},ge.getTargetPixel=function(){return{x:ye.pixel.x,y:ye.pixel.y}},ge.drawTarget=function(t){this.targetting&&(t.fillStyle=this.color,"pacman"==this.targetting?(t.beginPath(),t.arc(ye.pixel.x,ye.pixel.y,64,0,2*Math.PI),t.closePath(),t.stroke(),at.drawCenterPixelSq(t,ye.pixel.x,ye.pixel.y,Te)):(We.getCommand()==He&&(t.beginPath(),t.arc(ye.pixel.x,ye.pixel.y,64,0,2*Math.PI),t.strokeStyle="rgba(255,255,255,0.25)",t.stroke()),at.drawCenterTileSq(t,this.targetTile.x,this.targetTile.y,Te)))},ye.setTarget=function(){ve.mode==he||ve.scared?(this.targetTile.x=xe.tile.x,this.targetTile.y=xe.tile.y,this.targetting="pinky"):(this.targetTile.x=xe.tile.x+2*(ye.tile.x-xe.tile.x),this.targetTile.y=xe.tile.y+2*(ye.tile.y-xe.tile.y),this.targetting="flee")},ye.drawTarget=function(t){var e,i;this.ai&&(t.fillStyle=this.color,"flee"==this.targetting?(e=ye.pixel.x-xe.pixel.x,i=ye.pixel.y-xe.pixel.y,e=xe.pixel.x+2*e,i=xe.pixel.y+2*i,t.beginPath(),t.moveTo(xe.pixel.x,xe.pixel.y),t.lineTo(e,i),t.closePath(),t.stroke(),at.drawCenterPixelSq(t,e,i,Te)):at.drawCenterPixelSq(t,xe.pixel.x,xe.pixel.y,Te))},ye.getPathDistLeft=function(t,e){var i,n,o=8;return"pinky"==this.targetting?o=0==e||2==e?Math.abs(t.y-xe.pixel.y):Math.abs(t.x-xe.pixel.x):(i=ye.pixel.x-xe.pixel.x,n=ye.pixel.y-xe.pixel.y,i=xe.pixel.x+2*i,n=xe.pixel.y+2*n,o=0==e||2==e?Math.abs(n-t.y):Math.abs(i-t.x)),o};var Pe,Fe,Ce,Me,Ee,ke,De,Ae,Le,Ie,Re,Ne,Be,ze,Oe,Ge,He=0,qe=1,We=function(){var t,e,n,o,r=((e=[{},{},{}])[0][t=420]=He,e[0][t+=1200]=qe,e[0][t+=420]=He,e[0][t+=1200]=qe,e[0][t+=300]=He,e[0][t+=1200]=qe,e[0][t+=300]=He,e[1][t=420]=He,e[1][t+=1200]=qe,e[1][t+=420]=He,e[1][t+=1200]=qe,e[1][t+=300]=He,e[1][t+=61980]=qe,e[1][t+=1]=He,e[2][t=300]=He,e[2][t+=1200]=qe,e[2][t+=300]=He,e[2][t+=1200]=qe,e[2][t+=300]=He,e[2][t+=62220]=qe,e[2][t+=1]=He,function(t){var i=e[1==g?0:g>=2&&g<=4?1:2][t];return 0==h?i:t<=1620&&null!=i?He:void 0}),a={},s={};return{save:function(t){a[t]=n,s[t]=o},load:function(t){n=a[t],o=s[t]},reset:function(){o=qe,n=0},update:function(){var t;if(!Ue.isActive()){if(null!=(t=r(n)))for(o=t,i=0;i<4;i++)be[i].reverse();n++}},getCommand:function(){return o},setCommand:function(t){o=t}}}(),Ye=function(){var t,e,n={1:function(){return 0},2:function(){return 1==g?30:0},3:function(){return 1==g?60:2==g?50:0}},o={};o[1]=7,o[2]=17,o[3]=32;var r,a={},s={},l={},u={};return{save:function(i){l[i]=t,1==e?s[i]=r:0==e&&(u[i]={},u[i][1]=a[1],u[i][2]=a[2],u[i][3]=a[3])},load:function(i){t=l[i],1==e?r=s[i]:0==e&&(a[1]=u[i][1],a[2]=u[i][2],a[3]=u[i][3])},onNewLevel:function(){e=0,t=0,a[1]=0,a[2]=0,a[3]=0},onRestartLevel:function(){e=1,t=0,r=0},onDotEat:function(){var i;if(t=0,1==e)r++;else for(i=1;i<4;i++)if(4==be[i].mode){a[i]++;break}},update:function(){var s;if(0==e){for(i=1;i<4;i++)if(4==(s=be[i]).mode){if(a[i]>=n[i]())return void s.leaveHome();break}}else if(1==e){if(r==o[1]&&4==xe.mode)return void xe.leaveHome();if(r==o[2]&&4==me.mode)return void me.leaveHome();if(r==o[3]&&4==ge.mode)return r=0,e=0,void ge.leaveHome()}if(t>(g<5?240:180)){for(t=0,i=1;i<4;i++)if(4==(s=be[i]).mode){s.leaveHome();break}}else t++}}}(),Je=(Pe=[[20,30,40,40,40,50,50,50,60,60,60,70,70,70,100,100,100,100,120,120,120],[10,15,20,20,20,25,25,25,30,30,30,40,40,40,50,50,50,50,60,60,60]],Ce=function(t){var e=g;return e>21&&(e=21),244-Pe[t-1][e-1]},Me={},{onNewLevel:function(){Fe=!1},onRestartLevel:function(){Fe=!0},update:function(){Fe&&4!=ge.mode&&(Fe=!1),Fe?ve.elroy=0:on.dotsEaten>=Ce(2)?ve.elroy=2:on.dotsEaten>=Ce(1)?ve.elroy=1:ve.elroy=0},save:function(t){Me[t]=Fe},load:function(t){Fe=Me[t]}}),Ue=(Ee=[6,5,4,3,2,5,2,2,1,5,2,1,1,3,1,1,0,1],Re=function(){return g>18?0:60*Ee[g-1]},ke=[5,5,5,5,5,5,5,5,3,5,5,3,3,5,3,3,0,3],Ne=function(){return g>18?0:ke[g-1]},Be={},ze={},Oe={},Ge={},{save:function(t){Be[t]=De,ze[t]=Ae,Oe[t]=Le,Ge[t]=Ie},load:function(t){De=Be[t],Ae=ze[t],Le=Oe[t],Ie=Ge[t]},reset:function(){for(e.ghostTurnToBlue.stopLoop(),De=0,Ae=!1,Le=100,Ie=0,i=0;i<4;i++)be[i].scared=!1},update:function(){Ae&&(De==Re()?this.reset():De++)},activate:function(){for(e.ghostNormalMove.stopLoop(),e.ghostTurnToBlue.startLoop(),Ae=!0,De=0,Le=100,i=0;i<4;i++)be[i].onEnergized();0==Re()&&this.reset()},isActive:function(){return Ae},isFlash:function(){var t=Math.floor((Re()-De)/14);return t<=2*Ne()-1&&t%2==0},getPoints:function(){return Le},addPoints:function(){k(Le*=2),Ie=60},showingPoints:function(){return Ie>0},updatePointsTimer:function(){Ie>0&&Ie--}}),Ve=function(){this.pixel={x:0,y:0},this.fruitHistory={},this.scoreDuration=2,this.scoreFramesLeft,this.savedScoreFramesLeft={}},Ke=function(){Ve.call(this),this.fruits=[{name:"cherry",points:100},{name:"strawberry",points:300},{name:"orange",points:500},{name:"apple",points:700},{name:"melon",points:1e3},{name:"galaxian",points:2e3},{name:"bell",points:3e3},{name:"key",points:5e3}],this.order=[0,1,2,2,3,3,4,4,5,5,6,6,7],this.dotLimit1=70,this.dotLimit2=170,this.duration=9,this.framesLeft,this.savedFramesLeft={}};Ke.prototype=t(Ve.prototype={isScorePresent:function(){return this.scoreFramesLeft>0},onNewLevel:function(){this.buildFruitHistory()},setCurrentFruit:function(t){this.currentFruitIndex=t},onDotEat:function(){this.isPresent()||on.dotsEaten!=this.dotLimit1&&on.dotsEaten!=this.dotLimit2||this.initiate()},save:function(t){this.savedScoreFramesLeft[t]=this.scoreFramesLeft},load:function(t){this.scoreFramesLeft=this.savedScoreFramesLeft[t]},reset:function(){this.scoreFramesLeft=0},getCurrentFruit:function(){return this.fruits[this.currentFruitIndex]},getPoints:function(){return this.getCurrentFruit().points},update:function(){this.scoreFramesLeft>0&&this.scoreFramesLeft--},isCollide:function(){return Math.abs(ye.pixel.y-this.pixel.y)<=Y&&Math.abs(ye.pixel.x-this.pixel.x)<=W},testCollide:function(){this.isPresent()&&this.isCollide()&&(k(this.getPoints()),e.silence(!0),e.eatingFruit.play(),setTimeout(be[0].playSounds,500),this.reset(),this.scoreFramesLeft=60*this.scoreDuration)}},{onNewLevel:function(){this.setCurrentFruit(this.getFruitIndexFromLevel(g)),Ve.prototype.onNewLevel.call(this)},getFruitFromLevel:function(t){return this.fruits[this.getFruitIndexFromLevel(t)]},getFruitIndexFromLevel:function(t){return t>13&&(t=13),this.order[t-1]},buildFruitHistory:function(){var t;for(this.fruitHistory={},t=1;t<=g;t++)this.fruitHistory[t]=this.fruits[this.getFruitIndexFromLevel(t)]},initiate:function(){this.pixel.x=111,this.pixel.y=160+Y,this.framesLeft=60*this.duration},isPresent:function(){return this.framesLeft>0},reset:function(){Ve.prototype.reset.call(this),this.framesLeft=0},update:function(){Ve.prototype.update.call(this),this.framesLeft>0&&this.framesLeft--},save:function(t){Ve.prototype.save.call(this,t),this.savedFramesLeft[t]=this.framesLeft},load:function(t){Ve.prototype.load.call(this,t),this.framesLeft=this.savedFramesLeft[t]}});var Qe,Xe,Ze,je,$e,ti,ei,ii,ni,oi,ri=function(){Ve.call(this),this.fruits=[{name:"cherry",points:100},{name:"strawberry",points:200},{name:"orange",points:500},{name:"pretzel",points:700},{name:"apple",points:1e3},{name:"pear",points:2e3},{name:"banana",points:5e3}],this.dotLimit1=64,this.dotLimit2=176,this.pen_path="<<<<<<^^^^^^>>>>>>>>>vvvvvv<<",this.savedIsPresent={},this.savedPixel={},this.savedPathMode={},this.savedFrame={},this.savedNumFrames={},this.savedPath={}};ri.prototype=t(Ve.prototype,{shouldRandomizeFruit:function(){return g>7},getFruitFromLevel:function(t){return t<=7?this.fruits[t-1]:void 0},onNewLevel:function(){this.shouldRandomizeFruit()?this.setCurrentFruit(0):this.setCurrentFruit(g-1),Ve.prototype.onNewLevel.call(this)},buildFruitHistory:function(){var t;for(this.fruitHistory={},t=1;t<=Math.max(g,7);t++)this.fruitHistory[t]=this.fruits[t-1]},reset:function(){Ve.prototype.reset.call(this),this.frame=0,this.numFrames=0,this.path=void 0},initiatePath:function(t){this.frame=0,this.numFrames=16*t.length,this.path=t},initiate:function(){this.shouldRandomizeFruit()&&this.setCurrentFruit(u(0,6));var t=on.fruitPaths.entrances,e=t[u(0,t.length-1)];this.initiatePath(e.path),this.pathMode=0,this.pixel.x=e.start.x,this.pixel.y=e.start.y},isPresent:function(){return this.frame<this.numFrames},bounceFrames:(Qe={dx:0,dy:-1},Xe={dx:0,dy:1},Ze={dx:-1,dy:0},je={dx:1,dy:0},$e={dx:-1,dy:-1},ti={dx:1,dy:-1},ei={dx:-1,dy:1},ii={dx:1,dy:1},ni={dx:0,dy:0},{"^":[Qe,Qe,Qe,Qe,Qe,Qe,Qe,Qe,Qe,ni,Qe,ni,ni,Xe,ni,Xe],">":[ni,ti,ni,je,ni,ti,ni,je,ni,je,ni,je,ni,ii,ii,ni],"<":[ni,ni,$e,ni,Ze,ni,$e,ni,Ze,ni,Ze,ni,Ze,ni,ei,ei],v:[ni,Xe,Xe,Xe,Xe,Xe,Xe,Xe,Xe,Xe,Xe,Xe,Qe,Qe,ni,Qe]}),move:function(){var t=this.path[Math.floor(this.frame/16)],e=this.bounceFrames[t][this.frame%16];this.pixel.x+=e.dx,this.pixel.y+=e.dy,this.frame++},setNextPath:function(){if(0==this.pathMode)this.pathMode=1,this.initiatePath(this.pen_path);else if(1==this.pathMode){this.pathMode=2;var t=on.fruitPaths.exits,e=t[u(0,t.length-1)];this.initiatePath(e.path)}else 2==this.pathMode&&this.reset()},update:function(){Ve.prototype.update.call(this),this.isPresent()&&(this.move(),this.frame==this.numFrames&&this.setNextPath())},save:function(t){Ve.prototype.save.call(this,t),this.savedPixel[t]=this.isPresent()?{x:this.pixel.x,y:this.pixel.y}:void 0,this.savedPathMode[t]=this.pathMode,this.savedFrame[t]=this.frame,this.savedNumFrames[t]=this.numFrames,this.savedPath[t]=this.path},load:function(t){Ve.prototype.load.call(this,t),this.savedPixel[t]&&(this.pixel.x=this.savedPixel[t].x,this.pixel.y=this.savedPixel[t].y),this.pathMode=this.savedPathMode[t],this.frame=this.savedFrame[t],this.numFrames=this.savedNumFrames[t],this.path=this.savedPath[t]}});var ai,si,li,ui,fi,ci,hi,di,_i,pi,vi=(ai=new Ke,si=new ri,oi=ai,function(){oi=0==h?ai:si}),xi=function(){var t,e,i=1e3/60,n=!1,o=!1;!function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var n=(new Date).getTime(),o=Math.max(0,16-(n-t)),r=window.setTimeout(function(){e(n+o)},o);return t=n+o,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var r,a,s,l,u,f=(r=[],a=0,s=-1,l=!1,function(t){l&&(a=(a+1)%60),59==(s=(s+1)%60)&&(l=!0),r[s]=t;var i=(t-r[a])/1e3,n=s-a;n<0&&(n+=60),e=n/i}),c=function(e){null==t&&(t=e),f(e);for(t=Math.max(t,e-3*i),(n||At.isOpen())&&(t=e),xt.update();t<e;)li.update(),t+=i;at.beginFrame(),li.draw(),xt.isValidState()&&at.renderFunc(xt.draw),at.endFrame(),u=requestAnimationFrame(c)};return{getFramePeriod:function(){return i},setUpdatesPerSecond:function(t){i=1e3/t,Mn.onFramePeriodChange()},init:function(){var t=this;window.addEventListener("focus",function(){t.start()}),window.addEventListener("blur",function(){t.stop()}),this.start()},start:function(){o||(u=requestAnimationFrame(c),o=!0)},stop:function(){o&&(cancelAnimationFrame(u),o=!1)},togglePause:function(){n=!n},isPaused:function(){return n},getFps:function(){return e}}}(),mi=function(t,i,n,o){li=i?gi(li,t,i,n,o):t,e.silence(),li.init(),xi.isPaused()&&xi.togglePause()},gi=function(t,e,i,n,o){var r,a=Math.floor(i/2),s=function(){return r/i*2+(r<a?0:-1)},l=!1;return{init:function(){r=0,l=!0},draw:function(){if(l){var i=s();r<a?t&&(t.draw(),at.setOverlayColor("rgba(0,0,0,"+i+")")):r>a&&(e.draw(),at.setOverlayColor("rgba(0,0,0,"+(1-i)+")"))}},update:function(){r<a?n&&t.update():r==a?e.init():r<i?o&&e.update():(li=e,l=!1),r++}}},yi=(ui=function(t){mi(t),fi.disable()},fi=new wt("SELECT PACMAN GAME TO PLAY",16,0,194,24,8,"8px ArcadeR","#EEE"),ci=function(t){return t=Math.floor(t/3)+1,3==(t%=4)&&(t=1),t},fi.addTextIconButton(d(0),function(){h=0,ui(bi)},function(t,e,i,n){pt.drawPacmanSprite(t,e,i,3,ci(n))}),fi.addTextIconButton(d(1),function(){h=1,ui(bi)},function(t,e,i,n){pt.drawMsPacmanSprite(t,e,i,3,ci(n))}),fi.addTextIconButton(d(2),function(){h=2,ui(bi)},function(t,e,i,n){Wt(t,e,i,3,ci(n),!0)}),fi.addSpacer(.5),fi.addTextIconButton("LEARN",function(){ui(Ti)},function(t,e,i,n){pt.drawGhostSprite(t,e,i,Math.floor(n/8)%2,3,!1,!1,!1,ve.color)}),{init:function(){fi.enable(),e.coffeeBreakMusic.startLoop()},draw:function(){at.clearMapFrame(),at.beginMapClip(),at.renderFunc(fi.draw,fi),at.endMapClip()},update:function(){fi.update()},getMenu:function(){return fi}}),Ti=function(){var t=new wt("LEARN",16,-8,194,24,8,"8px ArcadeR","#EEE");t.addSpacer(7),t.addTextButton("BACK",function(){mi(yi),t.disable(),u(function(t){t.disable()}),_(!0),a()}),t.backButton=t.buttons[t.buttonCount-1],t.noArrowKeys=!0;var e=30,n=41,o=new yt(n,32,e,30,function(){_(!1),ve.isVisible=!0,d(ve,!0)});o.setIcon(function(t,e,i,n){v()(t,e,i,Math.floor(n/6)%2,2,void 0,void 0,void 0,ve.color)});var r=new yt(n+=38,32,e,30,function(){_(!1),d(xe,!0)});r.setIcon(function(t,e,i,n){v()(t,e,i,Math.floor(n/6)%2,2,void 0,void 0,void 0,xe.color)});var s=new yt(n+=38,32,e,30,function(){_(!1),d(me,!0)});s.setIcon(function(t,e,i,n){v()(t,e,i,Math.floor(n/6)%2,2,void 0,void 0,void 0,me.color)});var l=new yt(n+=38,32,e,30,function(){_(!1),d(ge,!0)});l.setIcon(function(t,e,i,n){v()(t,e,i,Math.floor(n/6)%2,2,void 0,void 0,void 0,ge.color)});var u=function(t){t(o),t(r),t(s),t(l)},d=function(t,e){t.isVisible=t.isDrawTarget=t.isDrawPath=e},_=function(t){d(ve,t),d(xe,t),d(me,t),d(ge,t)};return{init:function(){for(t.enable(),u(function(t){t.enable()}),on=dn,at.drawMap(),g=1,f=!1,c=!1,h=0,We.reset(),Ue.reset(),We.setCommand(He),Ye.onNewLevel(),Je.onNewLevel(),i=0;i<4;i++){var e=we[i];e.reset(),e.mode=0}ve.setPos(111,104+Y),xe.setPos(120+W,104+Y),me.setPos(72+W,128+Y),ge.setPos(144+W,128+Y),ye.reset(),ye.setPos(111,176+Y),o.onclick()},draw:function(){at.blitMap(),at.renderFunc(t.draw,t),u(function(t){at.renderFunc(t.draw,t)}),at.beginMapClip(),at.drawPaths(),at.drawActors(),at.drawTargets(),at.endMapClip()},update:function(){var e,i;for(t.update(),u(function(t){t.update()}),i=0;i<2;i++)for(ye.update(i),e=0;e<4;e++)we[e].update(i);for(e=0;e<5;e++)we[e].frames++},getMenu:function(){return t}}}(),wi=function(){var t,e,i=function(){r.isSelected?(t=d(),e=2==h?"#47b8ff":ye.color):a.isSelected?(t=p()[0],e=ve.color):s.isSelected?(t=p()[1],e=xe.color):l.isSelected?(t=p()[2],e=me.color):u.isSelected?(t=p()[3],e=ge.color):(t=d(),e="#FFF")},n=20,o=53,r=new yt(o,24,n,30,function(){1==h?h=3:3==h&&(h=1)});r.setIcon(function(t,e,i,n){x()(t,e,i,3,ye.getAnimFrame(ye.getStepFrame(Math.floor((0==h?n+4:n)/1.5))),!0)});var a=new yt(o+=40,24,n,30);a.setIcon(function(t,e,i,n){v()(t,e,i,Math.floor(n/6)%2,1,void 0,void 0,void 0,ve.color)});var s=new yt(o+=n,24,n,30);s.setIcon(function(t,e,i,n){v()(t,e,i,Math.floor(n/6)%2,1,void 0,void 0,void 0,xe.color)});var l=new yt(o+=n,24,n,30);l.setIcon(function(t,e,i,n){v()(t,e,i,Math.floor(n/6)%2,1,void 0,void 0,void 0,me.color)});var u=new yt(o+=n,24,n,30);u.setIcon(function(t,e,i,n){v()(t,e,i,Math.floor(n/6)%2,1,void 0,void 0,void 0,ge.color)});var f=function(t){t(r),t(a),t(s),t(l),t(u)};return f(function(t){t.borderBlurColor=t.borderFocusColor="#000"}),{init:function(){i(),f(function(t){t.enable()})},shutdown:function(){f(function(t){t.disable()})},draw:function(){f(function(t){at.renderFunc(t.draw,t)}),i(),at.renderFunc(function(i){i.font="8px ArcadeR",i.fillStyle=e,i.textAlign="center",i.textBaseline="top",i.fillText(t,113,8)})},update:function(){f(function(t){t.update()})},getYellowBtn:function(){return r}}}(),bi=function(){var t=function(t,e){wi.shutdown(),i.disable(),mi(t,e)},i=new wt("",16,0,194,24,8,"8px ArcadeR","#EEE");return i.addSpacer(2),i.addTextButton("PLAY",function(){f=!1,c=!1,Mi.setStartLevel(1),t(Mi,60)}),i.addTextButton("PLAY TURBO",function(){f=!1,c=!0,Mi.setStartLevel(1),t(Mi,60)}),i.addTextButton("PRACTICE",function(){f=!0,c=!1,t(Si)}),i.addSpacer(.5),i.addTextButton("CUTSCENES",function(){t(Ci)}),i.addTextButton("ABOUT",function(){t(Fi)}),i.addSpacer(.5),i.addTextButton("BACK",function(){t(yi)}),i.backButton=i.buttons[i.buttonCount-1],{init:function(){e.startMusic.play(),i.enable(),wi.init(),on=void 0},draw:function(){at.clearMapFrame(),at.renderFunc(i.draw,i),wi.draw()},update:function(){wi.update()},getMenu:function(){return i}}}(),Si=function(){var t,e=1,i=function(e,i){wi.shutdown(),t.disable(),mi(e,i)},n=function(t){Pi.setAct(t),i(Pi)},o=function(t){Si.setStartAct(t),i(Si)},r=function(t,e,i,n){t.save(),t.translate(e,i),t.scale(1,n),t.beginPath(),t.moveTo(0,-4),t.lineTo(8,4),t.lineTo(-8,4),t.closePath(),t.fillStyle="#FFF",t.fill(),t.restore()};return{init:function(){!function(a){var s,l;for(e=a,(t=new wt("",16,0,194,24,8,"8px ArcadeR","#EEE")).addSpacer(2),t.addIconButton(function(t,e,i){r(t,e,i,1)},function(){o(Math.max(1,a-4))}),s=0;s<4;s++)l=xn(a+s),t.addTextIconButton("LEVELS "+l[0]+"-"+l[1],function(t){return function(){n(a+t)}}(s),function(t){return function(e,i,n){var o=8/3*2,r=8/6;e.save(),e.translate(i,n),e.beginPath(),e.moveTo(-o,0),e.lineTo(-o,-r),e.quadraticCurveTo(-o,-o,-r,-o),e.lineTo(r,-o),e.quadraticCurveTo(o,-o,o,-r),e.lineTo(o,r),e.quadraticCurveTo(o,o,r,o),e.lineTo(-r,o),e.quadraticCurveTo(-o,o,-o,r),e.closePath();var s=vn(a+t);e.fillStyle=s.wallFillColor,e.strokeStyle=s.wallStrokeColor,e.fill(),e.stroke(),e.restore()}}(s));t.addIconButton(function(t,e,i){r(t,e,i,-1)},function(){o(a+4)}),t.addTextButton("BACK",function(){i(bi)}),t.backButton=t.buttons[t.buttonCount-1],t.enable()}(e),wi.init()},setStartAct:function(t){e=t},draw:function(){at.clearMapFrame(),at.renderFunc(t.draw,t),wi.draw()},update:function(){wi.update()},getMenu:function(){return t}}}(),Pi=function(){var t,e=1,i=function(e,i){wi.shutdown(),t.disable(),mi(e,i)};return{init:function(){vi(),function(e){var n,o=xn(e);if((t=new wt("",16,0,194,24,8,"8px ArcadeR","#EEE")).addSpacer(2),o[0]<o[1])for(n=o[0];n<=o[1];n++)t.addTextIconButton("LEVEL "+n,function(t){return function(){var e;e=t,Mi.setStartLevel(e),i(Mi,60)}}(n),function(t){return function(e,i,n){var o=oi.getFruitFromLevel(t);o&&pt.drawFruitSprite(e,i,n,o.name)}}(n));t.addSpacer(.5),t.addTextButton("BACK",function(){i(Si)}),t.backButton=t.buttons[t.buttonCount-1],t.enable()}(e),wi.init()},setAct:function(t){e=t},draw:function(){at.clearMapFrame(),at.renderFunc(t.draw,t),wi.draw()},update:function(){wi.update()},getMenu:function(){return t}}}(),Fi=function(){var t,e,i=new wt("",16,0,194,24,8,"8px ArcadeR","#EEE");i.addSpacer(8),i.addTextButton("BACK",function(){var t,e;t=bi,wi.shutdown(),i.disable(),mi(t,e)}),i.backButton=i.buttons[i.buttonCount-1];var n=function(i){i.font="8px ArcadeR",i.fillStyle="#FFF",i.textBaseline="top",i.textAlign="center";var n;for(n=0;n<e;n++)i.fillText(t[n],112,96+2*n*8)};return{init:function(){i.enable(),wi.init()},draw:function(){at.clearMapFrame(),at.renderFunc(i.draw,i),wi.draw(),t=_(),e=t.length,at.renderFunc(n)},update:function(){wi.update()},getMenu:function(){return i}}}(),Ci=function(){var t=function(t){t&&(wi.shutdown(),e.disable(),rn(t,Ci))},e=new wt("",16,0,194,24,8,"8px ArcadeR","#EEE");return e.addSpacer(2),e.addTextButton("CUTSCENE 1",function(){t(cn[h][0])}),e.addTextButton("CUTSCENE 2",function(){t(cn[h][1])}),e.addTextButton("CUTSCENE 3",function(){t(cn[h][2])}),e.addSpacer(),e.addTextButton("BACK",function(){var t,i;t=bi,wi.shutdown(),e.disable(),mi(t,i)}),e.backButton=e.buttons[e.buttonCount-1],{init:function(){e.enable(),wi.init(),g=0},draw:function(){at.clearMapFrame(),at.renderFunc(e.draw,e),wi.draw()},update:function(){wi.update()},getMenu:function(){return e}}}(),Mi=(function(){var t=new wt("",16,242,194,24,8,"8px ArcadeR","#EEE");t.addTextButton("BACK",function(){mi(yi),t.disable()}),t.backButton=t.buttons[t.buttonCount-1];var e,i=0,n={};!function(){for(var t=0,i=-12,o=-8,r=function(e,i){n[t++]={x:e,y:i}};o<224;o+=3)r(i,o);for(;i<132;i+=3)r(i,o);for(;o>-8;o-=3)r(i,o);for(;i>-12;i-=3)r(i,o);e=t}();var o=function(t){t.fillStyle="#555";var o,r;for(o=0;o<e;o++)r=n[o],t.fillRect(r.x,r.y,2,2);for(t.fillStyle="#FFF",o=0;o<63;o++)r=n[(4*o+Math.floor(i/2))%e],t.fillRect(r.x,r.y,2,2);t.font="8px ArcadeR",t.textBaseline="top",t.textAlign="right";var a,s;a=72,s=0,t.fillStyle="#FFF",t.fillText("HIGH SCORES",104,s),s+=32;var l=function(e,i){var n;for(t.lineWidth=1,t.lineCap="round",t.strokeStyle="rgba(255,255,255,0.5)",t.save(),t.translate(-2.5,0),n=-4;n<=4;n+=2)t.beginPath(),t.moveTo(e+8,i+n),t.lineTo(e+8*(.5*Math.random()+1.5),i+n),t.stroke();t.restore()};t.fillStyle="#AAA",t.fillText(M[0],a,s),pt.drawPacmanSprite(t,88,s+4,1,1),s+=16,t.fillStyle="#AAA",t.fillText(M[1],a,s),l(88,s+4),pt.drawPacmanSprite(t,88,s+4,1,1),s+=24,t.fillStyle="#AAA",t.fillText(M[2],a,s),pt.drawMsPacmanSprite(t,88,s+4,1,1),s+=16,t.fillStyle="#AAA",t.fillText(M[3],a,s),l(88,s+4),pt.drawMsPacmanSprite(t,88,s+4,1,1),s+=24,t.fillStyle="#AAA",t.fillText(M[6],a,s),pt.drawOttoSprite(t,88,s+4,1,0),s+=16,t.fillStyle="#AAA",t.fillText(M[7],a,s),l(88,s+4),pt.drawOttoSprite(t,88,s+4,1,0),s+=24,t.fillStyle="#AAA",t.fillText(M[4],a,s),pt.drawCookiemanSprite(t,88,s+4,1,1),s+=16,t.fillStyle="#AAA",t.fillText(M[5],a,s),l(88,s+4),pt.drawCookiemanSprite(t,88,s+4,1,1)},r=function(t){t.globalAlpha=.5,t.font="8px sans-serif",t.textBaseline="middle",t.textAlign="left";var e=160,i=0;t.fillStyle="#ffb8ae",t.fillRect(e-1,i-1.5,2,2),t.fillStyle="#FFF",t.fillText("10",e+8,i),i+=12,t.fillStyle="#ffb8ae",t.beginPath(),t.arc(e,i-.5,4,0,2*Math.PI),t.fill(),t.fillStyle="#FFF",t.fillText("50",e+8,i),i+=24,pt.drawGhostSprite(t,e,i,0,3,!0),pt.drawGhostPoints(t,e+16,i,200);var n=t.globalAlpha;i+=16,t.globalAlpha=.5*n,pt.drawGhostSprite(t,e,i,0,3,!0),t.globalAlpha=n,pt.drawGhostSprite(t,e+16,i,0,3,!0),pt.drawGhostPoints(t,e+32,i,400),i+=16,t.globalAlpha=.5*n,pt.drawGhostSprite(t,e,i,0,3,!0),pt.drawGhostSprite(t,e+16,i,0,3,!0),t.globalAlpha=n,pt.drawGhostSprite(t,e+32,i,0,3,!0),pt.drawGhostPoints(t,e+48,i,800),i+=16,t.globalAlpha=.5*n,pt.drawGhostSprite(t,e,i,0,3,!0),pt.drawGhostSprite(t,e+16,i,0,3,!0),pt.drawGhostSprite(t,e+32,i,0,3,!0),t.globalAlpha=n,pt.drawGhostSprite(t,e+48,i,0,3,!0),pt.drawGhostPoints(t,e+64,i,1600);var o,r,a=[{name:"cherry",points:100},{name:"strawberry",points:200},{name:"orange",points:500},{name:"pretzel",points:700},{name:"apple",points:1e3},{name:"pear",points:2e3},{name:"banana",points:5e3}],s=[{name:"cherry",points:100},{name:"strawberry",points:300},{name:"orange",points:500},{name:"apple",points:700},{name:"melon",points:1e3},{name:"galaxian",points:2e3},{name:"bell",points:3e3},{name:"key",points:5e3}];for(i+=24,o=0;o<s.length;o++)r=s[o],pt.drawFruitSprite(t,e,i,r.name),pt.drawPacFruitPoints(t,e+16,i,r.points),i+=16;for(e+=48,i=108,o=0;o<a.length;o++)r=a[o],pt.drawFruitSprite(t,e,i,r.name),pt.drawMsPacFruitPoints(t,e+16,i,r.points),i+=16;t.globalAlpha=1}}(),function(){var t=new wt("",16,202,194,24,8,"8px ArcadeR","#EEE");t.addTextButton("GO TO PROJECT PAGE",function(){window.open("https://github.com/shaunew/Pac-Man")}),t.addTextButton("BACK",function(){mi(yi),t.disable()}),t.backButton=t.buttons[t.buttonCount-1];var e=function(t){var e,i;t.font="8px ArcadeR",t.textBaseline="top",t.textAlign="left",e=16,i=0,t.fillStyle="#0FF",t.fillText("DEVELOPER",e,i),i+=16,t.fillStyle="#777",t.fillText("SHAUN WILLIAMS",e,i),i+=32,t.fillStyle="#0FF",t.fillText("REVERSE-ENGINEERS",e,i),i+=16,t.fillStyle="#777",t.fillText("JAMEY PITTMAN",e,i),i+=16,t.fillText("BART GRANTHAM",e,i),i+=32,t.fillStyle="#FF0",t.fillText("PAC-MAN",e,i),i+=16,t.fillStyle="#777",t.fillText("NAMCO",e,i),i+=32,t.fillStyle="#FF0",t.fillText("MS. PAC-MAN / CRAZY OTTO",e,i),i+=16,t.fillStyle="#777",t.fillText("GENERAL COMPUTING",e,i)}}(),di=1,{init:function(){a(),hi=0,g=di-1,T=f?1/0:3,A(0),vi(),ki.init()},setStartLevel:function(t){di=t},draw:function(){on&&(at.blitMap(),at.drawScore(),at.drawMessage("PLAYER ONE","#0FF",9,14),at.drawReadyMessage())},update:function(){0==hi?(T--,li=ki,at.drawMap()):hi++}}),Ei=function(){var t;return{init:function(){var i;for(e.startMusic.play(),i=0;i<5;i++)we[i].reset();We.reset(),oi.reset(),Ue.reset(),on.resetTimeEaten(),t=0,Mn.init()},draw:function(){on&&(at.blitMap(),at.drawScore(),at.drawActors(),at.drawReadyMessage())},update:function(){240==t?mi(Ai):t++}}}(),ki=t(Ei,{init:function(){g++,0==h?on=_n:1==h||3==h?Tn():2==h&&gn(),on.resetCurrent(),oi.onNewLevel(),at.drawMap(),Ye.onNewLevel(),Je.onNewLevel(),Ei.init.call(this)}}),Di=t(Ei,{init:function(){T--,Ye.onRestartLevel(),Je.onRestartLevel(),at.drawMap(),Ei.init.call(this)}}),Ai={init:function(){f&&Mn.reset()},draw:function(){at.setLevelFlash(!1),at.blitMap(),at.drawScore(),at.beginMapClip(),at.drawFruit(),at.drawPaths(),at.drawActors(),at.drawTargets(),at.endMapClip()},isPacmanCollide:function(){var t,e;for(t=0;t<4;t++)if((e=be[t]).tile.x==ye.tile.x&&e.tile.y==ye.tile.y&&0==e.mode){if(e.scared)Ue.addPoints(),e.onEaten();else{if(ye.invincible)continue;mi(Ri)}return!0}return!1},update:function(){if(Mn.isSeeking())Mn.seek();else{var t,i;Mn.getMode()==Cn&&Mn.record();var n=!1;if(Ue.showingPoints()){for(i=0;i<2;i++)for(t=0;t<4;t++)be[t].mode!=he&&be[t].mode!=de||be[t].update(i);Ue.updatePointsTimer(),n=!0}else{for(t=0;t<4;t++)be[t].mode==ce&&(be[t].mode=he,be[t].targetting="door");be[0].playSounds()}if(!n){for(Ye.update(),We.update(),Je.update(),oi.update(),Ue.update(),i=0;i<2;i++){if(ye.update(i),oi.testCollide(),on.allDotsEaten()){mi(Ni),e.extend.play();break}if(this.isPacmanCollide())break;for(t=0;t<4;t++)we[t].update(i);if(this.isPacmanCollide())break}for(t=0;t<5;t++)we[t].frames++}}}},Li={init:function(){this.frames=0,this.triggerFrame=0;var t=this.triggers[0];this.drawFunc=t?t.draw:void 0,this.updateFunc=t?t.update:void 0},update:function(){var t=this.triggers[this.frames];t&&(t.init&&t.init(),this.drawFunc=t.draw,this.updateFunc=t.update,this.triggerFrame=0),this.updateFunc&&this.updateFunc(this.triggerFrame),this.frames++,this.triggerFrame++},draw:function(){this.drawFunc&&this.drawFunc(this.triggerFrame)}},Ii=t(Li,{init:function(){Li.init.call(this),this.savedFrames={},this.savedTriggerFrame={},this.savedDrawFunc={},this.savedUpdateFunc={}},save:function(t){this.savedFrames[t]=this.frames,this.savedTriggerFrame[t]=this.triggerFrame,this.savedDrawFunc[t]=this.drawFunc,this.savedUpdateFunc[t]=this.updateFunc},load:function(t){this.frames=this.savedFrames[t],this.triggerFrame=this.savedTriggerFrame[t],this.drawFunc=this.savedDrawFunc[t],this.updateFunc=this.savedUpdateFunc[t]},update:function(){Mn.isSeeking()?Mn.seek():(Mn.getMode()==Cn&&Mn.record(),Li.update.call(this))},draw:function(){this.drawFunc&&Li.draw.call(this)}}),Ri=(_i=function(){at.blitMap(),at.drawScore()},t(Ii,{triggers:{0:{init:function(){e.die.play()},update:function(){var t;for(t=0;t<4;t++)we[t].frames++},draw:function(){_i(),at.beginMapClip(),at.drawFruit(),at.drawActors(),at.endMapClip()}},60:{draw:function(){_i(),at.beginMapClip(),at.drawPlayer(),at.endMapClip()}},120:{draw:function(t){_i(),at.beginMapClip(),at.drawDyingPlayer(t/75),at.endMapClip()}},195:{draw:function(){_i(),at.beginMapClip(),at.drawDyingPlayer(1),at.endMapClip()}},240:{draw:function(){_i(),at.beginMapClip(),at.drawDyingPlayer(1),at.endMapClip()},init:function(){mi(0==T?Bi:Di)}}}})),Ni=(pi=function(t){at.setLevelFlash(t),at.blitMap(),at.drawScore(),at.beginMapClip(),at.drawPlayer(),at.endMapClip()},t(Ii,{triggers:{0:{draw:function(){at.setLevelFlash(!1),at.blitMap(),at.drawScore(),at.beginMapClip(),at.drawFruit(),at.drawActors(),at.drawTargets(),at.endMapClip()}},120:{draw:function(){pi(!0)}},132:{draw:function(){pi(!1)}},144:{draw:function(){pi(!0)}},156:{draw:function(){pi(!1)}},168:{draw:function(){pi(!0)}},180:{draw:function(){pi(!1)}},192:{draw:function(){pi(!0)}},204:{draw:function(){pi(!1)}},216:{init:function(){hn()||mi(ki,60)}}}})),Bi=function(){var t;return{init:function(){t=0},draw:function(){at.blitMap(),at.drawScore(),at.drawMessage("GAME  OVER","#F00",9,20)},update:function(){120==t?mi(yi,60):t++}}}();!function(){var t=function(){this.listeners={}};t.prototype={add:function(t,e,i){this.listeners[t]=this.listeners[t]||[],this.listeners[t].push({isActive:i,callback:e})},exec:function(t,e){var i=this.listeners[t];if(i){var n,o,r=i.length;for(n=0;n<r&&((o=i[n]).isActive&&!o.isActive()||(e.preventDefault(),!o.callback()));n++);}}};var e=new t,i=new t,n=function(t,i,n){e.add(t,i,n)},o=function(t,e,n){i.add(t,e,n)},r={};window.addEventListener("keydown",function(t){var i=(t||window.event).keyCode;r[i]||(r[i]=!0,e.exec(i,t))}),window.addEventListener("keyup",function(t){var e=(t||window.event).keyCode;r[e]=!1,i.exec(e,t)});var a,s=function(){return!(a=li.getMenu&&li.getMenu())&&At.isOpen()&&(a=At.getMenu()),a};n(27,function(){return a.backButton&&a.backButton.onclick(),!0},s),n(13,function(){a.clickCurrentOption()},s);var l=function(){var t=s();return t&&!t.noArrowKeys};n(38,function(){a.selectPrevOption()},l),n(40,function(){a.selectNextOption()},l);n(27,function(){return At.getMenuButton().onclick(),!0},function(){return xt.isValidState()&&!At.isOpen()});var u=function(){return li==Ti||li==Mi||li==Ai||li==ki||li==Di};n(37,function(){ye.setInputDir(1)},u),n(39,function(){ye.setInputDir(3)},u),n(38,function(){ye.setInputDir(0)},u),n(40,function(){ye.setInputDir(2)},u),o(37,function(){ye.clearInputDir(1)},u),o(39,function(){ye.clearInputDir(3)},u),o(38,function(){ye.clearInputDir(0)},u),o(40,function(){ye.clearInputDir(2)},u);var h=function(){return u()&&f};n(49,function(){xi.setUpdatesPerSecond(30)},h),n(50,function(){xi.setUpdatesPerSecond(15)},h),o(49,function(){xi.setUpdatesPerSecond(60)},h),o(50,function(){xi.setUpdatesPerSecond(60)},h);var d=function(){return!s()&&Mn.getMode()!=Fn};n(16,function(){Mn.startSeeking()},d),o(16,function(){Mn.startRecording()},d);var _=function(){return Mn.isSeeking()};n(38,function(){Mn.nextSpeed(1)},_),n(40,function(){Mn.nextSpeed(-1)},_);n(78,function(){mi(ki,60)},function(){return h()&&(li==Mi||li==ki||li==Di||li==Ai||li==Ri||li==Ni||li==Bi)}),n(77,function(){mi(Ni)},function(){return li==Ai}),n(81,function(){ve.isDrawTarget=!ve.isDrawTarget},h),n(87,function(){xe.isDrawTarget=!xe.isDrawTarget},h),n(69,function(){me.isDrawTarget=!me.isDrawTarget},h),n(82,function(){ge.isDrawTarget=!ge.isDrawTarget},h),n(84,function(){ye.isDrawTarget=!ye.isDrawTarget},h),n(65,function(){ve.isDrawPath=!ve.isDrawPath},h),n(83,function(){xe.isDrawPath=!xe.isDrawPath},h),n(68,function(){me.isDrawPath=!me.isDrawPath},h),n(70,function(){ge.isDrawPath=!ge.isDrawPath},h),n(71,function(){ye.isDrawPath=!ye.isDrawPath},h),n(73,function(){ye.invincible=!ye.invincible},h),n(79,function(){c=!c},h),n(80,function(){ye.ai=!ye.ai},h),n(35,function(){xi.togglePause()})}();var zi,Oi,Gi,Hi,qi,Wi,Yi,Ji,Ui,Vi,Ki,Qi,Xi,Zi,ji,$i,tn,en,nn,on,rn=function(t,i){on=void 0,at.drawMap(!0),setTimeout(e.coffeeBreakMusic.startLoop,1200),t.nextState=i,mi(t,60)},an=t(Li,{init:function(){Li.init.call(this),ye.setPos(232,164),ve.setPos(257,164),ve.setDir(1),ve.faceDirEnum=1,ye.setDir(1),ve.scared=!1,ve.mode=0,s(),a(),Ue.reset(),ye.getNumSteps=function(){return le.prototype.getStepSizeFromTable.call(this,5,0)},ve.getNumSteps=function(){return le.prototype.getStepSizeFromTable.call(this,5,6)},ye.steer=ve.steer=function(){}},triggers:{0:{update:function(){var t;for(t=0;t<2;t++)ye.update(t),ve.update(t);ye.frames++,ve.frames++},draw:function(){at.blitMap(),at.beginMapClip(),at.drawPlayer(),at.drawGhost(ve),at.endMapClip()}},260:{init:function(){ye.setPos(-193,155),ve.setPos(-8,164),ve.setDir(3),ve.faceDirEnum=3,ye.setDir(3),ve.scared=!0,ye.getNumSteps=function(){return le.prototype.getStepSizeFromTable.call(this,5,2)},ve.getNumSteps=function(){return le.prototype.getStepSizeFromTable.call(this,5,3)}},update:function(){var t;for(t=0;t<2;t++)ye.update(t),ve.update(t);ye.frames++,ve.frames++},draw:function(){at.blitMap(),at.beginMapClip(),at.drawGhost(ve),at.renderFunc(function(t){var e=Math.floor(ye.steps/4)%4;3==e&&(e=1),function(t,e,i,n,o){var r=0,a=0;1==o?(r=-4,a=Math.atan(.5)):2==o&&(r=-2,a=Math.atan(13/9)),t.save(),t.translate(e,i);var s=Math.PI/2;0==n?t.rotate(3*s):3==n?t.rotate(0):2==n?t.rotate(s):1==n&&t.rotate(2*s),t.beginPath(),t.moveTo(r,0),t.arc(0,0,16,a,2*Math.PI-a),t.closePath(),t.fillStyle="#FF0",t.fill(),t.restore()}(t,ye.pixel.x,ye.pixel.y,ye.dirEnum,e)}),at.endMapClip()}},640:{init:function(){delete ye.getNumSteps,delete ve.getNumSteps,delete ye.steer,delete ve.steer,l(),mi(an.nextState,60)}}}}),sn=(tn=new pe,en=new pe,nn=function(t,e){var i,n=e.getAnimFrame();e==tn?i=1==h?pt.drawPacmanSprite:pt.drawOttoSprite:e==en&&(i=1==h?pt.drawMsPacmanSprite:pt.drawMsOttoSprite),i(t,e.pixel.x,e.pixel.y,e.dirEnum,n)},t(Li,{init:function(){Li.init.call(this),en.frames=20,tn.frames=12,tn.setPos(-10,99),tn.setDir(3),en.setPos(232,180),en.setDir(1),me.frames=0,me.mode=0,me.scared=!1,me.setPos(tn.pixel.x-42,99),me.setDir(3),me.faceDirEnum=3,xe.frames=3,xe.mode=0,xe.scared=!1,xe.setPos(en.pixel.x+49,180),xe.setDir(1),xe.faceDirEnum=1,s(),a(),Ue.reset(),tn.getStepFrame=function(){return Math.floor(this.frames/4)%4},en.getStepFrame=function(){return Math.floor(this.frames/4)%4},me.getAnimFrame=function(){return Math.floor(this.frames/8)%2},xe.getAnimFrame=function(){return Math.floor(this.frames/8)%2},tn.getNumSteps=function(){return 1},en.getNumSteps=function(){return 1},me.getNumSteps=function(){return 1},xe.getNumSteps=function(){return 1},tn.steer=function(){},en.steer=function(){},me.steer=function(){},xe.steer=function(){}},triggers:{0:{update:function(){!function(){var t;for(t=0;t<2;t++)tn.update(t),en.update(t),me.update(t),xe.update(t);tn.frames++,en.frames++,me.frames++,xe.frames++}(),105==me.pixel.x&&(me.getNumSteps=function(){return le.prototype.getStepSizeFromTable.call(this,5,6)},xe.getNumSteps=function(){return le.prototype.getStepSizeFromTable.call(this,5,6)})},draw:function(){at.blitMap(),at.beginMapClip(),at.renderFunc(function(t){nn(t,tn),nn(t,en)}),at.drawGhost(me),at.drawGhost(xe),at.endMapClip()}},300:(Gi=[1,0,1,0,0,1,0,1,0,1,0,0,1,0,1,0,1,0,0,1,0,1,0,1,0],Hi=[-1,0,-1,0,0,0,0,0,1,0,1,0,0,0,-1,0,-1,0,0,0,0,0,1,0,1],qi=[0,0,0,0,-1,0,-1,0,0,-1,0,-1,0,-1,0,0,-1,0,-1,0,-1,0,0,-1,0,-1,0,-1,0,0],Wi=[0,0,0,-1,0,-1,0,0,0,0,0,1,0,1,0,0,0,-1,0,-1,0,0,0,0,0,1,0,1,0,0],Yi=0,Ji=0,Ui=Gi.length,Vi=qi.length,Ki=[0,1,1,1,1,0,0],Qi=[0,0,-1,-1,-1,0,0],Xi=0,Zi=Ki.length,ji=0,$i=0,{init:function(){Yi=Ji=Xi=ji=$i=0,zi=0,Oi=0,en.setPos(-8,143),en.setDir(3),xe.setPos(-81,143),xe.faceDirEnum=3,xe.setDir(3),tn.setPos(234,142),tn.setDir(1),me.setPos(302,143),me.faceDirEnum=1,me.setDir(1),me.getNumSteps=xe.getNumSteps=function(){return"11211212"[this.frames%8]}},update:function(){var t;if(0==Oi){for(t=0;t<2;t++)tn.update(t),en.update(t);102==en.pixel.x&&Oi++}else if(1==Oi)tn.pixel.x-=Ki[Xi],tn.pixel.y+=Qi[Xi],tn.commitPos(),en.pixel.x+=Ki[Xi],en.pixel.y+=Qi[Xi],en.commitPos(),++Xi==Zi&&Oi++;else if(2==Oi){if(0==ji)en.pixel.y-=2,en.commitPos(),en.setDir(0),tn.pixel.x-=1,tn.commitPos(),tn.setDir(0);else for(t=0;t<2;t++)tn.update(t),en.update(t);ji++,91==en.pixel.y&&Oi++}else 3==Oi&&(0==$i&&(en.pixel.y++,en.setDir(3),en.commitPos(),tn.pixel.y--,tn.pixel.x++,tn.setDir(1),tn.commitPos()),$i>18&&(tn.frames--,en.frames--),78==$i&&(delete me.getNumSteps,delete xe.getNumSteps,delete me.steer,delete xe.steer,delete me.getAnimFrame,delete xe.getAnimFrame,l(),mi(sn.nextState,60)),$i++);if(tn.frames++,en.frames++,0==zi){for(t=0;t<2;t++)me.update(t),xe.update(t);me.pixel.x=Math.max(120,me.pixel.x),me.commitPos(),xe.pixel.x=Math.min(105,xe.pixel.x),xe.commitPos(),105==xe.pixel.x&&zi++}else 1==zi&&(Yi<Ui&&(me.pixel.x+=Gi[Yi],me.pixel.y+=Hi[Yi]),Ji<Vi&&(xe.pixel.x+=qi[Ji],xe.pixel.y+=Wi[Ji]),Yi++,Ji++);me.frames++,xe.frames++},draw:function(){at.blitMap(),at.beginMapClip(),at.renderFunc(function(t){nn(t,tn),nn(t,en)}),Yi<Ui&&at.drawGhost(me),Ji<Vi&&at.drawGhost(xe),3==Oi&&at.renderFunc(function(t){ae(t,112,73)}),at.endMapClip()}})}})),ln=function(){var e=new pe,i=new pe,n=function(t,n){var o,r=n.getAnimFrame();n==e?o=1==h?pt.drawPacmanSprite:pt.drawOttoSprite:n==i&&(o=1==h?pt.drawMsPacmanSprite:pt.drawMsOttoSprite),o(t,n.pixel.x,n.pixel.y,n.dirEnum,r)},o=function(){at.blitMap(),at.beginMapClip(),at.renderFunc(function(t){n(t,e),n(t,i)}),at.endMapClip()},r=function(){var t;for(t=0;t<7;t++)e.update(t),i.update(t);e.frames++,i.frames++},u=function(){return 3},f=function(){return"32"[this.frames%2]},c=function(){return 7};return t(Li,{init:function(){Li.init.call(this),i.frames=20,e.frames=12,e.getStepFrame=function(){return Math.floor(this.frames/4)%4},i.getStepFrame=function(){return Math.floor(this.frames/4)%4},e.steer=function(){},i.steer=function(){},s(),a()},triggers:{0:{draw:function(){at.blitMap()}},160:{init:function(){e.setPos(-8,67),e.setDir(3),i.setPos(-106,68),i.setDir(3),e.getNumSteps=f,i.getNumSteps=u},update:r,draw:o},410:{init:function(){e.setPos(329,163),e.setDir(1),i.setPos(231,164),i.setDir(1),e.getNumSteps=u,i.getNumSteps=f},update:r,draw:o},670:{init:function(){e.setPos(-8,142),e.setDir(3),i.setPos(-106,143),i.setDir(3),e.getNumSteps=f,i.getNumSteps=u},update:r,draw:o},930:{init:function(){e.setPos(381,99),e.setDir(1),i.setPos(233,100),i.setDir(1),e.getNumSteps=c,i.getNumSteps=c},update:function(){e.pixel.x<=17&&1==e.dirEnum&&(e.setPos(-2,195),e.setDir(3),i.setPos(-150,196),i.setDir(3)),r()},draw:o},1140:{init:function(){l(),mi(ln.nextState,60)}}}})}(),un=t(Li,{init:function(){Li.init.call(this),ye.setPos(232,164),ve.setPos(257,164),ve.setDir(1),ve.faceDirEnum=1,ye.setDir(1),ve.scared=!1,ve.mode=0,s(),a(),Ue.reset(),ye.getNumSteps=function(){return le.prototype.getStepSizeFromTable.call(this,5,0)},ve.getNumSteps=function(){return le.prototype.getStepSizeFromTable.call(this,5,6)},ye.steer=ve.steer=function(){}},triggers:{0:{update:function(){var t;for(t=0;t<2;t++)ye.update(t),ve.update(t);ye.frames++,ve.frames++},draw:function(){at.blitMap(),at.beginMapClip(),at.drawPlayer(),at.drawGhost(ve),at.endMapClip()}},260:{init:function(){ye.setPos(-193,164),ve.setPos(-8,155),ve.setDir(3),ve.faceDirEnum=3,ye.setDir(3),ve.scared=!0,ye.getNumSteps=function(){return le.prototype.getStepSizeFromTable.call(this,5,2)},ve.getNumSteps=function(){return le.prototype.getStepSizeFromTable.call(this,5,3)}},update:function(){var t;for(t=0;t<2;t++)ye.update(t),ve.update(t);ye.frames++,ve.frames++},draw:function(){at.blitMap(),at.beginMapClip(),at.drawPlayer(),at.renderFunc(function(t){var e=ve.getBounceY(ve.pixel.x,ve.pixel.y,3),i=ve.pixel.x;t.save(),t.translate(i,e);t.scale(16/6,16/6),ee(t,0,0),t.restore()}),at.endMapClip()}},640:{init:function(){delete ye.getNumSteps,delete ve.getNumSteps,delete ye.steer,delete ve.steer,l(),mi(un.nextState,60)}}}}),fn=function(){var e=new _e;e.scared=!0,e.mode=0;var i,n,o,r,u,f,c,h,d,_,p,v,x,m,g,y,T=new pe,w=function(t,i){var n=i.getAnimFrame();if(i==e){var o=i.getBounceY(i.pixel.x,i.pixel.y,i.dirEnum);pt.drawMuppetSprite(t,i.pixel.x,o,0,i.dirEnum,!0,!1)}else i==T&&Wt(t,i.pixel.x,i.pixel.y,i.dirEnum,n,!0)};return t(Li,{init:function(){Li.init.call(this),T.frames=14,e.frames=12,e.setPos(-10,99),e.setDir(3),T.setPos(232,180),T.setDir(1),me.frames=0,me.mode=0,me.scared=!1,me.setPos(e.pixel.x-42,99),me.setDir(3),me.faceDirEnum=3,xe.frames=3,xe.mode=0,xe.scared=!1,xe.setPos(T.pixel.x+49,180),xe.setDir(1),xe.faceDirEnum=1,s(),a(),Ue.reset(),e.getStepFrame=function(){return Math.floor(this.frames/4)%4},T.getStepFrame=function(){return Math.floor(this.frames/4)%4},me.getAnimFrame=function(){return Math.floor(this.frames/8)%2},xe.getAnimFrame=function(){return Math.floor(this.frames/8)%2},e.getNumSteps=function(){return 1},T.getNumSteps=function(){return 1},me.getNumSteps=function(){return 1},xe.getNumSteps=function(){return 1},e.steer=function(){},T.steer=function(){},me.steer=function(){},xe.steer=function(){}},triggers:{0:{update:function(){!function(){var t;for(t=0;t<2;t++)e.update(t),T.update(t),me.update(t),xe.update(t);e.frames++,T.frames++,me.frames++,xe.frames++}(),105==me.pixel.x&&(me.getNumSteps=function(){return le.prototype.getStepSizeFromTable.call(this,5,6)},xe.getNumSteps=function(){return le.prototype.getStepSizeFromTable.call(this,5,6)})},draw:function(){at.blitMap(),at.beginMapClip(),at.renderFunc(function(t){w(t,e),w(t,T)}),at.drawGhost(me),at.drawGhost(xe),at.endMapClip()}},300:(o=[1,0,1,0,0,1,0,1,0,1,0,0,1,0,1,0,1,0,0,1,0,1,0,1,0],r=[-1,0,-1,0,0,0,0,0,1,0,1,0,0,0,-1,0,-1,0,0,0,0,0,1,0,1],u=[0,0,0,0,-1,0,-1,0,0,-1,0,-1,0,-1,0,0,-1,0,-1,0,-1,0,0,-1,0,-1,0,-1,0,0],f=[0,0,0,-1,0,-1,0,0,0,0,0,1,0,1,0,0,0,-1,0,-1,0,0,0,0,0,1,0,1,0,0],c=0,h=0,d=o.length,_=u.length,p=[0,1,1,1,1,0,0,1,1,1,1,1,1],v=[0,0,-1,-1,-1,0,0,0,0,0,0,0,0],x=0,m=p.length,g=0,y=0,{init:function(){c=h=x=g=y=0,i=0,n=0,T.setPos(-8,143),T.setDir(3),xe.setPos(-81,143),xe.faceDirEnum=3,xe.setDir(3),e.setPos(234,142),e.setDir(1),me.setPos(302,143),me.faceDirEnum=1,me.setDir(1),me.getNumSteps=xe.getNumSteps=function(){return"11211212"[this.frames%8]}},update:function(){var t;if(0==n){for(t=0;t<2;t++)e.update(t),T.update(t);102==T.pixel.x&&n++}else if(1==n)e.pixel.x-=p[x],e.pixel.y+=v[x],e.commitPos(),T.pixel.x+=p[x],T.pixel.y+=v[x],T.commitPos(),++x==m&&n++;else if(2==n){if(0==g)T.pixel.y-=2,T.commitPos(),T.setDir(0);else for(t=0;t<2;t++)T.update(t);g++,91==T.pixel.y&&n++}else 3==n&&(0==y&&(T.pixel.y++,T.setDir(3),T.commitPos()),y>18&&T.frames--,78==y&&(delete me.getNumSteps,delete xe.getNumSteps,delete me.steer,delete xe.steer,delete me.getAnimFrame,delete xe.getAnimFrame,l(),mi(fn.nextState,60)),y++);if(e.frames++,T.frames++,0==i){for(t=0;t<2;t++)me.update(t),xe.update(t);me.pixel.x=Math.max(120,me.pixel.x),me.commitPos(),xe.pixel.x=Math.min(105,xe.pixel.x),xe.commitPos(),105==xe.pixel.x&&i++}else 1==i&&(c<d&&(me.pixel.x+=o[c],me.pixel.y+=r[c]),h<_&&(xe.pixel.x+=u[h],xe.pixel.y+=f[h]),c++,h++);me.frames++,xe.frames++},draw:function(){at.blitMap(),at.beginMapClip(),at.renderFunc(function(t){n<=1&&w(t,e),w(t,T)}),c<d&&at.drawGhost(me),h<_&&at.drawGhost(xe),3==n&&at.renderFunc(function(t){ae(t,112,73)}),at.endMapClip()}})}})}(),cn=[[an],[sn,ln],[un,fn],[sn,ln]],hn=function(){if(0==h){if(2==g)return rn(an,ki),!0}else if(1==h||3==h){if(2==g)return rn(sn,ki),!0;if(5==g)return rn(ln,ki),!0}else if(2==h){if(2==g)return rn(un,ki),!0;if(5==g)return rn(fn,ki),!0}return!1};ve.startDirEnum=1,ve.startPixel={x:111,y:112+Y},ve.cornerTile={x:25,y:0},ve.startMode=0,ve.arriveHomeMode=5,xe.startDirEnum=2,xe.startPixel={x:111,y:136+Y},xe.cornerTile={x:2,y:0},xe.startMode=4,xe.arriveHomeMode=4,me.startDirEnum=0,me.startPixel={x:95,y:136+Y},me.cornerTile={x:27,y:34},me.startMode=4,me.arriveHomeMode=4,ge.startDirEnum=0,ge.startPixel={x:127,y:136+Y},ge.cornerTile={x:0,y:34},ge.startMode=4,ge.arriveHomeMode=4,ye.startDirEnum=1,ye.startPixel={x:111,y:208+Y};var dn=new J(28,36,"______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________||||||||||||||||||||||||____|                      |____| ||||| |||||||| ||||| |____| ||||| |||||||| ||||| |____| ||    ||    ||    || |____| || || || || || || || |__||| || || || || || || || |||       ||    ||    ||       ||| ||||| |||||||| ||||| |||__| ||||| |||||||| ||||| |____|    ||          ||    |____| || || |||||||| || || |____| || || |||||||| || || |____| ||    ||    ||    || |____| || || || || || || || |__||| || || || || || || || |||       ||    ||    ||       ||| |||||||| || |||||||| |||__| |||||||| || |||||||| |____|                      |____||||||||||||||||||||||||__________________________________________________________________________________________________________________________________________________________________________");dn.name="Pac-Man",dn.wallStrokeColor="#47b897",dn.wallFillColor="#000",dn.pelletColor="#ffb8ae",dn.shouldDrawMapOnly=!0;var _n=new J(28,36,"____________________________________________________________________________________|||||||||||||||||||||||||||||............||............||.||||.|||||.||.|||||.||||.||o||||.|||||.||.|||||.||||o||.||||.|||||.||.|||||.||||.||..........................||.||||.||.||||||||.||.||||.||.||||.||.||||||||.||.||||.||......||....||....||......|||||||.||||| || |||||.||||||_____|.||||| || |||||.|__________|.||          ||.|__________|.|| |||--||| ||.|_____||||||.|| |______| ||.||||||      .   |______|   .      ||||||.|| |______| ||.||||||_____|.|| |||||||| ||.|__________|.||          ||.|__________|.|| |||||||| ||.|_____||||||.|| |||||||| ||.|||||||............||............||.||||.|||||.||.|||||.||||.||.||||.|||||.||.|||||.||||.||o..||.......  .......||..o||||.||.||.||||||||.||.||.||||||.||.||.||||||||.||.||.||||......||....||....||......||.||||||||||.||.||||||||||.||.||||||||||.||.||||||||||.||..........................|||||||||||||||||||||||||||||________________________________________________________");_n.name="Pac-Man",_n.wallStrokeColor="#2121ff",_n.wallFillColor="#000",_n.pelletColor="#ffb8ae",_n.constrainGhostTurns=function(t,e){12!=t.x&&15!=t.x||14!=t.y&&26!=t.y||(e[0]=!1)};var pn=function(t){return t<=2?1:t<=5?2:3+Math.floor((t-6)/4)},vn=function(t){return 0==h?{wallFillColor:_n.wallFillColor,wallStrokeColor:_n.wallStrokeColor,pelletColor:_n.pelletColor}:1==h||3==h?yn(t):2==h?mn(t):void 0},xn=function(t){if(1==t)return[1,2];if(2==t)return[3,5];var e=4*t-6;return[e,e+3]},mn=function(t){var e=["#359c9c","#80d8fc","#c2b853","#e6f1e7","#86669c","#f2c1db","#ed0a04","#e8b4cd","#2067c1","#63e0b6","#c55994","#fd61c3","#12bc76","#b4e671","#5036d9","#618dd4","#939473","#fdfdf4"],i=2*(t-1)%e.length;return{wallFillColor:e[i],wallStrokeColor:e[i+1],pelletColor:"#ffb8ae"}},gn=function(){var t=pn(g);if(!on||1==g||t!=pn(g-1)){on=_t();var e=mn(t);on.wallFillColor=e.wallFillColor,on.wallStrokeColor=e.wallStrokeColor,on.pelletColor=e.pelletColor}},yn=function(t){var e=[wn,bn,Sn,Pn][(t-=1)<=1?t:t%2+2];return t>=4?[{wallFillColor:"#ffb8ff",wallStrokeColor:"#FFFF00",pelletColor:"#00ffff"},{wallFillColor:"#FFB8AE",wallStrokeColor:"#FF0000",pelletColor:"#dedeff"},{wallFillColor:"#de9751",wallStrokeColor:"#dedeff",pelletColor:"#ff0000"},{wallFillColor:"#2121ff",wallStrokeColor:"#ffb851",pelletColor:"#dedeff"}][t%4]:{wallFillColor:e.wallFillColor,wallStrokeColor:e.wallStrokeColor,pelletColor:e.pelletColor}},Tn=function(){var t=[wn,bn,Sn,Pn],e=pn(g)-1;if(on=t[e<=1?e:e%2+2],e>=4){var i=yn(e+1);on.wallFillColor=i.wallFillColor,on.wallStrokeColor=i.wallStrokeColor,on.pelletColor=i.pelletColor}},wn=new J(28,36,"____________________________________________________________________________________|||||||||||||||||||||||||||||......||..........||......||o||||.||.||||||||.||.||||o||.||||.||.||||||||.||.||||.||..........................||||.||.|||||.||.|||||.||.|||__|.||.|||||.||.|||||.||.|__|||.||.|||||.||.|||||.||.|||   .||.......||.......||.   |||.||||| |||||||| |||||.|||__|.||||| |||||||| |||||.|____|.                    .|____|.||||| |||--||| |||||.|____|.||||| |______| |||||.|____|.||    |______|    ||.|____|.|| || |______| || ||.|__|||.|| || |||||||| || ||.|||   .   ||          ||   .   |||.|||||||| || ||||||||.|||__|.|||||||| || ||||||||.|____|.......   ||   .......|____|.|||||.||||||||.|||||.|__|||.|||||.||||||||.|||||.||||............  ............||.||||.|||||.||.|||||.||||.||.||||.|||||.||.|||||.||||.||.||||.||....||....||.||||.||o||||.||.||||||||.||.||||o||.||||.||.||||||||.||.||||.||..........................|||||||||||||||||||||||||||||________________________________________________________");wn.name="Ms. Pac-Man 1",wn.wallFillColor="#FFB8AE",wn.wallStrokeColor="#FF0000",wn.pelletColor="#dedeff",wn.fruitPaths={entrances:[{start:{y:164,x:228},path:"<<<<vvv<<<<<<<<<^^^"},{start:{y:164,x:-4},path:">>>>vvvvvv>>>>>>>>>>>>>>>^^^<<<^^^"},{start:{y:92,x:-4},path:">>>>^^^^>>>vvvv>>>vvv>>>>>>>>>vvvvvv<<<"},{start:{y:92,x:228},path:"<<<<vvvvvvvvv<<<^^^<<<vvv<<<"}],exits:[{path:"<vvv>>>>>>>>>^^^>>>>"},{path:"<<<<vvv<<<<<<<<<^^^<<<<"},{path:"<<<<<<<^^^^^^<<<<<<^^^<<<<"},{path:"<vvv>>>>>>>>>^^^^^^^^^^^^>>>>"}]};var bn=new J(28,36,"____________________________________________________________________________________||||||||||||||||||||||||||||       ||..........||       |||||| ||.||||||||.|| |||||||||||| ||.||||||||.|| |||||||o...........||...........o||.|||||||.||.||.||.|||||||.||.|||||||.||.||.||.|||||||.||.||......||.||.||......||.||.||.|||| ||....|| ||||.||.||.||.|||| |||||||| ||||.||.||......|| |||||||| ||......|||||||.||          ||.||||||||||||.|| |||--||| ||.|||||||......|| |______| ||......||.||||.|| |______| ||.||||.||.||||.   |______|   .||||.||...||.|| |||||||| ||.||...||||.||.||          ||.||.|||__|.||.|||| |||| ||||.||.|____|.||.|||| |||| ||||.||.|____|.........||||.........|____|.|||||||.||||.|||||||.|__|||.|||||||.||||.|||||||.|||   ....||...    ...||....   |||.||.||.||||||||.||.||.||||||.||.||.||||||||.||.||.||||o..||.......||.......||..o||.||||.|||||.||.|||||.||||.||.||||.|||||.||.|||||.||||.||..........................|||||||||||||||||||||||||||||________________________________________________________");bn.name="Ms. Pac-Man 2",bn.wallFillColor="#47b8ff",bn.wallStrokeColor="#dedeff",bn.pelletColor="#ffff00",bn.fruitPaths={entrances:[{start:{y:212,x:228},path:"<<<<^^^<<<<<<<<^^^<"},{start:{y:212,x:-4},path:">>>>^^^>>>>>>>>vvv>>>>>^^^^^^<"},{start:{y:36,x:-4},path:">>>>>>>vvv>>>vvvvvvv>>>>>>>>>vvvvvv<<<"},{start:{y:36,x:228},path:"<<<<<<<vvv<<<vvvvvvvvvvvvv<<<"}],exits:[{path:"vvv>>>>>>>>vvv>>>>"},{path:"vvvvvv<<<<<^^^<<<<<<<<vvv<<<<"},{path:"<<<<<<<^^^^^^^^^^^^^<<<^^^<<<<<<<"},{path:"vvv>>>>>^^^^^^^^^^>>>>>^^^^^^<<<<<^^^>>>>>>>"}]};var Sn=new J(28,36,"____________________________________________________________________________________|||||||||||||||||||||||||||||.........||....||.........||.|||||||.||.||.||.|||||||.||o|||||||.||.||.||.|||||||o||.||.........||.........||.||.||.||.||||.||.||||.||.||.||....||.||||.||.||||.||....|||||.||.||||.||.||||.||.||||||||.||..............||.|||| ....|||| |||||||| ||||.... |.|| |||| |||||||| |||| ||.||.||                    ||.||.|||| || |||--||| || ||||.||.|||| || |______| || ||||.||.     || |______| ||     .||.|| |||| |______| |||| ||.||.|| |||| |||||||| |||| ||.||.||                    ||.||.|||| ||||| || ||||| ||||.||.|||| ||||| || ||||| ||||.||......||....||....||......||||.||.||.||||||||.||.||.||||||.||.||.||||||||.||.||.||||o..||.......  .......||..o||.||||.|||||.||.|||||.||||.||.||||.|||||.||.|||||.||||.||......||....||....||......||.||||.||.||||||||.||.||||.||.||||.||.||||||||.||.||||.||......||..........||......|||||||||||||||||||||||||||||________________________________________________________");Sn.name="Ms. Pac-Man 3",Sn.wallFillColor="#de9751",Sn.wallStrokeColor="#dedeff",Sn.pelletColor="#ff0000",Sn.fruitPaths={entrances:[{start:{y:100,x:228},path:"<<<<<vv<<<<<vvvvvv<<<"},{start:{y:100,x:-4},path:">>>>>vv>>>>>>>>>>>>>>vvvvvv<<<"},{start:{y:100,x:-4},path:">>>>>vv>>>>>>>>>>>>>>vvvvvv<<<"},{start:{y:100,x:228},path:"<<vvvvv<<<vvv<<<<<<<<"}],exits:[{path:"<vvv>>>vvv>>>^^^>>>>>^^^^^^^^^^^>>"},{path:"<<<<vvv<<<vvv<<<^^^<<<<<^^^^^^^^^^^<<"},{path:"<<<<vvv<<<vvv<<<^^^<<<<<^^^^^^^^^^^<<"},{path:"<vvv>>>vvv>>>^^^^^^<<<^^^^^^>>>>>^^>>>>>"}]},Sn.constrainGhostTurns=function(t,e,i){12==t.y&&(1==t.x&&3==i||26==t.x&&1==i)&&(e[2]=!1)};var Pn=new J(28,36,"____________________________________________________________________________________|||||||||||||||||||||||||||||..........................||.||.||||.||||||||.||||.||.||o||.||||.||||||||.||||.||o||.||.||||.||....||.||||.||.||.||......||.||.||......||.||.||||.||.||.||.||.||.||||.||.||||.||.||.||.||.||.||||.||......||....||....||......||||.|||||||| || ||||||||.|||__|.|||||||| || ||||||||.|____|....||          ||....|__||| ||.|| |||--||| ||.|| |||    ||.|| |______| ||.||    ||||||.   |______|   .||||||||||||.|| |______| ||.||||||    ||.|| |||||||| ||.||    ||| ||.||          ||.|| |||__|....||||| || |||||....|____|.||.||||| || |||||.||.|____|.||....   ||   ....||.|____|.|||||.|| || ||.|||||.|__|||.|||||.|| || ||.|||||.||||.........||    ||.........||.||||.||.||||||||.||.||||.||.||||.||.||||||||.||.||||.||.||...||..........||...||.||o||.|||||||.||.|||||||.||o||.||.|||||||.||.|||||||.||.||............||............|||||||||||||||||||||||||||||________________________________________________________");Pn.name="Ms. Pac-Man 4",Pn.wallFillColor="#2121ff",Pn.wallStrokeColor="#ffb851",Pn.pelletColor="#dedeff",Pn.fruitPaths={entrances:[{start:{y:156,x:228},path:"<<<<vv<<<vv<<<<<<^^^"},{start:{y:156,x:-4},path:">>>>vv>>>vv>>>>>>vvv>>>^^^^^^"},{start:{y:132,x:-4},path:">>>>^^^^^>>>^^^>>>vvv>>>vvv>>>>>>vvvvvv<<<"},{start:{y:132,x:228},path:"<<<<^^<<<vvv<<<vvv<<<"}],exits:[{path:"<vvv>>>>>>^^>>>^^>>>>"},{path:"<<<<vvv<<<<<<^^<<<^^<<<<"},{path:"<<<<<<<^^^<<<^^^<<<vv<<<<"},{path:"<vvv>>>>>>^^^^^^^^^>>>vv>>>>"}]};var Fn=-1,Cn=0,Mn=function(){var t,e,i,n,o,r,a,s,l,u=[-8,-4,-2,-1,0,1,2,4,8],c=u.length,h=["rgba(255,255,0,0.25)","rgba(255,255,0,0.20)","rgba(255,255,0,0.15)","rgba(255,255,0,0.10)","rgba(0,0,0,0)","rgba(0,0,255,0.10)","rgba(0,0,255,0.15)","rgba(0,0,255,0.20)","rgba(0,0,255,0.25)"],d=[18,13,8,3,3,10,15,20,25],_=[6,5,4,3,3,3,4,5,6],p=function(){var t,e;for(t=0;t<5;t++)we[t].load(o);Je.load(o),Ue.load(o),oi.load(o),We.load(o),Ye.load(o),on.load(o,i),g=w[e=o],T!=b[e]&&(T=b[e],at.drawMap()),I(S[e]),A(P[e]),(li=F[e])==Ri?Ri.load(o):li==Ni&&Ni.load(o)},v=function(){var t,e;for(t=0;t<5;t++)we[t].save(o);Je.save(o),Ue.save(o),oi.save(o),We.save(o),Ye.save(o),on.save(o),w[e=o]=g,b[e]=T,S[e]=L(),P[e]=D(),F[e]=li,li==Ri?Ri.save(o):li==Ni&&Ni.save(o)},x=function(){on.eraseFuture(i),a=o},m=function(t){i+=t,(o=(o+t)%900)<0&&(o+=900)},y=function(t,e){return t<=e?e-t:e+900-t},C=function(){t=Cn,e=!1,x(),R.disable(),N.disable(),B.setIcon(function(t,e,i,n){oe(t,e,i,"#FFF")}),B.setText()},M=function(){B.setText(u[n]+"x")},E=function(){n=3,O(),R.enable(),N.enable(),B.setIcon(void 0),M()},k=function(t){null!=u[n+t]&&(n+=t),O(),M()};s=132.5;var R=new yt(227,102.5,25,l=25,function(){k(1)});R.setIcon(function(t,e,i,n){!function(t,e,i,n){t.save(),t.translate(e,i);t.fillStyle=n,t.beginPath(),t.moveTo(0,-4),t.lineTo(4,4),t.lineTo(-4,4),t.closePath(),t.fill(),t.restore()}(t,e,i,"#FFF")});var N=new yt(227,162.5,25,l,function(){k(-1)});N.setIcon(function(t,e,i,n){!function(t,e,i,n){t.save(),t.translate(e,i);t.fillStyle=n,t.beginPath(),t.moveTo(0,4),t.lineTo(4,-4),t.lineTo(-4,-4),t.closePath(),t.fill(),t.restore()}(t,e,i,"#FFF")});var B=new Tt(227,s,25,l,function(){return t!=Cn},function(t){t?E():C()});B.setIcon(function(t,e,i,n){oe(t,e,i,"#FFF")}),B.setFont("7px ArcadeR","#FFF");var z=new Tt(-31,s,25,l,function(){return xi.getFramePeriod()==1e3/15},function(t){xi.setUpdatesPerSecond(t?15:60)});z.setIcon(function(t,e,i){pt.drawSnail(t,e,i,1)});var O=function(){var e=u[n];0==e?t=3:e<0?t=1:e>0&&(t=2)};return{init:function(){t=Fn},reset:function(){i=0,o=0,r=0,a=0,states={},C()},seek:function(t){null==t&&(t=u[n]),e&&(m(function(t){if(!e||0==t)return 0;var i=y(o,a),n=y(r,o);return t>0?Math.min(i,t):Math.max(-n,t)}(t)),p())},record:function(){e?(m(1),o==r&&(r=(r+1)%900),a=o):e=!0,v()},draw:function(t){f&&(At.isOpen()||li!=Ai&&li!=Ni&&li!=Ri||Mn.getMode()==Cn||at.setOverlayColor(h[n]),R.isEnabled&&R.draw(t),N.isEnabled&&N.draw(t),B.isEnabled&&B.draw(t),z.isEnabled&&z.draw(t))},onFramePeriodChange:function(){z.isOn()?z.setIcon(function(t,e,i){pt.drawSnail(t,e,i,0)}):z.setIcon(function(t,e,i){pt.drawSnail(t,e,i,1)})},onHudEnable:function(){f&&(t==Fn||t==Cn?(R.disable(),N.disable()):(R.enable(),N.enable()),B.enable(),z.enable())},onHudDisable:function(){f&&(R.disable(),N.disable(),B.disable(),z.disable())},eraseFuture:x,startRecording:C,startSeeking:E,nextSpeed:k,isSeeking:function(){return 1==t||2==t||3==t},getTime:function(){return i},getFrame:function(){return o},getMode:function(){return t},drawHistory:function(t,e){if(this.isSeeking()){var i=y(r,o),s=(o-Math.min(i,d[n]))%900;s<0&&(s+=900);var l=y(o,a),u=(o+Math.min(l,d[c-1-n]))%900,f=t.globalAlpha;t.globalAlpha=.2;var h=s,p=_[n];if(s>u){for(;h<900;h+=p)e(h);h%=900}for(;h<u;h+=p)e(h);t.globalAlpha=f}}}}();window.addEventListener("load",function(){var t,e,i,n,o;!function(){var t,e,i;if(localStorage&&localStorage.highScores)for(e=(t=JSON.parse(localStorage.highScores)).length,i=0;i<e;i++)M[i]=Math.max(M[i],t[i])}(),vt(),pt.create(),t=0,e=0,i=0,n=0,o=function(o){"canvas"==o.target.tagName.toLowerCase()&&(o.preventDefault(),t=e=i=n=0)},document.onclick=function(t){"canvas"!=t.target.tagName.toLowerCase()&&ye.clearInputDir(void 0)},document.ontouchstart=function(i){"canvas"==i.target.tagName.toLowerCase()&&(i.preventDefault(),1==i.touches.length?(t=i.touches[0].pageX,e=i.touches[0].pageY):o(i))},document.ontouchend=function(t){"canvas"==t.target.tagName.toLowerCase()&&t.preventDefault()},document.ontouchmove=function(r){"canvas"==r.target.tagName.toLowerCase()&&(r.preventDefault(),1==r.touches.length?(i=r.touches[0].pageX-t,n=r.touches[0].pageY-e,i*i+n*n>=16&&(t+=i,e+=n,Math.abs(i)>=Math.abs(n)?ye.setInputDir(i>0?3:1):ye.setInputDir(n>0?2:0))):o(r))},document.ontouchcancel=o;var r=window.location.hash.substring(1);if("learn"==r)mi(Ti);else if("cheat_pac"==r||"cheat_mspac"==r){h="cheat_pac"==r?0:1,f=!0,mi(Mi);for(var a=0;a<4;a++)be[a].isDrawTarget=!0,be[a].isDrawPath=!0}else mi(yi);xi.init()})}();
